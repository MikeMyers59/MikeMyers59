<!DOCTYPE HTML>
<html lang="en">
<head>
<title>Basic Hardware Inventory</title>

<script type="text/vbscript">
  ' This code moves the HTA window offscreen until the selected theme and window size are 
  ' applied and the check for elevated privileges has been handled, thus preventing "flashing"
  window.MoveTo Screen.Width,Screen.Height
  window.Focus( )
</script>

<meta name="viewport" content="width=device-width; initial-scale=1" />

<HTA:APPLICATION
  APPLICATIONNAME="Basic Hardware Inventory"
  ID="Hardware"
  VERSION="6.16"
  SCROLL="auto"
  SINGLEINSTANCE="yes"/>

<style type="text/css">
body {
	font: 11pt arial,sans-serif;
	color: white;
	background-color: black;
	filter: progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr='#0000FF', EndColorStr='#000000');
	padding: 20px 0;
	margin: 0;
	height: 100%;
	width: 100%;
}

a {
	color: red;
}

code {
	color: yellow;
	font-size: 110%;
}

input[type=radio] {
	width: 2em;
}

table {
	max-width: 100%;
}

td {
	overflow-x: auto;
	text-align: left;
}

tr {
	vertical-align: top;
}

.Button {
	width: 6em;
	margin: 0 1em 0 1em;
	vertical-align: top;
}

.Center {
	margin-left: auto;
	margin-right: auto;
	text-align: center;
}

.DebugOnly {
	display: none;
}

.Left {
	text-align: left;
}

.Nowrap {
	white-space: nowrap;
}

.Top {
	vertical-align: top;
}

#CreditsScreen .Button, #HelpScreen .Button {
	margin: 3px;
}

#HelpScreen table tr td {
	text-align: left;
}

@media screen
{
	.PrintOnly {
		display: none;
	}
}

@media print
{
	body {
		font: 12pt arial,sans-serif;
		color: black;
		background-color: white;
		filter: unset;
		padding: 0;
		margin: 0;
		height: 100%;
	}

	.DontPrint {
		display: none;
	}

	.Nowrap {
		white-space: normal;
	}
}
</style>

<!-- ------------------------------------------------------------------- -->
<!--                         I M P O R T A N T                           -->
<!--    If you use JavaScript (or JScript) besides VBScript in HTAs,     -->
<!--    you MUST specify the language for ALL on**** events, e.g.        -->
<!--    onclick="javascript:_jsMaxWin" or onclick="vbscript:ShowMain"    -->
<!-- ------------------------------------------------------------------- -->

<!-- This "HHCtrlMinimizeWindowObject" works together with the JavaScript function "_jsMinWin()" and the hidden input "MinimizeWindow" to minimize the HTA window (use "MinimizeWindow.click" in VBScript) -->
<object id="HHCtrlMinimizeWindowObject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
  <param name="command" value="minimize" />
</object>

<script type="text/javascript">
function _jsMinWin( ) {
	try {
		HHCtrlMinimizeWindowObject.Click( );
	}
	catch ( err ) {
		alert( err.message );
	}
}
</script>

<!-- This "HHCtrlMaximizeWindowObject" works together with the JavaScript function "_jsMaxWin()" and the hidden input "MaximizeWindow" to maximize the HTA window (use "MaximizeWindow.click" in VBScript) -->
<object id="HHCtrlMaximizeWindowObject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<param name="command" value="maximize" />
</object>

<script type="text/javascript">
function _jsMaxWin( ) {
	try {
		HHCtrlMaximizeWindowObject.Click( );
	}
	catch ( err ) {
		alert( err.message );
	}
};
</script>

</head>

<script language="VBScript">
Option Explicit

Const TristateFalse      =  0
Const TristateMixed      = -2
Const TristateTrue       = -1
Const TristateUseDefault = -2

Const ForAppending = 8
Const ForReading   = 1
Const ForWriting   = 2

Const HKEY_CLASSES_ROOT   = &H80000000
Const HKEY_CURRENT_USER   = &H80000001
Const HKEY_LOCAL_MACHINE  = &H80000002
Const HKEY_USERS          = &H80000003
Const HKEY_CURRENT_CONFIG = &H80000005

Const REG_SZ                         =  1
Const REG_EXPAND_SZ                  =  2
Const REG_BINARY                     =  3
Const REG_DWORD                      =  4
Const REG_DWORD_BIG_ENDIAN           =  5
Const REG_LINK                       =  6
Const REG_MULTI_SZ                   =  7
Const REG_RESOURCE_LIST              =  8
Const REG_FULL_RESOURCE_DESCRIPTOR   =  9
Const REG_RESOURCE_REQUIREMENTS_LIST = 10
Const REG_QWORD                      = 11

' Year to be displayed in copyrights notices
Dim gviCopyrightsYear
gviCopyrightsYear = 2017

' Variables for a tweak for Internet Explorer 7 and older versions
' If gvbIE7 is False then multiple HDDs, CDROMs etc. are revealed using style.display = "table-row"
' If gvbIE7 is True then multiple HDDs, CDROMs etc. are revealed using style.display = "inline"
Dim gvbIE7, gvsTableRowStyle

' Variables to hold the command line
Dim gvsCommandline, gvsCommandlineUC

' Global File System Object
Dim gvoFSO

' Global variables to receive the WinSAT scores
Dim sngCPU, sngDisk, sngMemory, sngTotal, sngVideo

' Minimum window size
Dim gviMinHeight, gviMinWidth

' Configuration file
Dim gvsConfigFile

' Temporary files to display detailed query results and print previews without requiring Internet Explorer
Dim gvsDetailsFile, gvsPrintFile

' Path to DMIDecode.exe
Dim gvsDMIDecode

' Dictionary objects to hold all defaults, permanent settings and session settings
Dim gvaDefaultsBool, gvaDefaultsStr, gvaSettingsBool, gvaSettingsStr

' Internet connection available?
Dim gvbConnected
gvbConnected = True

' Dictionaries containg translations
Dim gvaTranslationsBIOS, gvaTranslationsButtons, gvaTranslationsCDROMs
Dim gvaTranslationsCPU, gvaTranslationsGlobal, gvaTranslationsHarddisks
Dim gvaTranslationsHID, gvaTranslationsMainBoard, gvaTranslationsMemory
Dim gvaTranslationsMonitors, gvaTranslationsNIC, gvaTranslationsPorts
Dim gvaTranslationsSettings, gvaTranslationsSound, gvaTranslationsVideo

' Other global variables
Dim gvaCDROM( ), gvaCSSColors, gvaHDC( ), gvaHDD( ), gvaHost( ), gvaPATH, gvaVideo( )
Dim gvbSilent, gvbWinPE
Dim clrBgErr, clrTxtErr
Dim gvcBanks, gvcCDROM, gvcCPU, gvcHDD, gvcMemory, gvcMonitor, gvcNIC, gvcVideo
Dim gviCDROM, gviHDC, gviHDD, gviHost, gviNumOS, gviMemSize, gviMemSpeed
Dim gvoIEDebug, gvoIEPrint, gvoWMIService, gvoWSHShell
Dim gvsComputer, gvsCSVTxt, gvsDebugText, gvsDetails, gvsHeader, gvsPATH, gvsSlots, gvsWinDrive


Sub Add2CsvBIOS( )
	gvsHeader = gvsHeader              & vbTab _
              & "BIOS Manufacturer:"   & vbTab _
	          & "BIOS Model:"          & vbTab _
	          & "BIOS Version:"        & vbTab _
	          & "BIOS Date:"           & vbTab _
	          & "BIOS Serial Number:"
	gvsCSVTxt = gvsCSVTxt              & vbTab _
	          & BIOSManufacturer.value & vbTab _
	          & BIOSModel.value        & vbTab _
	          & BIOSVersion.value      & vbTab _
	          & BIOSDate.value         & vbTab _
	          & strBIOSSerial
End Sub


Sub Add2CsvCDROM( )
	Dim i
	For i = 0 To 3
		gvsHeader = gvsHeader & vbTab & "CDROM " & i & " Model:"
		gvsHeader = gvsHeader & vbTab & "CDROM " & i & " Firmware:"
		gvsHeader = gvsHeader & vbTab & "CDROM " & i & " Interface:"
		gvsCSVTxt = gvsCSVTxt & vbTab & document.getElementById( "CDROM" & i & "Model"     ).value
	    gvsCSVTxt = gvsCSVTxt & vbTab & document.getElementById( "CDROM" & i & "Firmware"  ).value
	    gvsCSVTxt = gvsCSVTxt & vbTab & document.getElementById( "CDROM" & i & "Interface" ).value
	Next
End Sub


Sub Add2CsvCPU
	gvsHeader = gvsHeader       & vbTab _
	          & "# CPUs:"       & vbTab _
              & "CPU Type:"     & vbTab _
              & "CPU Speed:"    & vbTab _
              & "CPU Socket:"   & vbTab _
              & "CPU Score:"
	gvsCSVTxt = gvsCSVTxt       & vbTab _
              & CPUNumber.value & vbTab _
              & CPUModel.value  & vbTab _
              & CPUSpeed.value  & vbTab _
              & CPUSocket.value & vbTab _
              & sngCPU
End Sub


Sub Add2CsvHDD( )
	Dim i
	For i = 0 To 7
		gvsHeader = gvsHeader & vbTab & "HDD " & i & " Model:"
		gvsHeader = gvsHeader & vbTab & "HDD " & i & " Size (GB):"
		gvsHeader = gvsHeader & vbTab & "HDD " & i & " Interface:"
		gvsCSVTxt = gvsCSVTxt & vbTab & document.getElementById( "HardDisk" & i & "Model"     ).value
		gvsCSVTxt = gvsCSVTxt & vbTab & document.getElementById( "HardDisk" & i & "Size"      ).value
		gvsCSVTxt = gvsCSVTxt & vbTab & document.getElementById( "HardDisk" & i & "Interface" ).value
	Next
	gvsHeader = gvsHeader & vbTab & "Disk Score:"
	gvsCSVTxt = gvsCSVTxt & vbTab & sngDisk
End Sub


Sub Add2CsvHID( )
	gvsHeader = gvsHeader        & vbTab _
	          & "Mouse Type:"    & vbTab _
	          & "Mouse Model:"   & vbTab _
	          & "Keyboard Type:" & vbTab _
	          & "Keyboard Model:"
	gvsCSVTxt = gvsCSVTxt        & vbTab _
	          & MouseType.value  & vbTab _
	          & MouseModel.value & vbTab _
	          & KbdType.value    & vbTab _
	          & KbdModel.value
End Sub


Sub Add2CsvMainBoard( )
	gvsHeader = gvsHeader            & vbTab _
	          & "Chassis:"           & vbTab _
	          & "MB Manufacturer:"   & vbTab _
	          & "MB Model:"          & vbTab _
	          & "MB Version:"        & vbTab _
	          & "WinSAT Score:"
	gvsCSVTxt = gvsCSVTxt            & vbTab _
	          & ChassisType.value    & vbTab _
	          & MBManufacturer.value & vbTab _
	          & MBModel.value        & vbTab _
	          & MBVersion.value      & vbTab _
	          & sngTotal
End Sub


Sub Add2CsvMemory
	gvsHeader = gvsHeader            & vbTab _
	          & "# Memory Banks:"    & vbTab _
              & "# Memeory Modules:" & vbTab _
              & "Total Memory (MB):" & vbTab _
              & "Memory Score:"
    gvsCSVTxt = gvsCSVTxt            & vbTab _
	          & gvcBanks             & vbTab _
	          & gvcMemory            & vbTab _
	          & MemorySize.value     & vbTab _
	          & sngMemory
End Sub


Sub Add2CsvNIC
	Dim i
	For i = 0 To 3
		gvsHeader = gvsHeader & vbTab & "NIC " & i & " Model:"
		gvsHeader = gvsHeader & vbTab & "NIC " & i & " MAC Address:"
		gvsHeader = gvsHeader & vbTab & "NIC " & i & " Speed:"
		gvsCSVTxt = gvsCSVTxt & vbTab & document.getElementById( "NICModel" & i ).value
		gvsCSVTxt = gvsCSVTxt & vbTab & document.getElementById( "MACAddress" & i ).value
		gvsCSVTxt = gvsCSVTxt & vbTab & document.getElementById( "NICSpeed" & i ).value
	Next
End Sub


Sub Add2CsvPorts
	gvsHeader = gvsHeader         & vbTab _
	          & "USB:"            & vbTab _
	          & "System Slots:"   & vbTab _
	          & "Parallel Ports:" & vbTab _
	          & "Serial Ports:"
	gvsCSVTxt = gvsCSVTxt         & vbTab _
	          & USB.value         & vbTab _
	          & gvsSlots          & vbTab _
	          & Parallel.value    & vbTab _
	          & Serial.value
End Sub


Sub Add2CsvSound
	gvsHeader = gvsHeader                   & vbTab _
	          & "Sound Card Model:"         & vbTab _
	          & "Sound Card Manufacturer:"
	gvsCSVTxt = gvsCSVTxt                   & vbTab _
	          & SoundCardManufacturer.value & vbTab _
	          & SoundCardModel.value
End Sub


Sub Add2CsvVideo( )
	Dim i
	For i = 0 To 3
		gvsHeader = gvsHeader & vbTab & "Video " & i & " Model:"
		gvsHeader = gvsHeader & vbTab & "Video " & i & " Memory (MB):"
		gvsHeader = gvsHeader & vbTab & "Video " & i & " Mode:"
		gvsCSVTxt = gvsCSVTxt & vbTab & document.getElementById( "VideoModel"  & i ).value
		gvsCSVTxt = gvsCSVTxt & vbTab & document.getElementById( "VideoMemory" & i ).value
		gvsCSVTxt = gvsCSVTxt & vbTab & document.getElementById( "VideoMode"   & i ).value
	Next
End Sub


Function Align( myString, myLength )
	Align = Left( myString & Space( myLength ), myLength )
End Function


Function ArraySort( ByRef myArray )
	' Bubble sort algorithm found in Microsoft's Script Repository
	' http://www.microsoft.com/technet/scriptcenter/resources/qanda/nov04/hey1122.mspx
	Dim i, j, k, strHolder
	If UBound( myArray ) > 1 Then
		For i = UBound( myArray ) - 1 To 0 Step -1
			For j= 0 to i
				k = j + 1
				If UCase( myArray(j) ) > UCase( myArray(k) ) Then
					strHolder  = myArray(k)
					myArray(k) = myArray(j)
					myArray(j) = strHolder
				End If
			Next
		Next
	End If
	ArraySort = myArray
End Function


Sub Basic( )
	gvaSettingsBool.Item( "BASIC" ) = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxBIOS.Checked            = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxCDROM.Checked           = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxCPU.Checked             = True
	CheckboxHDD.Checked             = True
	CheckboxHID.Checked             = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxMainBoard.Checked       = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxMemory.Checked          = True
	CheckboxMonitor.Checked         = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxNIC.Checked             = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxPorts.Checked           = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxVideo.Checked           = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxSound.Checked           = Not gvaSettingsBool.Item( "BASIC" )
	If gvaSettingsBool.Item( "BASIC" ) Then
		ButtonBasic.value     = "Full"
		ButtonBasic.accessKey = "f"
	Else
		ButtonBasic.value     = "Basic"
		ButtonBasic.accessKey = "b"
	End If
End Sub


Function Chain( myCharList )
	Dim intChar, strChar, strCharChain
	Chain = ""
	If Not IsArray( myCharList ) Then
		If InStr( myCharList, ";" ) Then
			myCharList = Split( myCharList, ";" )
		ElseIf InStr( myCharList, "," ) Then
			myCharList = Split( myCharList, "," )
		Else
			Exit Function
		End If
	End If
	For Each intChar In myCharList
		If CInt( intChar ) = 0 Then
			' Uncomment next line to abort at first null character
			' Exit For
			' Comment next line when aborting at first null character
			strChar = " "
		Else
			strChar = Chr( intChar )
		End If
		strCharChain = strCharChain & strChar
	Next
	Chain = Trim( strCharChain )
End Function


Function Chassis( )
	' Based on a script by Guy Thomas http://computerperformance.co.uk/
	Dim colChassis, objChassis
	Chassis = "Unknown"
	Set colChassis = gvoWMIService.ExecQuery( "Select ChassisTypes from Win32_SystemEnclosure" )
	For Each objChassis in colChassis
		Select Case objChassis.ChassisTypes(0) ' ChassisTypes is returned as an array of integers
			Case  1 Chassis = "Maybe Virtual Machine"
			Case  2 chassis = "Unknown"
			Case  3 Chassis = "Desktop"
			Case  4 Chassis = "Thin Desktop"
			Case  5 Chassis = "Pizza Box"
			Case  6 Chassis = "Mini Tower"
			Case  7 Chassis = "Full Tower"
			Case  8 Chassis = "Portable"
			Case  9 Chassis = "Laptop"
			Case 10 Chassis = "Notebook"
			Case 11 Chassis = "Hand Held"
			Case 12 Chassis = "Docking Station"
			Case 13 Chassis = "All in One"
			Case 14 Chassis = "Sub Notebook"
			Case 15 Chassis = "Space-Saving"
			Case 16 Chassis = "Lunch Box"
			Case 17 Chassis = "Main System Chassis"
			Case 18 Chassis = "Lunch Box"
			Case 19 Chassis = "SubChassis"
			Case 20 Chassis = "Bus Expansion Chassis"
			Case 21 Chassis = "Peripheral Chassis"
			Case 22 Chassis = "Storage Chassis"
			Case 23 Chassis = "Rack Mount Unit"
			Case 24 Chassis = "Sealed-Case PC"
		End Select
	Next
End Function


Function CheckComputerName( myComputerName )
	Dim strComputerName
	strComputerName = myComputerName
	If gvbWinPE Then Exit Function
	On Error Resume Next
	Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_ComputerSystem" )
	For Each objItem in colItems
    	strComputerName = objItem.Name
	Next
	On Error Goto 0
	If strComputerName = "" Then strComputerName = myComputerName
	CheckComputerName = UCase( strComputerName )
End Function


Sub CheckDMIDecode( )
	Dim blnFound, i, objFSO
	blnFound = False
	If gvbWinPE Then Exit Sub
	For i = 0 To UBound( gvaPATH )
		With gvoFSO
			gvsDMIDecode = .BuildPath( gvaPATH(i), "dmidecode.exe" )
			If .FileExists( gvsDMIDecode ) Then
				blnFound = True
				Exit For
			End If
		End With
	Next
	gvaSettingsBool.Item( "DMIDECODE" ) = gvaSettingsBool.Item( "DMIDECODE" ) And blnFound
	CheckboxDMIDecode.disabled = Not blnFound
End Sub


Sub CheckKey( )
	If SettingsScreen.style.display = "none" Then ' Not in Settings screen
		If Self.window.event.keyCode =  8 Then ShowMain             ' BackSpace => Back to main window
	End if
	If Self.window.event.keyCode = 27 Then ShowMain                 ' Esc       => Back to main window
	' NOTE: accesskey properties are ignored on hidden elements,
	'       so we cannot implement Alt+n and Alt+x through
	'       accesskeys on their respective input elements
	If Self.window.event.altKey Then
		If Self.window.event.keyCode = 68 Then ' Alt+d
			' Toggle Debug mode
			If gvaSettingsBool.Item( "DEBUG" ) Then
				' Save the Debug data to a log file, if that option was selected
				'If gvaSettingsBool.Item( "LOG" ) Then 
				SaveDebugLog
				gvaSettingsBool.Item( "DEBUG" ) = False
'				On Error Resume Next
				gvoIEDebug.Quit
				Set gvoIEDebug = Nothing
				On Error Goto 0
			Else
				gvaSettingsBool.Item( "DEBUG" ) = True
			End If
			ConfigUpdateStatus
		End If
		If Self.window.event.keyCode = 78 Then MinimizeWindow.click ' Alt+n => miNimize window
		If Self.window.event.keyCode = 87 Then DebugDetailsWindow   ' Alt+w => Window details
		If Self.window.event.keyCode = 88 Then MaximizeWindow.click ' Alt+x => maXimize window
	End If
End Sub


Sub CheckUpdate( )
	Dim intAnswer, intButtons, lenLatestVer, strCurrentVer, strLatestver, strPrompt, strTitle

	If Not gvaSettingsBool.Item( "NOUPD" ) And Not gvbWinPE Then
		' Change cursor to hourglass while checking for update
		Document.Body.style.Cursor = "wait"
	
		intButtons = vbYesNoCancel + vbApplicationModal + vbInformation
		strCurrentVer = Split( Hardware.Version )(0)
		strLatestVer  = TextFromHTML( "http://www.robvanderwoude.com/updates/hardware.txt" )

		If strCurrentVer <> strLatestver Then
'			On Error Resume Next
			' Clear the IE cache
			gvoWSHShell.Run "RUNDll32.EXE InetCpl.cpl,ClearMyTracksByProcess 8", 7, True
			' Try again, read the latest version info from the web
			strLatestver = TextFromHTML( "http://www.robvanderwoude.com/updates/hardware.txt" )
			On Error Goto 0
		End If

		DebugMessage "Check for Update", Align( "Connected to Internet:", 25 ) & gvbConnected  & vbCrLf & Align( "Current Version:", 25 ) & strCurrentVer & vbCrLf & Align( "Latest  Version:", 25 ) & strLatestver  & vbCrLf

		If gvbConnected Then
			lenLatestVer = Len( strLatestVer )
			If lenLatestVer = 4 Then
				If strLatestVer < strCurrentVer Then
					strTitle  = "Unofficial version"
					strPrompt = "You seem to be using a pre-release version (" & strCurrentVer & ") of Hardware.hta." _
					          & vbCrLf & vbCrLf _
					          & "The latest official release is " & strLatestver _
					          & vbCrLf & vbCrLf _
					          & "Do you want to download the latest official release?"
					intAnswer = MsgBox( strPrompt, intButtons + vbDefaultButton2, strTitle )
					If intAnswer = vbYes Then
						gvoWSHShell.Run "http://www.robvanderwoude.com/hardware.php", 7, False
					End If
				End If
				If strLatestVer > strCurrentVer Then
					strTitle  = "Old version"
					strPrompt = "You are using version " & strCurrentVer & " of Hardware.hta." _
					          & vbCrLf & vbCrLf _
					          & "The latest official release is " & strLatestver _
					          & vbCrLf & vbCrLf _
					          & "Do you want to download the latest official release?"
					intAnswer = MsgBox( strPrompt, intButtons, strTitle )
					If intAnswer = vbYes Then
						gvoWSHShell.Run "http://www.robvanderwoude.com/hardware.php", 7, False
					End If
				End If
			Else
				strTitle  = "Update Check Failure"
				strPrompt = "Unable to check for updates." _
				          & vbCrLf & vbCrLf _
				          & "Do you want to ""manually"" check for updates now?"
				intAnswer = MsgBox( strPrompt, intButtons, strTitle )
				If intAnswer = vbYes Then
					gvoWSHShell.Run "http://www.robvanderwoude.com/hardware.php", 7, False
				End If
			End If
		End If
	
		' Change cursor back to default
		Document.Body.style.Cursor = "default"
	End If
End Sub


Function CheckWinPE( )
	' Check if running in WinPE environment
	' Based on a tip by Mitch Tulloch
	' http://techgenix.com/HowtodetectwhetheryouareinWindowsPE/
	Dim arrKeys, blnWinPE, colItems, i, objItem, objReg
	blnWinPE = False
    Set objReg = GetObject( "winmgmts:{impersonationLevel=impersonate}!//./root/default:StdRegProv" )
	objReg.EnumKey HKEY_LOCAL_MACHINE, "SYSTEM\ControlSet001\Control", arrKeys
	For i = 0 To UBound( arrKeys )
		If UCase( arrKeys(i) ) = "MININT" Then
			blnWinPE = True
			Exit For
		End If
	Next
	Set objReg = Nothing
	If blnWinPE Then
		' Find computer name when in WinPE
		' Based on code by Richie Schuster
		' http://www.sccmog.com/get-current-old-machine-name-winpe-vbscript/
		On Error Resume Next
		Set colItems = objWMIService.ExecQuery ( "Select * From Win32_LogicalDisk" )
		gvsWinDrive = ""
		For Each objItem in colItems
			' Find Windows system drive (won't work if Windows folder is renamed)
			If gvoFSO.FolderExists( objFSO.BuildPath( objItem.DeviceID, "Windows\System32\config" ) ) Then
				gvsWinDrive = objItem.DeviceID
			End If
		Next
		Set colItems = Nothing
		If gvsWinDrive <> "" Then
			' Mount registry hive from Windows Drive
			gvoWSHShell.Run "CMD.EXE /C REG.EXE Load HKLM\TempHive " & gvsWinDrive & "\windows\system32\config\system", 0, True
			' Read computer name from mounted registry hive
			gvsComputer = wshShell.RegRead( "HKEY_LOCAL_MACHINE\TempHive\ControlSet001\Control\ComputerName\ComputerName" )
			' Unmount temporary registry hive
			gvoWSHShell.Run "CMD.EXE /C REG.EXE Unload HKLM\TempHive", 0, True
		End If
		On Error Goto 0
	End If
	CheckWinPE = blnWinPE
End Function


Sub ConfigReadCommandline( )
	Dim objFSO
	Dim strDebug, strItem, strKey, strSubItem
	Set objFSO = CreateObject( "Scripting.FileSystemObject" )
	For Each strKey In gvaSettingsBool.Keys
		If InStr( gvsCommandlineUC, "/" & strKey ) Then gvaSettingsBool.Item( strKey ) = True
	Next
	strItem = GetParameter( gvsCommandline, "COMPUTER" )
	If strItem <> "" Then gvaSettingsStr.Item( "COMPUTER" ) = UCase( strItem )
	strItem = GetParameter( gvsCommandline, "SAVE" )
	If strItem <> "" Then
		With objFSO
			strItem = .GetAbsolutePathName( strItem )
			If .FolderExists( .GetParentFolderName( strItem ) ) Then
				gvaSettingsStr.Item( "SAVE" ) = strItem
			Else
				gvaSettingsStr.Item( "SAVE" ) = ""
			End If
		End With
	End If
	strItem = GetParameter( gvsCommandline, "SIZE" )
	If strItem <> "" Then gvaSettingsStr.Item( "SIZE" ) = ValidatedWindowSize( strItem )
	strItem = GetParameter( gvsCommandline, "THEME" )
	Select Case UCase( strItem )
		Case "BW":
			gvaSettingsStr.Item( "THEME" ) = "ThemeBW"
		Case "CUSTOM":
			gvaSettingsStr.Item( "THEME" ) = "ThemeCustom"
		Case "DEFAULT":
			gvaSettingsStr.Item( "THEME" ) = "ThemeDefault"
		Case "RED":
			gvaSettingsStr.Item( "THEME" ) = "ThemeRed"
	End Select
	strSubItem = GetParameter( gvsCommandline, "CUSTOMCOLORS" )
	If ( strItem = "" Or gvaSettingsStr.Item( "THEME" ) = "ThemeCustom" ) And strSubItem <> "" Then
		gvaSettingsStr.Item( "CUSTOMCOLORS" ) = LCase( strSubItem )
		gvaSettingsStr.Item( "THEME" )        = "ThemeCustom"
	End If
	strItem = GetParameter( gvsCommandline, "XML" )
	If strItem <> "" Then
		With objFSO
			strItem = .GetAbsolutePathName( strItem )
			If .FolderExists( .GetParentFolderName( strItem ) ) Then
				gvaSettingsStr.Item( "XML" ) = strItem
			End If
		End With
	End If
	strDebug = Align( "<u>Setting:</u>", 21 ) & "<u>Value:</u>" & vbCrLf
	For Each strKey In gvaSettingsBool.Keys
		strDebug = strDebug & Align( strKey, 14 ) & gvaSettingsBool.Item( strKey ) & vbCrLf
	Next
	For Each strKey In gvaSettingsStr.Keys
		strDebug = strDebug & Align( strKey, 14 ) & """" & gvaSettingsStr.Item( strKey ) & """" & vbCrLf
	Next
	DebugMessage "Settings After Reading Command Line", strDebug
	DisplayCommandLine.innerHTML = Trim( Mid( gvsCommandline, InStr( gvsCommandline, "Hardware.hta" ) + Len( "Hardware.hta" ) + 1 ) )
	Set objFSO = Nothing
End Sub


Sub ConfigReadDefaults( )
	Dim strDebug, strKey
	gvaDefaultsBool.Item( "BASIC" )       = False
	gvaDefaultsBool.Item( "CHAIN" )       = False
	gvaDefaultsBool.Item( "CM" )          = False
	gvaDefaultsBool.Item( "COPY" )        = False
	gvaDefaultsBool.Item( "DEBUG" )       = False
	gvaDefaultsBool.Item( "DEVTEST" )     = False
	gvaDefaultsBool.Item( "DMIDECODE" )   = False
	gvaDefaultsBool.Item( "DXDIAG" )      = False
	gvaDefaultsBool.Item( "KEEPXML" )     = False
	gvaDefaultsBool.Item( "NOIE" )        = False
	gvaDefaultsBool.Item( "NOUPD" )       = False
	gvaDefaultsBool.Item( "NOSCORES" )    = False
	gvaDefaultsBool.Item( "PRINT" )       = False
	gvaDefaultsBool.Item( "USBSTOR" )     = False
	gvaDefaultsStr.Item( "COMPUTER" )     = GetLocalComputerName( )
	gvaDefaultsStr.Item( "CUSTOMCOLORS" ) = "blue;black;white;red;silver;black;yellow" ' StartGradient;EndGradient;Captions;Links
	gvaSettingsStr.Item( "DEBUGLOG" )     = Left( Self.location.pathname, Len( Self.location.pathname ) - 4 ) & ".log"
	gvaDefaultsStr.Item( "SAVE" )         = ""
	gvaDefaultsStr.Item( "SIZE" )         = window.screen.width & "x" & window.screen.height
	gvaDefaultsStr.Item( "THEME" )        = "ThemeDefault" ' ThemeDefault, ThemeBW, ThemeCustom or ThemeRed
	gvaDefaultsStr.Item( "XML" )          = Left( Self.location.pathname, Len( Self.location.pathname ) - 4 ) & ".xml"
	ConfigSetDefaults
	strDebug = Align( "<u>Setting:</u>", 21 ) & "<u>Value:</u>" & vbCrLf
	For Each strKey In gvaDefaultsBool.Keys
		strDebug = strDebug & Align( strKey, 14 ) & gvaSettingsBool.Item( strKey ) & vbCrLf
	Next
	For Each strKey In gvaDefaultsStr.Keys
		strDebug = strDebug & Align( strKey, 14 ) & """" & gvaSettingsStr.Item( strKey ) & """" & vbCrLf
	Next
	DebugMessage "Settings After Reading Defaults", strDebug
End Sub


Sub ConfigReadFile( )
	Dim intMinSize, intSize
	Dim objFile, objFSO
	Dim strDebug, strConfig, strItem, strKey, strSubItem, strUConfig
	Set objFSO = CreateObject( "Scripting.FileSystemObject" )
	If objFSO.FileExists( gvsConfigFile ) Then
		' Check config file size
		Set objFile = objFSO.GetFile( gvsConfigFile )
		intSize = objFile.Size
		Set objFile = Nothing
		' Check minimum required file size by "measuring" command line switch length
		intMinSize = 9999
		For Each strKey In gvaDefaultsBool.Keys
			intMinSize = Min( intMinSize, Len( strKey ) )
		Next
		' Add 1 for the forward slash
		intMinSize = intMinSize + 1
		' Config file is useless if its size is less than the length of the shortest command line switch
		If intSize < intMinSize Then
			objFSO.DeleteFile gvsConfigFile, True
		Else
			' Read the entire contents of the configuration file
			Set objFile = objFSO.OpenTextFile( gvsConfigFile, ForReading, False, TristateFalse )
			strConfig  = Trim( Replace( objFile.ReadAll( ), vbCrLf, " " ) )
			strUConfig = UCase( strConfig )
			objFile.Close
			Set objFile = Nothing
			' Replace all whitespace (space, tab, linefeed, carriage return, or any combination) by single spaces
			DisplayConfig.innerHTML = Join( Split( strConfig, vbCrLf ), " " )
			DisplayConfig.innerHTML = Join( Split( DisplayConfig.innerHTML, vbCr ), " " )
			DisplayConfig.innerHTML = Join( Split( DisplayConfig.innerHTML, vbLf ), " " )
			DisplayConfig.innerHTML = Trim( Join( Split( DisplayConfig.innerHTML, vbTab ), " " ) )
			For Each strKey In gvaSettingsBool.Keys
				If InStr( strUConfig, "/" & strKey ) Then gvaSettingsBool.Item( strKey ) = True
			Next
			strItem = GetParameter( strConfig, "SIZE" )
			gvaSettingsStr.Item( "SIZE" ) = ValidatedWindowSize( strItem )
			strItem = GetParameter( strConfig, "THEME" )
			Select Case UCase( strItem )
				Case "BW":
					gvaSettingsStr.Item( "THEME" ) = "ThemeBW"
				Case "CUSTOM":
					gvaSettingsStr.Item( "THEME" ) = "ThemeCustom"
				Case "DEFAULT":
					gvaSettingsStr.Item( "THEME" ) = "ThemeDefault"
				Case "RED":
					gvaSettingsStr.Item( "THEME" ) = "ThemeRed"
			End Select
			strSubItem = GetParameter( strConfig, "CUSTOMCOLORS" )
			If ( strItem = "" Or gvaSettingsStr.Item( "THEME" ) = "ThemeCustom" ) And strSubItem <> "" Then
				gvaSettingsStr.Item( "CUSTOMCOLORS" ) = LCase( strSubItem )
				gvaSettingsStr.Item( "THEME" )        = "ThemeCustom"
			End If
			strItem = GetParameter( strConfig, "XML" )
			If strItem <> "" Then
				With objFSO
					If .FolderExists( .GetParentFolderName( .GetAbsolutePathName( strItem ) ) ) Then
							gvaSettingsStr.Item( "XML" ) = .GetAbsolutePathName( strItem )
					End If
				End With
			End If
		End If
	End If
	Set objFSO = Nothing
	strDebug = Align( "<u>Setting:</u>", 21 ) & "<u>Value:</u>" & vbCrLf
	For Each strKey In gvaDefaultsBool.Keys
		strDebug = strDebug & Align( strKey, 14 ) & gvaSettingsBool.Item( strKey ) & vbCrLf
	Next
	For Each strKey In gvaDefaultsStr.Keys
		strDebug = strDebug & Align( strKey, 14 ) & """" & gvaSettingsStr.Item( strKey ) & """" & vbCrLf
	Next
	DebugMessage "Settings After Reading " & gvsConfigFile, strDebug
End Sub


Sub ConfigRemoveFile( )
	Dim objFSO
	Set objFSO = CreateObject( "Scripting.FileSystemObject" )
	If objFSO.FileExists( gvsConfigFile ) Then objFSO.DeleteFile gvsConfigFile, True
	Set objFSO = Nothing
End Sub


Sub ConfigReset( )
	ConfigRemoveFile
	ConfigSetDefaults
	ConfigUpdateStatus
End Sub


Sub ConfigSaveChanges( )
	Dim objOption, strCustomColors, strDebug, strKey
	With gvoFSO
		InputDxDiag.value = .GetAbsolutePathName( InputDxDiag.value )
		If .FolderExists( .GetParentFolderName( InputDxDiag.value ) ) Then
				InputDxDiag.value = InputDxDiag.value
		End If
		InputDebugLogPath.value = .GetAbsolutePathName( InputDebugLogPath.value )
		If .FolderExists( .GetParentFolderName( InputDebugLogPath.value ) ) Then
				InputDebugLogPath.value = InputDebugLogPath.value
		End If
	End With
	MsgBox InputDebugLogPath.value
	gvaSettingsBool.Item( "CM" )        = CheckboxCM.checked
	gvaSettingsBool.Item( "CHAIN" )     = CheckboxCharacterChains.checked
	gvaSettingsBool.Item( "DEBUG" )     = CheckboxDebugMode.checked
	gvaSettingsBool.Item( "DMIDECODE" ) = CheckboxDMIDecode.checked
	gvaSettingsBool.Item( "DXDIAG" )    = CheckboxDxDiag.checked
	gvaSettingsBool.Item( "KEEPXML" )   = CheckboxKeepXML.checked
	gvaSettingsBool.Item( "NOIE" )      = CheckboxDefaultBrowser.checked
	gvaSettingsBool.Item( "NOUPD" )     = Not CheckboxCheckUpd.checked
	gvaSettingsBool.Item( "NOSCORES" )  = Not CheckboxScores.checked
	gvaSettingsBool.Item( "USBSTOR" )   = CheckboxUSBSTOR.checked
	If gvaSettingsStr.Item( "XML" ) <> "" Then
		If InputDxDiag.value <> "" Then
			gvaSettingsStr.Item( "XML" ) = gvaDefaultsStr.Item( "XML" )
		Else
			gvaSettingsStr.Item( "XML" ) = InputDxDiag.value
		End If
	End If
	If InputDebugLogPath.value = "" Then
		gvaSettingsStr.Item( "DEBUGLOG" ) = gvaDefaultsStr.Item( "DEBUGLOG" )
	Else
		gvaSettingsStr.Item( "DEBUGLOG" ) = InputDebugLogPath.value
	End If
	gvaSettingsStr.Item( "SIZE" ) = ValidatedWindowSize( InputSize.value )
	DebugDetailsWindow
	DebugMessage "", "ConfigSaveChanges( ) call to WindowSize( )"
	WindowSize
	If ThemeDefault.checked Then
		gvaSettingsStr.Item( "THEME" )        = "ThemeDefault"
		gvaSettingsStr.Item( "CUSTOMCOLORS" ) = "blue;black;white;red;silver;black;yellow"
	ElseIf ThemeBW.checked Then
		gvaSettingsStr.Item( "THEME" )        = "ThemeBW"
		gvaSettingsStr.Item( "CUSTOMCOLORS" ) = "white;white;black;blue;silver;black;black"
	ElseIf ThemeRed.checked Then
		gvaSettingsStr.Item( "THEME" )        = "ThemeRed"
		gvaSettingsStr.Item( "CUSTOMCOLORS" ) = "red;darkred;yellow;darkblue;silver;black;white"
	ElseIf ThemeCustom.checked Then
		For Each objOption In GradientTopColor.options
			If objOption.selected Then strCustomColors = objOption.value
		Next
		For Each objOption In GradientBottomColor.options
			If objOption.selected Then strCustomColors = strCustomColors & ";" & objOption.value
		Next
		For Each objOption In CaptionsColor.options
			If objOption.selected Then strCustomColors = strCustomColors & ";" & objOption.value
		Next
		For Each objOption In LinksColor.options
			If objOption.selected Then strCustomColors = strCustomColors & ";" & objOption.value
		Next
		For Each objOption In ButtonFaceColor.options
			If objOption.selected Then strCustomColors = strCustomColors & ";" & objOption.value
		Next
		For Each objOption In ButtonCaptionsColor.options
			If objOption.selected Then strCustomColors = strCustomColors & ";" & objOption.value
		Next
		For Each objOption In CodeColor.options
			If objOption.selected Then strCustomColors = strCustomColors & ";" & objOption.value
		Next
		gvaSettingsStr.Item( "THEME" )        = "ThemeCustom"
		gvaSettingsStr.Item( "CUSTOMCOLORS" ) = LCase( strCustomColors )
	End If
	strDebug = Align( "<u>Setting:</u>", 21 ) & "<u>Value:</u>" & vbCrLf
	For Each strKey In gvaSettingsBool.Keys
		strDebug = strDebug & Align( strKey, 14 ) & gvaSettingsBool.Item( strKey ) & vbCrLf
	Next
	For Each strKey In gvaSettingsStr.Keys
		strDebug = strDebug & Align( strKey, 14 ) & """" & gvaSettingsStr.Item( strKey ) & """" & vbCrLf
	Next
	DebugMessage "Settings After Saving Changes", strDebug
End Sub


Sub ConfigSaveFile( )
	Dim objFile, objFSO
	dim strConfig, strKey
	strConfig = ""
	For Each strKey In gvaSettingsBool.Keys
		If gvaSettingsBool.Item( strKey ) Then
			If UCase( strKey ) = "NOIE" Then
				' Do NOT save /NOIE setting to file if it was enforced by a Windows Update issue
				If Not CheckboxDefaultBrowser.disabled Then
					strConfig = strConfig & " /NOIE"
				End If
			Else
				strConfig = strConfig & " /" & strKey
			End If
		End If
	Next
	If gvaSettingsStr.Item( "SIZE" ) <> "" Then
		If gvaSettingsStr.Item( "SIZE" ) <> "" Then
			strConfig = strConfig & " /SIZE:" & gvaSettingsStr.Item( "SIZE" )
		End If
	End If
	If gvaSettingsStr.Item( "XML" ) <> "" Then
		strConfig = strConfig & " /XML:" & gvaSettingsStr.Item( "XML" )
	End If
	If gvaSettingsStr.Item( "COMPUTER" ) <> "" Then
		If UCase( gvaSettingsStr.Item( "COMPUTER" ) ) <> UCase( GetLocalComputerName ) Then
			strConfig = strConfig & " /COMPUTER:" & UCase( gvaSettingsStr.Item( "COMPUTER" ) )
		End If
	End If
	If gvaSettingsStr.Item( "THEME" ) <> "" And gvaSettingsStr.Item( "THEME" ) <> "ThemeDefault" Then
		strConfig = strConfig & " /THEME:" & Mid( gvaSettingsStr.Item( "THEME" ), 6 )
		If gvaSettingsStr.Item( "THEME" ) = "ThemeCustom" Then
			If gvaSettingsStr.Item( "CUSTOMCOLORS" ) <> "" Then
				strConfig = Trim( strConfig & " /CUSTOMCOLORS:" & LCase( gvaSettingsStr.Item( "CUSTOMCOLORS" ) ) )
			End If
		End If
	End If
	Set objFSO  = CreateObject( "Scripting.FileSystemObject" )
	Set objFile = objFSO.OpenTextFile( gvsConfigFile, ForWriting, True, TristateFalse )
	objFile.Write strConfig
	objFile.Close
	Set objFile = Nothing
	Set objFSO  = Nothing
	DisplayConfig.innerHTML = strConfig
	DebugMessage "Saving Settings to " & gvsConfigFile, strConfig
End Sub


Sub ConfigSetDefaults( )
		Dim strKey
		For Each strKey In gvaDefaultsBool.Keys
			gvaSettingsBool.Item( strKey ) = gvaDefaultsBool.Item( strKey )
		Next
		For Each strKey In gvaDefaultsStr.Keys
			gvaSettingsStr.Item( strKey ) = gvaDefaultsStr.Item( strKey )
		Next
End Sub


Sub ConfigUpdateStatus( )
	Dim arrCustomColors, colElements, objElement, objOption
	If gvaSettingsBool.Item( "BASIC" ) Then
		ButtonBasic.value     = "Full"
		ButtonBasic.accessKey = "f"
	Else
		ButtonBasic.value     = "Basic"
		ButtonBasic.accessKey = "b"
	End If
	ButtonDeleteXML.disabled        = Not gvoFSO.FileExists( gvaSettingsStr.Item( "XML" ) )
	CheckboxCM.checked              = gvaSettingsBool.Item( "CM" )
	CheckboxCharacterChains.checked = gvaSettingsBool.Item( "CHAIN" )
	CheckboxDebugMode.checked       = gvaSettingsBool.Item( "DEBUG" )
	CheckDMIDecode
	CheckboxDMIDecode.checked       = gvaSettingsBool.Item( "DMIDECODE" )
	checkboxdmidecode.disabled      = gvbWinPE
	CheckboxDxDiag.checked          = gvaSettingsBool.Item( "DXDIAG" ) And Not gvbWinPE
	CheckboxDxDiag.disabled         = gvbWinPE
	CheckboxKeepXML.checked         = gvaSettingsBool.Item( "KEEPXML" ) And Not gvbWinPE
	CheckboxKeepXML.disabled        = gvbWinPE
	CheckboxDefaultBrowser.checked  = gvaSettingsBool.Item( "NOIE" )
	CheckboxCheckUpd.checked        = Not gvaSettingsBool.Item( "NOUPD" )
	CheckboxScores.checked          = Not gvaSettingsBool.Item( "NOSCORES" )
	CheckboxUSBSTOR.checked         = gvaSettingsBool.Item( "USBSTOR" )
	ComputerName.value              = gvaSettingsStr.Item( "COMPUTER" )
	InputSize.value                 = gvaSettingsStr.Item( "SIZE" )
	InputDxDiag.value               = gvaSettingsStr.Item( "XML" )
	InputDxDiag.readonly            = Not CheckboxDxDiag.checked Or gvbWinPE
	InputDebugLogPath.value         = gvaSettingsStr.Item( "DEBUGLOG" )
	InputDebugLogPath.disabled      = Not gvaSettingsBool.Item( "DEBUG" )
	If gvaSettingsStr.Item( "THEME" ) = "" Then
		ThemeDefault.checked = True
	Else
		document.getElementById( gvaSettingsStr.Item( "THEME" ) ).checked = True
	End If
	If ThemeCustom.checked Then
		arrCustomColors            = Split( gvaSettingsStr.Item( "CUSTOMCOLORS" ), ";" )
		document.body.style.filter = "progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr='" & arrCustomColors(0) & "', EndColorStr='" & arrCustomColors(1) & "')"
		For Each objOption In GradientTopColor.options
			objOption.selected = ( objOption.value = arrCustomColors(0) )
		Next
		For Each objOption In GradientBottomColor.options
			objOption.selected = ( objOption.value = arrCustomColors(1) )
		Next
		For Each objOption In CaptionsColor.options
			objOption.selected = ( objOption.value = arrCustomColors(2) )
		Next
		For Each objOption In LinksColor.options
			objOption.selected = ( objOption.value = arrCustomColors(3) )
		Next
		For Each objOption In ButtonFaceColor.options
			objOption.selected = ( objOption.value = arrCustomColors(4) )
		Next
		For Each objOption In ButtonCaptionsColor.options
			objOption.selected = ( objOption.value = arrCustomColors(5) )
		Next
		For Each objOption In CodeColor.options
			objOption.selected = ( objOption.value = arrCustomColors(6) )
		Next
	ElseIf ThemeBW.checked Then
		gvaSettingsStr.Item( "CUSTOMCOLORS" ) = "white;white;black;blue;silver;black;black"
		arrCustomColors                       = Split( gvaSettingsStr.Item( "CUSTOMCOLORS" ), ";" )
		document.body.style.filter            = "unset"
	ElseIf ThemeRed.checked Then
		gvaSettingsStr.Item( "CUSTOMCOLORS" ) = "red;darkred;yellow;darkblue;silver;black;white"
		arrCustomColors                       = Split( gvaSettingsStr.Item( "CUSTOMCOLORS" ), ";" )
		document.body.style.filter = "progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr='" & arrCustomColors(0) & "', EndColorStr='" & arrCustomColors(1) & "')"
	Else
		gvaSettingsStr.Item( "CUSTOMCOLORS" ) = "blue;black;white;red;silver;black;yellow"
		arrCustomColors                       = Split( gvaSettingsStr.Item( "CUSTOMCOLORS" ), ";" )
		document.body.style.filter            = "progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr='#0000FF', EndColorStr='#000000');"
	End If
	ListColors     "GradientTopColor",    arrCustomColors(0)
	ListColors     "GradientBottomColor", arrCustomColors(1)
	ListColors     "CaptionsColor",       arrCustomColors(2)
	ListColors     "LinksColor",          arrCustomColors(3)
	ListColors     "ButtonFaceColor",     arrCustomColors(4)
	ListColors     "ButtonCaptionsColor", arrCustomColors(5)
	ListColors     "CodeColor",           arrCustomColors(6)
	document.body.style.backgroundColor = arrCustomColors(1)
	SetCustomColor "CaptionsColor"
	SetCustomColor "LinksColor"
	SetCustomColor "ButtonFaceColor"
	SetCustomColor "ButtonCaptionsColor"
	SetCustomColor "CodeColor"
	EnableWinSATScores
	DebugDetailsWindow
	DebugMessage "", "ConfigUpdateStatus( ) call to WindowSize( )"
	DebugDetailsWindow
	WindowSize
End Sub


Sub CopyToClipboard
	On Error Resume Next
	Document.parentWindow.clipboardData.setData "text", gvsHeader & vbCrLf & gvsCSVTxt & vbCrLf
	If Err Then
		MsgBox "An error occurred while trying to copy data to the clipboard:" & vbCrLf & vbCrLf & Err.Description, vbOKOnly, "Clipboard Error"
	End If
	On Error Goto 0
End Sub


Function CreateLine( strProperty )
	' This subroutine will split up a string into separate words:
	' "SCSILogicalUnit" will be converted to "SCSI Logical Unit"
	Dim chrA, chrB, chrC
	Dim i, j, k
	Dim strCaps, strLowc, strPad, strPropDescr

	strPropDescr = strProperty
	strCaps      = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
	strPad       = String( 40, " " )
	strLowc      = LCase( strCaps )
	' Default value, in case something goes wrong
	CreateLine   = Left( strProperty & strPad, 41 ) & ": "
	On Error Resume Next
	i = 0
	Do
		i = i + 1
		j = i + 1
		If j >= Len( strPropDescr ) Then Exit Do
		chrA = Mid( strPropDescr, i, 1 )
		chrB = Mid( strPropDescr, j, 1 )
		If InStr( strLowc, chrA ) > 0 And InStr( strCaps, chrB ) > 0 Then
			strPropDescr = Left( strPropDescr, i ) & " " & Mid( strPropDescr, j )
			i = i + 2
			j = i + 1
		End If
	Loop
	If Len( strPropDescr ) > 2 Then
		i = 0
		Do
			i = i + 1
			j = i + 1
			k = i + 2
			If k >= Len( strPropDescr ) Then Exit Do
			chrA = Mid( strPropDescr, i, 1 )
			chrB = Mid( strPropDescr, j, 1 )
			chrC = Mid( strPropDescr, k, 1 )
			If InStr( strCaps, chrA ) > 0 And InStr( strCaps, chrB ) > 0 And InStr( strLowc, chrC ) > 0 Then
				strPropDescr = Left( strPropDescr, i ) & " " & Mid( strPropDescr, j )
				i = i + 3
				j = i + 1
				k = i + 2
			End If
		Loop
	End If
	CreateLine = Left( strPropDescr & strPad, 41 ) & ": "
	On Error Goto 0
End Function


Sub CreateIEDebug( )
	If Not gvaSettingsBool.Item( "NOIE" ) Then
		On Error Resume Next
		gvoIEDebug.Quit
		Set gvoIEDebug = Nothing
		Set gvoIEDebug = CreateObject( "InternetExplorer.Application" )
		If Err.Number = 70 Then
			gvaSettingsBool.Item( "NOIE" )  = True
			CheckboxDefaultBrowser.checked  = True
			CheckboxDefaultBrowser.disabled = True
			setTimeout "IEBugMessage", 100, "VBScript"
		Else
			While gvoIEDebug.Busy
				Sleep 1
			Wend
			' The following line, if run BEFORE navigating to about:blank, makes sure the IE window will open in the foreground.
			' Credits: Russell J. Wiley
			gvoWSHShell.AppActivate gvoIEDebug
			gvoIEDebug.Navigate "about:blank"
			gvoIEDebug.Height     = document.body.offsetHeight
			gvoIEDebug.Width      = document.body.offsetWidth
			gvoIEDebug.AddressBar = False
			gvoIEDebug.MenuBar    = False
			gvoIEDebug.StatusBar  = False
			gvoIEDebug.ToolBar    = False
			gvoIEDebug.Visible    = True
			gvoIEDebug.Document.body.style.fontFamily = "Courier New"
			gvoIEDebug.Document.body.style.whiteSpace = "pre-wrap"
			gvoIEDebug.Document.title = "Hardware.hta " & Hardware.Version & " Debugging"
		End If
		On Error Goto 0
	End If
End Sub


Sub CreateIEPrint( )
'	On Error Resume Next
	gvoIEPrint.Quit
	Set gvoIEPrint = Nothing
	On Error Goto 0
	Set gvoIEPrint = CreateObject( "InternetExplorer.Application" )
	While gvoIEPrint.Busy
		Sleep 1
	Wend
	' The following line, if run BEFORE navigating to about:blank, makes sure the IE window will open in the foreground.
	' Credits: Russell J. Wiley
	gvoWSHShell.AppActivate gvoIEPrint
	gvoIEPrint.Navigate "about:blank"
	gvoIEPrint.Visible = 0
End Sub


Sub DebugDetailsWindow( )
	Dim intHeight, intWidth, posHorizontal, posVertical, posX, strDebugText
	intHeight = window.screen.height
	intWidth  = window.screen.width
	posX      = InStr( LCase( gvaSettingsStr.Item( "SIZE" ) ), "x" )
	If posX > 0 Then
		intWidth  = Int( Left( gvaSettingsStr.Item( "SIZE" ), posX - 1 ) )
		intHeight = Int( Mid(  gvaSettingsStr.Item( "SIZE" ), posX + 1 ) )
		If Not IsNumeric( intHeight ) Then intHeight = window.screen.height
		If Not IsNumeric( intWidth )  Then intWidth  = window.screen.width
	End If
	intHeight = Min( Max( intHeight, gviMinHeight ), window.screen.height )
	intWidth  = Min( Max( intWidth,  gviMinWidth  ), window.screen.width  )
	posHorizontal = Max( 0, Int( ( window.screen.width  - intWidth  ) / 2 ) )
	posVertical   = Max( 0, Int( ( window.screen.height - intHeight ) / 2 ) )
	strDebugText  = Align( "Property", 10 ) & Align( "Actual",                   12 ) & "Requested"        & vbCrLf _
	              & Align( "========", 10 ) & Align( "======",                   12 ) & "========="        & vbCrLf _
	              & Align( "Left:",    10 ) & Align( screenLeft,                 12 ) & posHorizontal      & vbCrLf _
	              & Align( "Top:",     10 ) & Align( screenTop,                  12 ) & posVertical        & vbCrLf _
	              & Align( "Width:",   10 ) & Align( document.body.offsetWidth,  12 ) & intWidth           & vbCrLf _
	              & align( "Height:",  10 ) & Align( document.body.offsetHeight, 12 ) & intHeight          & vbCrLf _
	              & align( "Size:",    10 ) & Align( document.body.offsetWidth & "x" & document.body.offsetHeight, 12 ) & gvaSettingsStr.Item( "SIZE" )
	DebugMessage "Window Size", strDebugText
End Sub


Sub DebugMessage( myTitle, myMessage )
	Dim objDebugLog, strDebugText
	If gvaSettingsBool.Item( "DEBUG" ) Then
		On Error Resume Next
		If Not gvaSettingsBool.Item( "NOIE" ) Then
			If Not IsObject( gvoIEDebug ) Then
				Set gvoIEDebug = CreateObject( "InternetExplorer.Application" )
				If Err.Number = 70 Then
					gvaSettingsBool.Item( "NOIE" )  = True
					CheckboxDefaultBrowser.checked  = True
					CheckboxDefaultBrowser.disabled = True
					setTimeout "IEBugMessage", 100, "VBScript"
				Else
					While gvoIEDebug.Busy
						Sleep 1
					Wend
					' The following line, if run BEFORE navigating to about:blank, makes sure the IE window will open in the foreground.
					' Credits: Russell J. Wiley
					gvoWSHShell.AppActivate gvoIEDebug
					gvoIEDebug.Navigate "about:blank"
					gvoIEDebug.Height     = document.body.offsetHeight
					gvoIEDebug.Width      = document.body.offsetWidth
					gvoIEDebug.AddressBar = False
					gvoIEDebug.MenuBar    = False
					gvoIEDebug.StatusBar  = False
					gvoIEDebug.ToolBar    = False
					gvoIEDebug.Visible    = True
					gvoIEDebug.Document.body.style.fontFamily = "Courier New"
					gvoIEDebug.Document.body.style.whiteSpace = "pre-wrap"
					gvoIEDebug.Document.title = "Hardware.hta " & Hardware.Version & " Debugging"
				End If
			End If
		End If
		If myTitle = "" Then
			gvsDebugText = gvsDebugText & myMessage & vbCrLf
		Else
			gvsDebugText = gvsDebugText & myTitle & vbCrLf & String( Len( myTitle ), "=" ) & vbCrLf & myMessage & vbCrLf & vbCrLf
		End If
		If gvaSettingsBool.Item( "NOIE" ) Then
			If gvoFSO.FileExists( gvaSettingsStr.Item( "DEBUGLOG" ) ) Then
				Set objDebugLog = gvoFSO.OpenTextFile( gvaSettingsStr.Item( "DEBUGLOG" ) )
				strDebugText = objDebugLog.ReadAll( )
				objDebugLog.Close
				Set objDebugLog = Nothing
				'gvoFSO.DeleteFile gvaSettingsStr.Item( "DEBUGLOG" ), True
			End If
			Set objDebugLog = gvoFSO.OpenTextFile( gvaSettingsStr.Item( "DEBUGLOG" ), ForAppending, True )
			objDebugLog.WriteLine strDebugText & vbCrLf
			If Not Trim( myTitle ) = "" Then
				objDebugLog.WriteLine myTitle
				objDebugLog.WriteLine String( Len( myTitle ), "=" ) & vbCrLf
			End If
			objDebugLog.WriteLine myMessage & vbCrLf
			objDebugLog.Close
			Set objDebugLog = Nothing
			gvswshshell.Run gvaSettingsStr.Item( "DEBUGLOG" ), 7, False
		Else
			gvoIEDebug.Document.body.innerHTML = gvsDebugText
			If Err Then
				CreateIEDebug
				gvoIEDebug.Document.body.innerHTML = gvsDebugText
				Err.Clear
			End If
			' Scroll IE to end of document
			' http://stackoverflow.com/questions/5936668/vbscript-how-to-force-the-ie-scroll-bars-to-lock-to-the-bottom
			gvoIEDebug.Document.body.scrollTop = gvoIEDebug.Document.body.scrollTop + gvoIEDebug.Document.body.scrollHeight
		End If
		On Error Goto 0
	End If
End Sub


Sub DeleteDxDiagXML( )
	If InputDxDiag.value <> "" Then
		On Error Resume Next
		If gvoFSO.FileExists( InputDxDiag.value ) Then
			gvoFSO.DeleteFile InputDxDiag.value, True
		End If
		If Err Then
			MsgBox "Error while trying to delete the existing DxDiag XML file" & vbCrLf & """" & InputDxDiag.value & """", vbOKOnly + vbExclamation + vbApplicationModal, "File Delete Error"
			Err.Clear
		End If
		On Error Goto 0
	End If
	ButtonDeleteXML.disabled = True
End Sub


Sub DetailsBIOS( )
	On Error Resume Next
	gvsDetails = HandleClass( "Win32_BIOS", "root/CIMV2" )
	If gvaSettingsBool.Item( "DXDIAG" ) Then
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleXMLValue( "/DxDiag/SystemInformation/BIOS" )
	End If
	If gvaSettingsBool.Item( "DMIDECODE" ) Then
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleDMIDetails( "BIOS" )
	End If
	DetailsWindow "BIOS", gvsDetails
	On Error Goto 0
End Sub


Sub DetailsCDROM( )
	On Error Resume Next
	gvsDetails = HandleClass( "Win32_CDROMDrive",           "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_IDEController",        "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_SCSIController",       "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_IDEControllerDevice",  "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_SCSIControllerDevice", "root/CIMV2" )
	If gvaSettingsBool.Item( "DXDIAG" ) Then
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleXMLNode( "/DxDiag/LogicalDisks/LogicalDisk[HardDriveIndex = 0 and FileSystem <= """"]" )
	End If
	DetailsWindow "CD/DVD-ROM Drives and Controllers", gvsDetails
	On Error Goto 0
End Sub


Sub DetailsCPU( )
	On Error Resume Next
	gvsDetails = HandleClass( "Win32_Processor", "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_WinSAT",    "root/CIMV2" )
	If gvaSettingsBool.Item( "DXDIAG" ) Then
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleXMLValue( "/DxDiag/SystemInformation/Processor" )
	End If
	If gvaSettingsBool.Item( "DMIDECODE" ) Then
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleDMIDetails( "Processor" )
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleDMIDetails( "Cache" )
	End If
	DetailsWindow "CPU", gvsDetails
	On Error Goto 0
End Sub


Sub DetailsHDD( )
	On Error Resume Next
	gvsDetails = HandleClass( "Win32_DiskDrive",            "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_IDEController",        "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_SCSIController",       "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_IDEControllerDevice",  "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_SCSIControllerDevice", "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_WinSAT",               "root/CIMV2" )
	If gvaSettingsBool.Item( "DXDIAG" ) Then
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleXMLNode( "/DxDiag/LogicalDisks/LogicalDisk[Model > """" and FileSystem > """"]" )
	End If
	DetailsWindow "Disk Drives and Controllers", gvsDetails
	On Error Goto 0
End Sub


Sub DetailsHID( )
	On Error Resume Next
	gvsDetails = HandleClass( "Win32_Keyboard",             "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_PointingDevice",       "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "MSKeyboard_PortInformation", "root/WMI"   ) & vbCrLf & vbCrLf _
	           & HandleClass( "MSMouse_PortInformation",    "root/WMI"   )
	If gvaSettingsBool.Item( "DXDIAG" ) Then
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleXMLNode( "/DxDiag/DirectInput" )
	End If
	DetailsWindow "HID", gvsDetails
	On Error Goto 0
End Sub


Sub DetailsMainBoard( )
	On Error Resume Next
	gvsDetails = HandleClass( "Win32_BaseBoard",       "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_SystemEnclosure", "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_WinSAT",          "root/CIMV2" )
	If gvaSettingsBool.Item( "DMIDECODE" ) Then
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleDMIDetails( "Baseboard" )
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleDMIDetails( "System" )
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleDMIDetails( "Chassis" )
	End If
	DetailsWindow "Main Board and Chassis", gvsDetails
	On Error Goto 0
End Sub


Sub DetailsMemory( )
	On Error Resume Next
	gvsDetails = HandleClass( "Win32_PhysicalMemoryArray", "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_PhysicalMemory",      "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_WinSAT",              "root/CIMV2" )
	If gvaSettingsBool.Item( "DXDIAG" ) Then
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleXMLValue( "/DxDiag/SystemInformation/Memory" )
	End If
	If gvaSettingsBool.Item( "DMIDECODE" ) Then
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleDMIDetails( "Memory" )
	End If
	DetailsWindow "Memory", gvsDetails
	On Error Goto 0
End Sub


Sub DetailsMonitor( )
	On Error Resume Next
	gvsDetails = HandleClass( "Win32_DesktopMonitor",         "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "WmiMonitorBasicDisplayParams", "root/WMI"   ) & vbCrLf & vbCrLf _
	           & HandleClass( "WmiMonitorID",                 "root/WMI"   ) & vbCrLf & vbCrLf _
	           & "<h2>\\" & gvsComputer & "\root\default:StdRegProv</h2>"    & vbcrlf & vbcrlf _
	           & "<h3>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\DISPLAY</h3>"  & vbCrLf & vbCrLf _
	           & HandleRegEnum( HKEY_LOCAL_MACHINE, "SYSTEM\CurrentControlSet\Enum\DISPLAY" )
	DetailsWindow "Monitors", gvsDetails
	On Error Goto 0
End Sub


Sub DetailsNIC( )
	On Error Resume Next
	gvsDetails = HandleClass( "Win32_NetworkAdapter",      "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "MSNdis_LinkSpeed",          "root/WMI"   ) & vbCrLf & vbCrLf _
	           & HandleClass( "MSNdis_PhysicalMediumType", "root/WMI"   )
	DetailsWindow "Network Adapter", gvsDetails
	On Error Goto 0
End Sub


Sub DetailsPorts( )
	On Error Resume Next
	gvsDetails = HandleClass( "Win32_ParallelPort",            "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_SerialPort",              "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_SerialPortConfiguration", "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_USBController",           "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_SystemSlot",              "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_PortConnector",           "root/CIMV2" )
	If gvaSettingsBool.Item( "DXDIAG" ) Then
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleXMLNode( "/DxDiag/SystemDevices/SystemDevice" )
	End If
	If gvaSettingsBool.Item( "DMIDECODE" ) Then
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleDMIDetails( "Slot" )
	End If
	DetailsWindow "Ports and Slots", gvsDetails
	On Error Goto 0
End Sub


Sub DetailsSound( )
	On Error Resume Next
	gvsDetails = HandleClass( "Win32_SoundDevice", "root/CIMV2" )
	If gvaSettingsBool.Item( "DXDIAG" ) Then
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleXMLNode( "/DxDiag/DirectSound/SoundDevices/SoundDevice" )
	End If
	DetailsWindow "Sound Devices", gvsDetails
	On Error Goto 0
End Sub


Sub DetailsVideo( )
	On Error Resume Next
	gvsDetails = HandleClass( "Win32_VideoController",         "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "CIM_VideoControllerResolution", "root/CIMV2" ) & vbCrLf & vbCrLf _
	           & HandleClass( "Win32_WinSAT",                  "root/CIMV2" )
	If gvaSettingsBool.Item( "DXDIAG" ) Then
		gvsDetails = gvsDetails & vbCrLf & vbCrLf & HandleXMLNode( "/DxDiag/DisplayDevices/DisplayDevice" )
	End If
	DetailsWindow "Display Adapters", gvsDetails
	On Error Goto 0
End Sub


Sub DetailsWindow( strCategory, gvsDetails )
	Dim objDetailsFile, objDoc, objIE, strHTMLBody, strHTMLFoot, strHTMLHead

	strHTMLHead = "<html><head><title>" & strCategory & " details for " & gvsComputer & "</title></head><body>"
	strHTMLBody = "<h1 style=""text-align: center;"">" & strCategory & " details for " & gvsComputer & "</h1> <pre style=""font-family: courier,monospace"">" & gvsDetails & "</pre>"
	strHTMLFoot = "</body></html>"

	On Error Resume Next
	If Not gvaSettingsBool.Item( "NOIE" ) Then
		Set objIE = CreateObject( "InternetExplorer.Application" )
		If Err.Number = 70 Then
			' Access denied error on CreateObject, a bug sometimes
			' occurring in Windows after applying some Windows Updates
			gvaSettingsBool.Item( "NOIE" )  = True
			CheckboxDefaultBrowser.checked  = True
			CheckboxDefaultBrowser.disabled = True
			setTimeout "IEBugMessage", 100, "VBScript"
		End If
	End If
	If gvaSettingsBool.Item( "NOIE" ) Then
		' Create a temporary HTML file and open it in the default browser
		Set objDetailsFile = gvoFSO.CreateTextFile( gvsDetailsFile )
		objDetailsFile.Write( strHTMLHead )
		objDetailsFile.Write( strHTMLBody )
		objDetailsFile.Write( strHTMLFoot )
		objDetailsFile.Close
		Set objDetailsFile = Nothing
		gvoWSHShell.Run gvsDetailsFile, 7, False
	Else
		objIE.Visible = True
		' The following line, if run BEFORE navigating to about:blank, makes sure the IE window will open in the foreground.
		' Credits: Russell J. Wiley
		gvoWSHShell.AppActivate objIE
		objIE.Navigate "about:blank"
		objIE.Document.title = strCategory & " Details for " & gvsComputer & Replace( String( 100, "." ), "..", " ." )
		objIE.ToolBar        = 0
		objIE.StatusBar      = 0
		Set objDoc           = objIE.Document.body
		objDoc.InnerHTML     = strHTMLBody
	End If
	On Error Goto 0
End Sub


Sub EditSettings( )
	gvoWSHShell.Run "notepad.exe """ & gvsConfigFile & """", 1, True
	ConfigReadFile
	ConfigUpdateStatus
End Sub


Sub EnableWinSATScores( )
	Dim objItem
	' Hide WinSAT Score fields if not applicable
	For Each objItem In document.all
		If objItem.className = "Scores" Then
			If gvaSettingsBool.Item( "NOSCORES" ) Or gvbWinPE Then
				objItem.style.display    = "none"
				objItem.style.visibility = "collapse"
			Else
				objItem.style.display    = "table-cell"
				objItem.style.visibility = "visible"
			End If
		End If
	Next
End Sub


Function GetLocalComputerName( )
	If gvbWinPE Then
		GetLocalComputerName = GetLocalComputerNameWinPE( )
	Else
		GetLocalComputerName = UCase( gvoWSHShell.ExpandEnvironmentStrings( "%ComputerName%" ) )
	End If
End Function


Function GetLocalComputerNameWinPE( )
' Find computer name in WinPE
' Based on code by Richie Schuster
' http://www.sccmog.com/get-current-old-machine-name-winpe-vbscript/
' Caveat: In case of a multi-boot system with multiple computer names, the script
'         only returns the computer name of the last Windows installation it finds
	Dim colItems, objItem, objWMIService
	GetLocalComputerNameWinPE = "localhost"
'	On Error Resume Next
	' Find the Windows drive
	If gvsWinDrive = "" Then
		Set objWMIService = GetObject( "winmgmts://./root/CIMV2" )
		Set colItems      = objWMIService.ExecQuery ( "SELECT * FROM Win32_LogicalDisk" )
		For Each objItem in colItems
			If gvoFSO.FolderExists( gvoFSO.BuildPath( objItem.DeviceID, "Windows\System32" ) ) Then
				gvsWinDrive = objItem.DeviceID
			End If
		Next
	End If
	If gvsWinDrive <> "" Then
		' Mount registry hive from Windows drive
		gvoWSHShell.Run "CMD.EXE /C REG.EXE Load HKLM\TempHive " & gvsWinDrive & "\windows\system32\config\system", 0, True
		' Read computer name from mounted registry hive
		GetLocalComputerNameWinPE = UCase( gvoWSHShell.RegRead( "HKEY_LOCAL_MACHINE\TempHive\ControlSet001\Control\ComputerName\ComputerName\ComputerName" ) )
		' Unmount registry hive from Windows drive
		gvoWSHShell.Run "CMD.EXE /C REG.EXE Load HKLM\TempHive", 0, True
	End If
	Set colItems      = Nothing
	Set objWMIService = Nothing
	On Error Goto 0
End Function


Function GetOSVer( )
	Dim arrOS, colItems, objItem
	GetOSVer = 0
	Set colItems = gvoWMIService.ExecQuery( "SELECT Version FROM Win32_OperatingSystem" )
	If Not Err Then
		For Each objItem In colItems
			arrOS = Split( objItem.Version, "." )
			If UBound( arrOS ) > 1 Then
				GetOSVer = arrOS(0) & "." & arrOS(1)
			Else
				GetOSVer = arrOS(0)
			End If
		Next
	End If
	Set colItems = Nothing
End Function


Sub GetAllDiskInterfaces( )
	Dim i, j, lngSize
	Dim colItems, objItem
	Dim strInterface

	On Error Resume Next
	
	' Query HDD properties and save results in HDD array
	Set colItems = gvoWMIService.ExecQuery( "SELECT Caption,Index,PnpDeviceID,Size FROM Win32_DiskDrive" )
	If Not Err And Not IsNull( colItems ) And colItems.Count > 0 Then
		gviHDD = colItems.Count - 1
		' Adjust size of HDD array
		ReDim gvaHDD( 3, gviHDD )
		For Each objItem in colItems
			With objItem
				If IsNull( objItem.Size ) Then
					lngSize = 0
				Else
					lngSize = CInt( .Size / 1073741824 )
				End If
				strInterface = Split( .PnpDeviceID, "\" )(0)
				If Left( strInterface, 3 ) = "USB" Then strInterface = "USB"
				gvaHDD( 0, .Index ) = .Caption
				gvaHDD( 1, .Index ) = .PnpDeviceID
				gvaHDD( 2, .Index ) = lngSize
				gvaHDD( 3, .Index ) = strInterface
			End With
		Next
	End If
	
	' Count number of CDROM drives, query CDR properties and save results in CDR array
	Set colItems = gvoWMIService.ExecQuery( "SELECT Caption,Drive,PnpDeviceID FROM Win32_CDROMDrive" )
	If Not Err And Not IsNull( colItems ) And colItems.Count > 0 Then
		gviCDROM = colItems.Count - 1
		' Adjust size of CDR array
		ReDim gvaCDROM( 3, gviCDROM )
		i = 0
		For Each objItem in colItems
			With objItem
				strInterface = Split( .PnpDeviceID, "\" )(0)
				If Left( strInterface, 3 ) = "USB" Then strInterface = "USB"
				gvaCDROM( 0, i ) = .Caption
				gvaCDROM( 1, i ) = .PnpDeviceID
				gvaCDROM( 2, i ) = .Drive
				gvaCDROM( 3, i ) = strInterface
			End With
			i = i + 1
		Next
	End If
	
	' Query harddisk controller properties and save results in HDC array
	Set colItems = gvoWMIService.ExecQuery( "SELECT Caption,Description,PnpDeviceID FROM Win32_IDEController" )
	If Not Err And Not IsNull( colItems ) And colItems.Count > 0 Then
		gviHDC = colItems.Count - 1
		' Adjust size of HDC array
		ReDim gvaHDC( 2, gviHDC )
		i = 0
		For Each objItem in colItems
			With objItem
				gvaHDC( 0, i ) = UCase( .Caption & " (" & .Description & ")" )
				gvaHDC( 1, i ) = .PNPDeviceID
				' This is the "weakest link" in this script: distinguishing between IDE and SATA depends on
				' the words "SATA" or "S-ATA" or "Serial ATA" in the harddisk controller's description field
				If InStr( gvaHDC( 0, i ), "SATA" ) Then
					gvaHDC( 2, i ) = "SATA"
				ElseIf InStr( gvaHDC( 0, i ), "S-ATA" ) Then
					gvaHDC( 2, i ) = "SATA"
				ElseIf InStr( gvaHDC( 0, i ), "SERIAL ATA" ) Then
					gvaHDC( 2, i ) = "SATA"
				Else
					gvaHDC( 2, i ) = "IDE"
				End If
			End With
			i = i + 1
		Next
	End If

	Set colItems = gvoWMIService.ExecQuery( "SELECT Caption,Description,PnpDeviceID FROM Win32_SCSIController" )
	If Not Err And Not IsNull( colItems ) And colItems.Count > 0 Then
		If colItems.Count > 0 Then
			gviHDC = gviHDC + colItems.Count
			' Adjust size of HDC array
			ReDim Preserve gvaHDC( 2, gviHDC )
			For Each objItem in colItems
				With objItem
					gvaHDC( 0, i ) = UCase( .Caption & " (" & .Description & ")" )
					gvaHDC( 1, i ) = .PNPDeviceID
					gvaHDC( 2, i ) = "SCSI"
				End With
				i = i + 1
			Next
		End If
	End If

	' Query hosted drives and save results in Host array
	Set colItems = gvoWMIService.ExecQuery( "SELECT Antecedent,Dependent FROM Win32_IDEControllerDevice" )
	If Not Err And Not IsNull( colItems ) And colItems.Count > 0 Then
		gviHost = colItems.Count - 1
		' Adjust size of Host array
		ReDim gvaHost( 2, gviHost )
		i = 0
		For Each objItem in colItems
			With objItem
				gvaHost( 0, i ) = Replace( .Antecedent, "\\", "\", 3 )
				gvaHost( 1, i ) = Replace( .Dependent,  "\\", "\", 3 )
			End With
			i = i + 1
		Next
	End If

	Set colItems = gvoWMIService.ExecQuery( "SELECT Antecedent,Dependent FROM Win32_SCSIControllerDevice" )
	If Not Err And Not IsNull( colItems ) And colItems.Count > 0 Then
		gviHost = gviHost + colItems.Count
		' Adjust size of Host array
		ReDim Preserve gvaHost( 2, gviHost )
		For Each objItem in colItems
			With objItem
				gvaHost( 0, i ) = Replace( .Antecedent, "\\", "\", 3 )
				gvaHost( 1, i ) = Replace( .Dependent,  "\\", "\", 3 )
			End With
			i = i + 1
		Next
	End If
	
	' Check interface per hosted disk
	If gviHost > 0 Then
		For i = 0 To gviHost
			For j = 0 To gviHDC
				If InStr( gvaHost( 0, i ), gvaHDC( 1, j ) ) Then
					gvaHost( 2, i ) = gvaHDC( 2, j )
				End If
			Next
		Next
	End If
	
	' Match hosted disks array with HDD and CDR arrays
	If gviHDD > 0 Then
		For i = 0 To gviHDD
			For j = 0 To gviHost
				If InStr( gvaHost( 1, j ), gvaHDD( 1, i ) ) Then
					gvaHDD( 3, i ) = gvaHost( 2, j )
					' Interface is SATA instead of SCSI if PNPDeviceID starts with IDE
					If gvaHDD( 3, i ) = "SCSI" And Left( gvaHDD( 1, i ), 4 ) = "IDE\" Then
						gvaHDD( 3, i ) = "SATA"
					End If
				End If
			Next
		Next
	End If
	If gviCDROM > 0 Then
		For i = 0 To gviCDROM
			For j = 0 To gviHost
				If InStr( gvaHost( 1, j ), gvaCDROM( 1, i ) ) Then
					gvaCDROM( 3, i ) = gvaHost( 2, j )
					' Interface is SATA instead of SCSI if PNPDeviceID starts with IDE
					If gvaCDROM( 3, i ) = "SCSI" And Left( gvaCDROM( 1, i ), 4 ) = "IDE\" Then
						gvaCDROM( 3, i ) = "SATA"
					End If
				End If
			Next
		Next
	End If

	On Error Goto 0
End Sub


Function GetParameter( myString, myParameter )
	' Extract switch value from command line,
	' e.g. GetParameter( "/CM /SIZE:1024x768 /NOUPD", "SIZE" ) to extract "1024x768"
	Dim strItem, strParameter, strString
	' Default return value is an empty string
	strParameter = UCase( myParameter )
	myString     = Trim( myString )
	strString    = UCase( myString )
	If InStr( strString, "/" & strParameter & ":" ) Then
		' Step 1: extract switch and everything following it, e.g. "/SIZE:1024x768 /NOUPD"
		strItem = Mid( myString, InStr( strString, "/" & strParameter & ":" ) )
		' Check if there is anything following the switch and colon
		If Len( strItem ) > Len( "/" & strParameter & ":" ) Then
			' Step 2: remove the switch name and colon, e.g. in our example this leaves us with "1024x768 /NOUPD"
			strItem = Mid( strItem, Len( "/" & strParameter & ":" ) + 1 )
			' Check again if there is anything left to parse
			If Len( strItem ) > 1 Then
				' Check if the value starts with a doublequote
				If Left( strItem, 1 ) = """" Then
					' Remove the opening doublequote
					strItem = Mid( strItem, 2 )
					' Remove the closing doublequote and everything after it
					strItem = Left( strItem, InStr( strItem, """" ) - 1 )
				Else
					' If not in doublequotes, remove the first space and everything following it,
					' e.g. in our example this leaves us with "1024x768"
					If InStr( strItem, " " ) Then strItem = Left( strItem, InStr( strItem, " " ) - 1 )
				End If
				' Return the result
				GetParameter = Trim( strItem )
			End If
		End If
	End If
End Function


Function HandleClass( myClass, myNameSpace )
' This subroutine lists all properties and their values for a specified class.
' Created using an example from a Microsoft TechNet ScriptCenter article:
' http://www.microsoft.com/technet/scriptcenter/resources/guiguy/default.mspx
	Dim blnNumChain, colItems, intChar, intTest, objClass, objItem, objProperty, objWMIService2, strProperties

	On Error Resume Next

	strProperties = "<h2>\\" & gvsComputer & "\" & Replace( myNameSpace, "/", "\" ) & ":" & myClass & "</h2>" & vbCrLf & vbCrLf

	If LCase( myNameSpace ) = "root/cimv2" Then
		Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM " & myClass )
		Set objClass = gvoWMIService.Get( myClass )
		If Err Then
			HandleClass = strProperties & "<p>Error while trying to query \\" & gvsComputer & "\" & Replace( myNameSpace, "/", "\" ) & "\" & myClass & "</p>" & vbCrLf & vbCrLf
			Exit Function
		End If
	Else
		Set objWMIService2 = GetObject( "winmgmts://" & gvsComputer & "/" & myNameSpace )
		If Err Then
			HandleClass = strProperties & "<p>Error while trying to connect to \\" & gvsComputer & "\" & Replace( myNameSpace, "/", "\" ) & "</p>" & vbCrLf & vbCrLf
			Exit Function
		End If
		Set colItems = objWMIService2.ExecQuery( "SELECT * FROM " & myClass )
		Set objClass = objWMIService2.Get( myClass )
		If Err Then
			HandleClass = strProperties & "<p>Error while trying to query \\" & gvsComputer & "\" & Replace( myNameSpace, "/", "\" ) & "\" & myClass & "</p>" & vbCrLf & vbCrLf
			Exit Function
		End If
	End If

	Select Case colItems.Count
		Case 0
			strProperties = strProperties & "<p>No instances.</p>" & vbCrLf & vbCrLf
		Case 1
			strProperties = strProperties & "<p>1 instance:</p>" & vbCrLf & vbCrLf
		Case Else
			strProperties = strProperties & "<p>" & colItems.Count & " instances:</p>" & vbCrLf & vbCrLf
	End Select

	For Each objItem In colItems
		For Each objProperty In objClass.Properties_
			If objProperty.IsArray = True Then
				blnNumChain = True
				intTest     = 0
				For Each intChar In Eval( "objItem." & objProperty.Name )
					If IsNumeric( intChar ) Then
						intTest = intTest + intChar
					Else
						blnNumChain = False
						Exit For
					End If
				Next
				If blnNumChain And gvaSettingsBool.Item( "CHAIN" ) And ( intTest > 0 ) And ( InStr( objProperty.Name, "Characteristic" ) < 1 ) And ( InStr( objProperty.Name, "Capabilit" ) < 1 ) Then
					strProperties = strProperties & CreateLine( objProperty.Name & " (array)"  ) & Eval( "Join( objItem." & objProperty.Name & ", "","" )" ) & vbCrLf
					strProperties = strProperties & CreateLine( objProperty.Name & " (string)" ) & Eval( "Chain( objItem." & objProperty.Name & " )" ) & vbCrLf
				Else
					strProperties = strProperties & CreateLine( objProperty.Name ) & Eval( "Join( objItem." & objProperty.Name & ", "","" )" ) & vbCrLf
				End If
			Else
				If IsDate( Eval( "objItem." & objProperty.Name ) ) Then
					strProperties = strProperties & CreateLine( objProperty.Name ) & FormatDateTime( Eval( "objItem." & objProperty.Name ) ) & vbCrLf
				Else
					strProperties = strProperties & CreateLine( objProperty.Name ) & Eval( "objItem." & objProperty.Name ) & vbCrLf
				End If
			End If
		Next
		strProperties = strProperties & vbCrLf & vbCrLf
	Next

	Set objWMIService2 = Nothing

	On Error Goto 0
   
	HandleClass = strProperties
End Function


Function HandleDMIDetails( myType )
	Dim objCMD, strMsg, strOutput
	HandleDMIDetails = ""
	If gvbWinPE Then Exit Function
	On Error Resume Next
	Set objCMD = gvoWSHShell.Exec( "CMD.EXE /C """ & gvsDMIDecode & """ --type " & LCase( myType ) & " 2>&1" )
	strOutput = objCMD.StdOut.ReadAll
	objCMD.Terminate
	Set objCMD = Nothing
	On Error Goto 0
	HandleDMIDetails = "<h2>\\" & gvsComputer & " " & "DMI " & myType & " details</h2>" & vbCrLf & vbCrLf & "<pre>" & strOutput & "</pre>" & vbCrLf
End Function


Function HandleRegEnum( myHive, myRegPath )
	Dim arrSubkeys, arrValueNames, arrValueTypes
	Dim i, j, intMaxTypeLen, intMaxNameLen
	Dim objReg
	Dim strData, strHive, strResult
	Dim varData
	strResult     = ""
	intMaxTypeLen = 0
	intMaxNameLen = 0
	Select Case myHive
		Case HKEY_CLASSES_ROOT
			strHive = "HKEY_CLASSES_ROOT"
		Case HKEY_CURRENT_USER
			strHive = "HKEY_CURRENT_USER"
		Case HKEY_LOCAL_MACHINE
			strHive = "HKEY_LOCAL_MACHINE"
		Case HKEY_USERS
			strHive = "HKEY_USERS"
		Case HKEY_CURRENT_CONFIG
			strHive = "HKEY_CURRENT_CONFIG"
		Case Else
			strHive = myHive
	End Select
	On Error Resume Next
	Set objReg = GetObject( "winmgmts:{impersonationLevel=impersonate}!//" & gvsComputer & "/root/default:StdRegProv" )
	strResult = "[" & strHive & "\" & myRegPath & "]" & vbCrLf
	objReg.EnumValues myHive, myRegPath, arrValueNames, arrValueTypes
	If Err Then
		Err.Clear
	Else
		If IsArray( arrValueNames ) And IsArray( arrValueTypes ) Then
			For i = 0 To UBound( arrValueNames )
				If Len( arrValueNames(i) )                 > intMaxNameLen Then intMaxNameLen = Len( arrValueNames(i) )
				If Len( gvaRegDataType(arrValueTypes(i)) ) > intMaxTypeLen Then intMaxTypeLen = Len( gvaRegDataType(arrValueTypes(i)) )
			Next
			For i = 0 To UBound( arrValueNames )
				strData = ""
				Select Case arrValueTypes(i)
					Case REG_SZ:
						objReg.GetStringValue myHive, myRegPath, arrValueNames(i), strData
					Case REG_EXPAND_SZ:
						objReg.GetExpandedStringValue myHive, myRegPath, arrValueNames(i), strData
					Case REG_BINARY:
						objReg.GetBinaryValue myHive, myRegPath, arrValueNames(i), varData
						If Not Err And IsArray( varData ) Then
							For j = 0 To UBound( varData )
								strData = strData & ";" & varData(j)
							Next
							strData = Mid( strData, 2 )
						End If
					Case REG_DWORD, REG_DWORD_BIG_ENDIAN:
						objReg.GetDWORDValue myHive, myRegPath, arrValueNames(i), varData
						strData = "0x" & Right( String( 8, "0" ) & CStr( Hex( varData ) ), 8 )
					Case REG_MULTI_SZ:
						objReg.GetMultiStringValue myHive, myRegPath, arrValueNames(i), varData
						strData = Join( varData, ";" )
					Case REG_QWORD:
						objReg.GetQWORDValue myHive, myRegPath, arrValueNames(i), varData
						strData = "0x" & Right( String( 16, "0" ) & CStr( Hex( varData ) ), 16 )
				End Select
				strResult = strResult & Left( arrValueNames(i) & Space( intMaxNameLen + 1 ), intMaxNameLen + 1) & Left( "[" & gvaRegDataType(arrValueTypes(i)) & "]" & Space( intMaxTypeLen + 3 ), intMaxTypeLen + 3 ) & strData & vbCrLf
			Next
		End If
	End If
	strResult = strResult & vbCrLf
	objReg.EnumKey myHive, myRegPath, arrSubkeys
	If Not Err And IsArray( arrSubkeys ) Then
		For i = 0 To UBound( arrSubkeys )
			strResult = strResult & HandleRegEnum( myHive, myRegPath & "\" & arrSubkeys(i) )
		Next
	End If
	Set objReg = Nothing
	On Error Goto 0
	HandleRegEnum = strResult
End Function


Function HandleXMLNode( myQuery )
	Dim i, strDeviceType, strMsg, strQuery2
	Dim colNodes, colNodes2, objNode, objNode2, objNode3, objNode4, objNode5, objNode6, xmlDoc
	HandleXMLNode = ""
	If gvbWinPE Then Exit Function
	strDeviceType = Left( myQuery, InStrRev( myQuery, "/" ) - 1 )
	strDeviceType = Mid( strDeviceType, InStrRev( strDeviceType, "/" ) + 1 )
	strMsg        = "<h2>\\" & gvsComputer & " " & "DxDiag " & strDeviceType & " data</h2>" & vbCrLf & vbCrLf
	On Error Resume Next
	Set xmlDoc = CreateObject( "Microsoft.XMLDOM" )
	xmlDoc.Async = "False"
	xmlDoc.Load gvaSettingsStr.Item( "XML" )
	Set colNodes = xmlDoc.selectNodes( myQuery )
	Select Case colNodes.length
		Case 0
			strMsg = strMsg & "<p>No instances.</p>"
		Case 1
			strMsg = strMsg & "<p>1 instance:</p>"
		Case Else
			strMsg = strMsg & "<p>" & colNodes.length & " instances:</p>"
	End Select
	strMsg = strMsg & vbCrLf & vbCrLf & "<pre>"
	For i = 0 To colNodes.length - 1
		strQuery2 = myQuery & "[" & i & "]/*"
		Set colNodes2 = xmlDoc.selectNodes( strQuery2 )
		For Each objNode2 in colNodes2
			If objNode2.childNodes.length = 1 Then
				strMsg = strMsg & objNode2.nodeName & " = " & objNode2.text & vbCrLf
			Else
				strMsg = strMsg & objNode2.nodeName & ":" & vbCrLf
				For Each objNode3 In objNode2.childNodes
					If objNode3.childNodes.length = 1 Then
						strMsg = strMsg & "  " & objNode3.nodeName & " = " & objNode3.text & vbCrLf
					Else
						strMsg = strMsg & objNode3.nodeName & ":" & vbCrLf
						For Each objNode4 In objNode3.childNodes
							If objNode4.childNodes.length = 1 Then
								strMsg = strMsg & "  " & objNode4.nodeName & " = " & objNode4.text & vbCrLf
							Else
								strMsg = strMsg & objNode4.nodeName & ":" & vbCrLf
								For Each objNode5 In objNode4.childNodes
									If objNode5.childNodes.length = 1 Then
										strMsg = strMsg & "  " & objNode5.nodeName & " = " & objNode5.text & vbCrLf
									Else
										strMsg = strMsg & objNode5.nodeName & ":" & vbCrLf
										For Each objNode6 In objNode5.childNodes
											strMsg = strMsg & "  " & objNode6.nodeName & " = " & objNode6.text & vbCrLf
										Next
									End If
								Next
							End If
						Next
					End If
				Next
			End If
		Next
		strMsg = strMsg & vbCrLf & vbCrLf
	Next
	strMsg = strMsg & "</pre>" & vbCrLf
	Set colNodes2 = Nothing
	Set colNodes  = Nothing
	Set xmlDoc    = Nothing
	On Error Goto 0
	HandleXMLNode = strMsg
End Function


Function HandleXMLValue( myQuery )
	Dim i, strDeviceType, strMsg, strQuery2
	Dim colNodes, colNodes2, objNode, objNode2, objNode3, xmlDoc
	HandleXMLValue = ""
	If gvbWinPE Then Exit Function
	strDeviceType  = Left( myQuery, InStrRev( myQuery, "/" ) - 1 )
	strDeviceType  = Mid( strDeviceType, InStrRev( strDeviceType, "/" ) + 1 )
	strMsg         = "<h2>\\" & gvsComputer & " " & "DxDiag " & strDeviceType & " data</h2>" & vbCrLf & vbCrLf
	On Error Resume Next
	Set xmlDoc = CreateObject( "Microsoft.XMLDOM" )
	xmlDoc.Async = "False"
	xmlDoc.Load gvaSettingsStr.Item( "XML" )
	Set colNodes = xmlDoc.selectNodes( myQuery )
	Select Case colNodes.length
		Case 0
			strMsg = strMsg & "<p>No instances.</p>"
		Case 1
			strMsg = strMsg & "<p>1 instance:</p>"
		Case Else
			strMsg = strMsg & "<p>" & colNodes.length & " instances:</p>"
	End Select
	strMsg = strMsg & vbCrLf & vbCrLf & "<pre>"
	For i = 0 To colNodes.length - 1
		strQuery2 = myQuery & "[" & i & "]"
		Set colNodes2 = xmlDoc.selectNodes( strQuery2 )
		For Each objNode2 in colNodes2
			strMsg = strMsg & objNode2.nodeName & " #" & i & " : " & objNode2.text & vbCrLf
		Next
		strMsg = strMsg & vbCrLf & vbCrLf
	Next
	strMsg = strMsg & "</pre>" & vbCrLf
	Set colNodes2 = Nothing
	Set colNodes  = Nothing
	Set xmlDoc    = Nothing
	On Error Goto 0
	HandleXMLValue = strMsg
End Function


Function IE7( )
	' Returns True if IE version is 7 or less
	Dim intTest, objReg, strIEVer, strWMIQuery
	Const HKLM = &H80000002
	IE7 = False
	On Error Resume Next
	gvsComputer = Trim( UCase( ComputerName.value ) )
	If gvsComputer = "" Or gvsComputer = "." Then
		gvsComputer        = GetLocalComputerName( )
		ComputerName.value = gvsComputer
	End If
	' Read the IE version from the registry
	strWMIQuery = "winmgmts:{impersonationLevel=impersonate}!//./root/default:StdRegProv"
	Set objReg = GetObject( strWMIQuery )
	objReg.GetStringValue HKLM, "SOFTWARE\Microsoft\Internet Explorer", "Version", strIEVer
	Set objReg = Nothing
	If InStr( strIEVer, "." ) Then strIEVer = Left( strIEVer, InStr( strIEVer, "." ) - 1 )
	If CLng( strIEVer ) < 8 Then IE7 = True
	On Error Goto 0
End Function


Sub IEBugMessage( )
	Dim strMsg, strTitle
	strMsg = "Hardware.hta encountered an error 70 (access denied) while trying to initialize Internet Explorer automation." _
	       & vbCrLf & vbCrLf _
	       & "This problem MAY be caused by a recent Windows Update." _
	       & vbCrLf & vbCrLf _
	       & "This HTA will continue trying to use temporary HTML files and open them in your default browser instead." 
	If gvaSettingsBool.Item( "DEBUG" ) Then
		strMsg = strMsg & vbCrLf & vbCrLf & "Unfortunately, ""Live"" debugging will not be possible, but you can still examine the debug log file after closing this HTA."
	End If
	strTitle = "Internet Explorer Automation Error"
	MsgBox strMsg, vbOKOnly + vbSystemModal, strTitle
End Sub


Sub Initialize( )
	Dim i, j, k, objRE
	' Global File System and Shell objects
	Set gvoFSO      = CreateObject( "Scripting.FileSystemObject" )
	Set gvoWSHShell = CreateObject( "WScript.Shell" )
	' Read PATH
	gvsPATH = Trim( gvoWSHShell.ExpandEnvironmentStrings( "%PATH%" ) )
	' Remove empty PATH entries
	Set objRE = New RegExp
	objRE.Pattern = ";\s+"
	gvsPATH = Trim( objRE.Replace( gvsPATH, ";" ) )
	objRE.Pattern = ";{2,}"
	gvsPATH = Trim( objRE.Replace( gvsPATH, ";" ) )
	objRE.Pattern = "(^;|;$)"
	gvsPATH = Trim( objRE.Replace( gvsPATH, "" ) )
	Set objRE = Nothing
	' Split PATH into array of entries
	gvaPATH = Split( gvsPATH, ";" )
	k = UBound( gvaPATH )
	' Trim PATH entries
	For i = UBound( gvaPATH ) To 0 Step -1
		gvaPATH(i) = Trim( gvaPATH(i) )
		' Remove empty PATH entries
		If gvaPATH(i) = "" Then
			For j = i To k - 1
				gvaPATH(j) = gvaPATH(j+1)
			Next
			k = k - 1
		End If
	Next
	' Resize PATH array to account for removed entries
	If k < UBound( gvaPATH ) Then
		ReDim Preserve gvaPATH(k)
	End If
	' Check if in WinPE
	gvbWinPE = CheckWinPE( )
	' Defaults for IE version dependent settings
	gvbIE7           = False
	gvsTableRowStyle = "table-row"
	' Reset counters
	gvcBanks     = 0
	gvcCDROM     = 0
	gvcCPU       = 0
	gvcHDD       = 0
	gvcMemory    = 0
	gvcMonitor   = 0
	gvcNIC       = 0
	gvcVideo     = 0
	gviMemSize   = 0
	gviMemSpeed  = 0
	gviNumOS     = 0
	gviMinHeight = Min( 600, window.screen.height )
	gviMinWidth  = Min( 800, window.screen.width  )
	' Color changes on WMI connection errors
	clrBgErr  = "Red"
	clrTxtErr = "White"
	' This HTA's command line
	gvsCommandline   = Hardware.CommandLine
	gvsCommandlineUC = UCase( gvsCommandline )
	' Paths of helper files
	gvsConfigFile    = Left( Self.location.pathname, Len( Self.location.pathname ) - 4 ) & ".cfg"
	gvsDetailsFile   = gvoFSO.GetAbsolutePathName( gvoWSHShell.ExpandEnvironmentStrings( "%Temp%.\~hardware~details.html" ) )
	gvsPrintFile     = gvoFSO.GetAbsolutePathName( gvoWSHShell.ExpandEnvironmentStrings( "%Temp%.\~hardware~print~preview.html" ) )
	gvsDebugText     = ""
	' Create a list of all interface colors available, and fill the theme settings dropdowns with them
	ListCSSColors
	ListColors "GradientTopColor",    "blue"
	ListColors "GradientBottomColor", "black"
	ListColors "CaptionsColor",       "white"
	ListColors "LinksColor",          "red"
	ListColors "ButtonFaceColor",     "silver"
	ListColors "ButtonCaptionsColor", "blacl"
	ListColors "CodeColor",           "yellow"
	' Dictionary objects for global settings
	Set gvaDefaultsBool = CreateObject( "Scripting.Dictionary" )
	Set gvaDefaultsStr  = CreateObject( "Scripting.Dictionary" )
	Set gvaSettingsBool = CreateObject( "Scripting.Dictionary" )
	Set gvaSettingsStr  = CreateObject( "Scripting.Dictionary" )
	' Read and set defaults
	ConfigReadDefaults
End Sub


Sub Inventory( )
	Dim blnSuccess, colItems, i, objItem, strLogFile

	If ComputerName.value <> UCase( gvsComputer ) Then
		If gvsComputer <> "" Then
			If IsObject( gvaSettingsBool ) Then
				If gvaSettingsBool.Count > 0 Then
					'If gvaSettingsBool.Item( "LOG" ) Then
						SaveDebugLog
						strLogFile   = gvoFSO.BuildPath( gvoFSO.GetParentFolderName( gvaSettingsStr.Item( "DEBUGLOG" ) ), gvoFSO.GetBaseName( gvaSettingsStr.Item( "DEBUGLOG" ) ) ) & "_" & ComputerName.value & "_debug_" & TimeStamp( ) & ".log"
						gvsDebugText = "[" & Now & "] " & UCase( Trim( ComputerName.value ) ) & vbCrLf & vbCrLf
					'End If
				End If
			End If
		End If
	End If
	
	IsLocalComputer

	'ComputerName.value = gvsComputer
	gvsComputer = UCase( Trim( ComputerName.value ) )

    If ButtonRun.value = "Reset" Then
    	Reset
    Else
	    ButtonRun.value            = "Reset"
	    ButtonRun.accessKey        = "r"
	    ButtonRun.title            = "Click here to clear all fields"
	    ButtonRun.disabled         = True
		CheckboxBIOS.disabled      = True
		CheckboxCDROM.disabled     = True
		CheckboxCPU.disabled       = True
		CheckboxHDD.disabled       = True
		CheckboxHID.disabled       = True
		CheckboxMainBoard.disabled = True
		CheckboxMemory.disabled    = True
		CheckboxMonitor.disabled   = True
		CheckboxNIC.disabled       = True
		CheckboxPorts.disabled     = True
		CheckboxSound.disabled     = True
		CheckboxVideo.disabled     = True
		ButtonBasic.disabled       = True
		ButtonPaste.disabled       = True
		ButtonPrint.disabled       = True
		ComputerName.disabled      = True
	
		If Not CheckboxBIOS.Checked Then
			BIOSHeader.style.display = "none"
			BIOSRow.style.display    = "none"
			BIOSFooter.style.display = "none"
		End If
		If Not CheckboxCDROM.Checked Then
			CDROMHeader.style.display = "none"
			CDROM0.style.display      = "none"
			CDROM1.style.display      = "none"
			CDROM2.style.display      = "none"
			CDROM3.style.display      = "none"
			CDROMFooter.style.display = "none"
		End If
		If Not CheckboxCPU.Checked Then
			CPUHeader.style.display = "none"
			CPURow.style.display    = "none"
			CPUFooter.style.display = "none"
		End If
		If Not CheckboxHDD.Checked Then
			HardDiskHeader.style.display = "none"
			HardDisk0.style.display      = "none"
			HardDisk1.style.display      = "none"
			HardDisk2.style.display      = "none"
			HardDisk3.style.display      = "none"
			HardDisk4.style.display      = "none"
			HardDisk5.style.display      = "none"
			HardDisk6.style.display      = "none"
			HardDisk7.style.display      = "none"
			HardDiskFooter.style.display = "none"
		End If
		If Not CheckboxHID.Checked Then
			HIDHeader.style.display = "none"
			HIDRow.style.display    = "none"
			HIDFooter.style.display = "none"
		End If
		If Not CheckboxMainBoard.Checked Then
			MainBoardHeader.style.display = "none"
			MainBoardRow.style.display    = "none"
			MainBoardFooter.style.display = "none"
		End If
		If Not CheckboxMemory.Checked Then
			MemHeader.style.display = "none"
			MemRow.style.display    = "none"
			MemFooter.style.display = "none"
		End If
		If Not CheckboxMonitor.Checked Then
			MonitorHeader.style.display = "none"
			Monitor0.style.display      = "none"
			Monitor1.style.display      = "none"
			Monitor2.style.display      = "none"
			Monitor3.style.display      = "none"
			MonitorFooter.style.display = "none"
		End If
		If Not CheckboxNIC.Checked Then
			NICHeader.style.display = "none"
			NIC0.style.display      = "none"
			NIC1.style.display      = "none"
			NIC2.style.display      = "none"
			NIC3.style.display      = "none"
			NICFooter.style.display = "none"
		End If
		If Not CheckboxPorts.Checked Then
			PortsHeader.style.display = "none"
			PortsRow.style.display    = "none"
			PortsFooter.style.display = "none"
		End If
		If Not CheckboxSound.Checked Then
			SoundHeader.style.display = "none"
			SoundRow.style.display    = "none"
			SoundFooter.style.display = "none"
		End If
		If Not CheckboxVideo.Checked Then
			VideoHeader.style.display = "none"
			Video0.style.display      = "none"
			Video1.style.display      = "none"
			Video2.style.display      = "none"
			Video3.style.display      = "none"
			VideoFooter.style.display = "none"
		End If
	
		On Error Resume Next
	
		If gvbWinPE Then
			gvsComputer        = UCase( InputBox( "Please enter the computer name", "Computer Name", gvsComputer ) )
			ComputerName.value = gvsComputer
		Else
			gvsComputer = ComputerName.value
			If gvsComputer = "" Or gvsComputer = "." Then
				gvsComputer        = GetLocalComputerName( )
				ComputerName.value = gvsComputer
			End If
			Sleep 1
			Set gvoWMIService = GetObject( "winmgmts://./root/CIMV2" )
			Set colItems = gvoWMIService.ExecQuery( "SELECT StatusCode FROM Win32_PingStatus WHERE Address='" & gvsComputer & "'" )
			For Each objItem In colItems
				If IsNull( objItem.StatusCode ) Or objItem.StatusCode <> 0 Then
					MsgBox "Error while trying to ping computer " & gvsComputer & vbCrLf & vbCrLf & Err.Description, vbOKOnly, "Connection Error"
					Location.Reload( True )
					Exit Sub
				End If
			Next
		End If
	
		If gvbWinPE Then
			Set gvoWMIService = GetObject( "winmgmts://./root/CIMV2" )
		Else
			Set gvoWMIService = GetObject( "winmgmts://" & gvsComputer & "/root/CIMV2" )
		End If
		If Err Then
			MsgBox "Error while trying to connect to computer " & gvsComputer & vbCrLf & vbCrLf & Err.Description, vbOKOnly, "WMI Error"
			Location.Reload( True )
			Exit Sub
		Else
			ComputerName.style.backgroundColor = "White"
			ComputerName.style.color           = "Black"
			ComputerName.disabled              = True
		End If
	
		gviNumOS = GetOSVer( )
		
		' Diable WinSAT for Windows XP and older
		If CInt( Left( CStr( gviNumOS ), 1 ) ) < 6 Then gvaDefaultsBool.Item( "NOSCORES"  ) = True
		EnableWinSATScores
	
		On Error Goto 0
	
		gvsHeader = "Computer:" & vbTab & "WinPE"
		gvsCSVTxt = gvsComputer & vbTab & CStr( gvbWinPE )
		
	
		InventoryCPU
		InventoryMemory
		GetAllDiskInterfaces
		InventoryHDD
		InventoryCDROM
		InventoryVideo
		InventoryMonitor
		InventorySound
		InventoryNIC
		InventoryMainBoard
		InventoryHID
		InventoryPorts
		InventoryBIOS
		InventoryWinSATScores
	
		If CheckboxVideo.Checked Then
			If gvaSettingsBool.Item( "DXDIAG" ) Then
				blnSuccess = InventoryDirectX( )
				If Not blnSuccess Then MsgBox "There was an error reading the DirectX data:" & vbCrLf & "Unable to load """ & gvaSettingsStr.Item( "XML" ) & """", vbOKOnly, "XML error"
			End If
			Add2CsvVideo
		End If
	
		If gvaSettingsBool.Item( "DEVTEST" ) Then
			ComputerName.value = "MYPC"
			InputDxDiag.value  = "C:\Scripts\Hardware.xml"
		Else
			ComputerName.value = gvsComputer
		End If
	
		' Write the inventory data to the hidden area named "PrintScreen".
		' This allows printing with Ctrl+P instead of the Print button, which opens an entirely new Internet Explorer window.
		' In Windows 7/IE11, printing with Ctrl+P is faster, but print results look better when using the "Print" button.
		PrintScreen.innerHTML = PrintTable( )

		Set colItems = document.getElementsByTagName( "input" )
		For Each objItem In colItems
			If objItem.type = "text" Then
				objItem.title = objItem.value
			End If
		Next
		Set colItems = Nothing

		ButtonCopy.disabled  = False
		ButtonPrint.disabled = False
		ButtonSave.disabled  = False
		ButtonRun.disabled   = False
		ButtonSave.Focus( )
	End If
End Sub


Sub InventoryBIOS( )
	Dim colItems, objItem, objMatches, objRE
	Dim strBIOSDate, strBIOSSerial, strBIOSVersion

	On Error Resume Next

	If CheckBoxBIOS.Checked Then
		Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_BIOS WHERE PrimaryBIOS = True" )
		If Not Err Then
			For Each objItem In colItems
				strBIOSVersion = objItem.SMBIOSBIOSVersion
				strBIOSDate    = Mid( objItem.ReleaseDate, 5, 2 ) & "/" & Mid( objItem.ReleaseDate, 7, 2 ) & "/" & Left( objItem.ReleaseDate, 4 )
				strBIOSSerial  = objItem.SerialNumber
				If gvaSettingsBool.Item( "DEVTEST" ) Then
					strBIOSVersion = "0.00"
					strBIOSDate    = "01/01/1980"
					strBIOSSerial  = "0123456789"
				End If
				If InStr( strBIOSVersion, ":" ) Then ' Convert 01:23:00 to 1.23.00
					Set objRE = New RegExp
					objRE.Pattern = "^\d+(:\d+)+$"
					If objRE.Test( strBIOSVersion ) Then
						strBIOSVersion = Replace( strBIOSVersion, ":", "." )
						If Len( strBIOSVersion ) > 3 Then
							If Left( strBIOSVersion, 1 ) = "0" And Not Left( strBIOSVersion, 2 ) = "0." Then
								strBIOSVersion = Mid( strBIOSVersion, 2 )
							End If
						End If
					End If
				End If
				BIOSManufacturer.value = objItem.Manufacturer
				BIOSModel.value        = objItem.Name
				BIOSVersion.value      = strBIOSVersion
				BIOSDate.value         = strBIOSDate
			Next
		End If

		ButtonDetailsBIOS.disabled = False

		Add2CsvBIOS
	End If

	On Error Goto 0
End Sub


Sub InventoryCDROM( )
	Dim arrDeviceID, arrHardwareID, arrFirmware, arrIndex( )
	Dim colItems, objItem
	Dim i, intIndex
	Dim strDeviceID, strElement, strFirmware, strInterface

	If CheckboxCDROM.Checked Then
		On Error Resume Next
		' Find all CDROM drives without the word "virtual" in their name
		Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_CDROMDrive WHERE NOT Name LIKE '%Virtual%'" )
		If Err Or IsNull( colItems ) Or colItems.Count = 0 Then
			On Error Goto 0
			If gvbWinPE And gvsWinDrive <> "" Then InventoryCDROMWinPE
		Else
			' First prepare the drives to be sorted by drive letter
			i = 0
			For Each objItem In colItems
				ReDim Preserve arrIndex(i)
				arrIndex(i) = objItem.Drive
				i = i + 1
			Next
			ArraySort arrIndex
			' Now iterate through the drives collection
			For Each objItem In colItems
				' Parse the PNP Device ID string to get the interface and firmware revision
				' Example:
				' IDE\CDROM_NEC_DVD_RW_ND-3520AW___________________3.05____\5&2E27B08F&0&0.0.0
				' ===  <-  interface                               ====  <-  firmware revision
				' The array arrDeviceID will contain 3 elements: "IDE",
				' "CDROM_NEC_DVD_RW_ND-3520AW___________________3.05____" and "5&2E27B08F&0&0.0.0"
				If InStr( objItem.DeviceID, "\" ) Then
					arrDeviceID  = Split( Replace( objItem.DeviceID, "&amp;", "&" ), "\", 3, vbTextCompare )
					strInterface = arrDeviceID(0)
					strDeviceID  = arrDeviceID(1)
					' In our example, strDeviceID will contain "CDROM_NEC_DVD_RW_ND-3520AW___________________3.05____"
					' The array arrFirmware will contain the elements "CDROM", "NEC", "DVD", "RW", "ND-3520AW", "3.05" and ""
					' strFirmware is assigned the value of the last non-empty element in the array
					If InStr( strDeviceID, "_" ) Then
						arrFirmware  = Split( strDeviceID, "_", -1, vbTextCompare )
						If Left( strInterface, 3 ) = "USB" Then strInterface = "USB"
						For Each strElement In arrFirmware
							If CStr( strElement ) <> "" Then strFirmware = strElement
						Next
					End If
				End If
				' Check where to put this drive to show them sorted by drive letter
				For i = 0 To UBound( arrIndex )
					If objItem.Drive = arrIndex(i) Then
						If i > 0 Then
							MultipleCDROMs.style.display = "inline"
							CDROM1.style.display  = gvsTableRowStyle
						End If
						document.getElementById( "CDROM" & i & "Index"     ).value = objItem.Drive
						document.getElementById( "CDROM" & i & "Model"     ).value = objItem.Name
						document.getElementById( "CDROM" & i & "Firmware"  ).value = strFirmware
						document.getElementById( "CDROM" & i & "Interface" ).value = gvaCDROM( 3, i )
					End If
					gvcCDROM = gvcCDROM + 1
				Next
				ButtonDetailsCDROM.disabled = False
			Next

			' An asterisk after the 4th drive index indicates there are more than 4 CDROM drives
			If gvcCDROM > 4 Then
				CDROM3Index.value = CDROM3Index.value & "*"
			End If
	
			On Error Goto 0
	
			Add2CsvCDROM
		End If
	End If
End Sub


Sub InventoryCDROMWinPE( )
	Dim arrHardwareID, arrRegKeys, arrSubKeys, arrTest
	Dim dicDescriptions, dicFirmware, dicHardwareIDs, dicInterfaces
	Dim colItems, objItem, objRE, objReg
	Dim i, intIndex, j
	Dim strDescription, strDictKey, strRegKey, strRegSubKey, strWMIQuery

	Set dicDescriptions = CreateObject( "Scripting.Dictionary" )
	Set dicFirmware     = CreateObject( "Scripting.Dictionary" )
	Set dicHardwareIDs  = CreateObject( "Scripting.Dictionary" )
	Set dicInterfaces   = CreateObject( "Scripting.Dictionary" )
	Set objRE           = New RegExp

	' Mount registry hive from Windows Drive
	gvoWSHShell.Run "CMD.EXE /C REG.EXE Load HKLM\TempHive " & gvsWinDrive & "\windows\system32\config\system", 0, True

	' Scan the temporary registry hive for IDE CDROM devices
	strWMIQuery = "winmgmts:{impersonationLevel=impersonate}!//./root/default:StdRegProv"
	Set objReg = GetObject( strWMIQuery )
	objReg.EnumKey HKEY_LOCAL_MACHINE, "TempHive\ControlSet001\Enum\IDE", arrRegKeys
	If Not IsNull( arrRegKeys ) Then
		For i = 0 To UBound( arrRegKeys )
			strRegKey = arrRegKeys(i)
			If Left( UCase( strRegKey ), 5 ) = "CDROM" Then
				objReg.EnumKey HKEY_LOCAL_MACHINE, "TempHive\ControlSet001\Enum\IDE\" & strRegKey, arrSubKeys
				For Each strRegSubKey In arrSubKeys
					objReg.GetMultiStringValue HKEY_LOCAL_MACHINE, "TempHive\ControlSet001\Enum\IDE\" & strRegKey & "\" & strRegSubKey, "HardwareID", arrHardwareID
					If Not IsNull( arrHardwareID ) Then
						If InStr( UCase( arrHardwareID(0) ), "VIRTUAL" ) = 0 Then
							If Left( UCase( arrHardwareID(0) ), 4 ) = "IDE\"  Then arrHardwareID(0) = Mid( arrHardwareID(0), 5 )
							If Left( UCase( arrHardwareID(0) ), 5 ) = "CDROM" Then arrHardwareID(0) = Mid( arrHardwareID(0), 6 )
							objReg.GetStringValue HKEY_LOCAL_MACHINE, "TempHive\ControlSet001\Enum\IDE\" & strRegKey & "\" & strRegSubKey, "FriendlyName", strDescription
							strDictKey = objRE.Replace( arrHardwareID(0), "" )
							dicHardwareIDs.Item( strDictKey )  = arrHardwareID(0)
							dicDescriptions.Item( strDictKey ) = strDescription
							dicInterfaces.Item( strDictKey )   = "IDE"
							arrTest = Split( arrHardwareID(0), "_" )
							For j = 0 To UBound( arrTest )
								If Not arrTest(i) = "" Then
									dicFirmware.Item( strDictKey ) = arrTest(j)
								End If
							Next
						End If
						arrHardwareID = Null
					End If
				Next
				arrSubKeys = Null
			End If
		Next
		arrRegKeys = Null
	End If

	' Scan the temporary registry hive for SCSI CDROM devices
	objReg.EnumKey HKEY_LOCAL_MACHINE, "TempHive\ControlSet001\Enum\SCSI", arrRegKeys
	If Not IsNull( arrRegKeys ) Then
		For Each strRegKey In arrRegKeys
			If Left( UCase( strRegKey ), 5 ) = "CDROM" Then
				objReg.EnumKey HKEY_LOCAL_MACHINE, "TempHive\ControlSet001\Enum\SCSI\" & strRegKey, arrSubKeys
				For Each strRegSubKey In arrSubKeys
					objReg.GetMultiStringValue HKEY_LOCAL_MACHINE, "TempHive\ControlSet001\Enum\SCSI\" & strRegKey & "\" & strRegSubKey, "HardwareID", arrHardwareID
					If Not IsNull( arrHardwareID ) Then
						If InStr( UCase( arrHardwareID(0) ), "VIRTUAL" ) = 0 Then
							If Left( UCase( arrHardwareID(0) ), 5 ) = "SCSI\" Then arrHardwareID(0) = Mid( arrHardwareID(0), 6 )
							If Left( UCase( arrHardwareID(0) ), 5 ) = "CDROM" Then arrHardwareID(0) = Mid( arrHardwareID(0), 6 )
							objReg.GetStringValue HKEY_LOCAL_MACHINE, "TempHive\ControlSet001\Enum\SCSI\" & strRegKey & "\" & strRegSubKey, "FriendlyName", strDescription
							strDictKey = objRE.Replace( arrHardwareID(0), "" )
							dicHardwareIDs.Item( strDictKey )  = arrHardwareID(0)
							dicDescriptions.Item( strDictKey ) = strDescription
							dicInterfaces.Item( strDictKey )   = "SCSI"
							arrTest = Split( arrHardwareID(0), "_" )
							For i = 0 To UBound( arrTest )
								If Not arrTest(i) = "" Then
									dicFirmware.Item( strDictKey ) = arrTest(i)
								End If
							Next
						End If
						arrHardwareID = Null
					End If
				Next
				arrSubKeys = Null
			End If
		Next
		arrRegKeys = Null
	End If

	' Show the results
	If dicHardwareIDs.Count > 0 Then
		For i = 0 To dicHardwareIDs.Count - 1
			If i > 0 Then
				MultipleCDROMs.style.display = "inline"
				CDROM1.style.display  = gvsTableRowStyle
			End If
			document.getElementById( "CDROM" & i & "Index"     ).value = objItem.Drive
			document.getElementById( "CDROM" & i & "Model"     ).value = objItem.Name
			document.getElementById( "CDROM" & i & "Firmware"  ).value = strFirmware
			document.getElementById( "CDROM" & i & "Interface" ).value = gvaCDROM( 3, i )
			gvcCDROM = gvcCDROM + 1
			ButtonDetailsCDROM.disabled = False
		Next
	End If

	' Unmount temporary registry hive
	gvoWSHShell.Run "CMD.EXE /C REG.EXE Unload HKLM\TempHive", 0, True
	Set dicDescriptions = Nothing
	Set dicFirmware     = Nothing
	Set dicHardwareIDs  = Nothing
	Set dicInterfaces   = Nothing
	Set objRE           = Nothing

	' An asterisk after the 4th drive index indicates there are more than 4 CDROM drives
	If gvcCDROM > 4 Then CDROM3Index.value = CDROM3Index.value & "*"

	Add2CsvCDROM
End Sub


Sub InventoryCPU( )
	Dim colItems, objItem

	If CheckBoxCPU.Checked Then
		On Error Resume Next

		Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_Processor" )
		If Not Err Then
			gvcCPU = colItems.Count
			CPUNumber.value = gvcCPU
			If gvcCPU > 1 Then MultipleCPU.InnerHTML  = "s"
			For Each objItem In colItems
				CPUModel.value  = Trim( objItem.Name )
				CPUSpeed.value  = objItem.CurrentClockSpeed
				CPUSocket.value = objItem.SocketDesignation
			Next
		End If

		On Error Goto 0

		ButtonDetailsCPU.disabled = False

		Add2CsvCPU
	End If
End Sub


Function InventoryDirectX( )
	Dim blnLoaded, i
	Dim colItems, colNodes, objItem, objNode, xmlDoc
	Dim strDxDiag, strQuery, strSysDir

	strSysDir = gvoWSHShell.ExpandEnvironmentStrings( "%Windir%\System32" )
	strDxDiag = gvoFSO.BuildPath( strSysDir, "DxDiag.exe" )

	' Delete old XML file if it exists, unless specified otherwise
	If Not gvaSettingsBool.Item( "KEEPXML" ) Then
		If gvoFSO.FileExists( gvaSettingsStr.Item( "XML" ) ) Then gvoFSO.DeleteFile gvaSettingsStr.Item( "XML" ), True
	End If

	' Run DXDIAG.EXE, if required, and save results in XML file
	If gvoFSO.FileExists( gvaSettingsStr.Item( "XML" ) ) Then
		If Not gvaSettingsBool.Item( "KEEPXML" ) Then
			gvoFSO.DeleteFile gvaSettingsStr.Item( "XML" ), True
			Sleep 2
			gvoWSHShell.Run strDxDiag & " /whql:off /x " & gvaSettingsStr.Item( "XML" ), 7, False
		End If
	Else
		gvoWSHShell.Run strDxDiag & " /whql:off /x " & gvaSettingsStr.Item( "XML" ), 7, False
	End If

	' Wait until XML file is created, 5 minutes maximum
	For i = 1 To 150
		Sleep 1
		If gvoFSO.FileExists( gvaSettingsStr.Item( "XML" ) ) Then Exit For
		Sleep 1
	Next

	' Wait for DXDIAG to close, 30 seconds maximum
	Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_Process WHERE Caption='DxDiag.exe'" )
	For i = 1 To 5
		If colItems.count = 0 Then Exit For
		Sleep 6
		Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_Process WHERE Caption='DxDiag.exe'" )
	Next

	' Open the XML file created by DXDIAG
	Set xmlDoc = CreateObject( "Microsoft.XMLDOM" )
	xmlDoc.Async = "False"
	blnLoaded = xmlDoc.Load( gvaSettingsStr.Item( "XML" ) )
	If Not blnLoaded Then
		' Retry 5 times maximum, with 6 seconds interval
		For i = 1 To 15
			Sleep 2
			blnLoaded = xmlDoc.Load( gvaSettingsStr.Item( "XML" ) )
			If blnLoaded Then Exit For
		Next
		Sleep 2
		MsgBox "Process DxDiag.exe still running", vbOKOnly, "DxDiag error"
	End If

	If blnLoaded Then
		ReDim gvaVideo( 4, 0 )
	
		strQuery = "/DxDiag/DisplayDevices/DisplayDevice/DisplayMemory"
		Set colNodes = xmlDoc.selectNodes( strQuery )
		i = 0
		For Each objNode in colNodes
			ReDim Preserve gvaVideo( 4, i )
			gvaVideo( 0, i ) = Trim( Replace( objNode.text, "MB", "" ) )
			i = i + 1
		Next
	
		strQuery = "/DxDiag/DisplayDevices/DisplayDevice/CurrentMode"
		Set colNodes = xmlDoc.selectNodes( strQuery )
		i = 0
		For Each objNode in colNodes
			gvaVideo( 1, i ) = Trim( objNode.text )
			i = i + 1
		Next
	
		strQuery = "/DxDiag/DisplayDevices/DisplayDevice/MonitorName"
		Set colNodes = xmlDoc.selectNodes( strQuery )
		i = 0
		For Each objNode in colNodes
			gvaVideo( 2, i ) = Trim( objNode.text )
			i = i + 1
		Next
	
		strQuery = "/DxDiag/DisplayDevices/DisplayDevice/MonitorModel"
		Set colNodes = xmlDoc.selectNodes( strQuery )
		i = 0
		For Each objNode in colNodes
			gvaVideo( 3, i ) = Trim( objNode.text )
			i = i + 1
		Next
	
		strQuery = "/DxDiag/DisplayDevices/DisplayDevice/CardName"
		Set colNodes = xmlDoc.selectNodes( strQuery )
		i = 0
		For Each objNode in colNodes
			gvaVideo( 4, i ) = Trim( objNode.text )
			i = i + 1
		Next
		
		InventoryDirectX = True
	Else
		InventoryDirectX = False
	End If

	' Clean up
	Set colNodes = Nothing
	Set xmlDoc   = Nothing
End Function


Sub InventoryHDD( )
	Dim arrIndex( ), colItems, i, intDisk, objItem, strHolder, strQuery

	If CheckboxHDD.Checked Then
		On Error Resume Next

		If gvaSettingsBool.Item( "USBSTOR" ) Then
			strQuery = "SELECT * FROM Win32_DiskDrive WHERE Size > 0"
		Else
			strQuery = "SELECT * FROM Win32_DiskDrive WHERE SCSITargetId >= 0"
		End If
		Set colItems = gvoWMIService.ExecQuery( strQuery )
		If Not Err Then
			gvcHDD = colItems.Count
			' Add indexes to an array
			i = 0
			ReDim arrIndex(0)
			For Each objItem In colItems
				If objItem.Size > 0 Then
					arrIndex(i) = objItem.Index
					i = i + 1
					ReDim Preserve arrIndex(i)
				End If
			Next
			If UBound( arrIndex ) > 0 Then
				' Trim and sort the array
				ReDim Preserve arrIndex( UBound( arrIndex ) - 1 )
				arrIndex = ArraySort( arrIndex )
			End If
			For Each objItem In colItems
				For i = 0 To UBound( arrIndex )
					If arrIndex(i) = objItem.Index Then
						Select Case i
							Case 0
								HardDisk0Index.value       = objItem.Index
								If IsNull( objItem.Model ) Or IsEmpty( objItem.Model ) Then
									HardDisk0Model.value = objItem.Caption
								Else
									HardDisk0Model.value = objItem.Model
								End If
								HardDisk0Size.value        = Round( objItem.Size / 1073741824 )
								HardDisk0Interface.value   = gvaHDD( 3, 0 )
								ButtonDetailsHDD.disabled  = False
							Case 1
								HardDisk1.style.display    = gvsTableRowStyle
								MultipleHDUs.style.display = "inline"
								HardDisk1Index.value       = objItem.Index
								If IsNull( objItem.Model ) Or IsEmpty( objItem.Model ) Then
									HardDisk1Model.value = objItem.Caption
								Else
									HardDisk1Model.value = objItem.Model
								End If
								HardDisk1Size.value        = Round( objItem.Size / 1073741824 )
								HardDisk1Interface.value   = gvaHDD( 3, 1 )
							Case 2
								HardDisk2.style.display    = gvsTableRowStyle
								HardDisk2Index.value       = objItem.Index
								If IsNull( objItem.Model ) Or IsEmpty( objItem.Model ) Then
									HardDisk2Model.value = objItem.Caption
								Else
									HardDisk2Model.value = objItem.Model
								End If
								HardDisk2Size.value        = Round( objItem.Size / 1073741824 )
								HardDisk2Interface.value   = gvaHDD( 3, 2 )
							Case 3
								HardDisk3.style.display    = gvsTableRowStyle
								HardDisk3Index.value       = objItem.Index
								If IsNull( objItem.Model ) Or IsEmpty( objItem.Model ) Then
									HardDisk3Model.value = objItem.Caption
								Else
									HardDisk3Model.value = objItem.Model
								End If
								HardDisk3Size.value        = Round( objItem.Size / 1073741824 )
								HardDisk3Interface.value   = gvaHDD( 3, 3 )
							Case 4
								HardDisk4.style.display    = gvsTableRowStyle
								HardDisk4Index.value       = objItem.Index
								If IsNull( objItem.Model ) Or IsEmpty( objItem.Model ) Then
									HardDisk4Model.value = objItem.Caption
								Else
									HardDisk4Model.value = objItem.Model
								End If
								HardDisk4Size.value        = Round( objItem.Size / 1073741824 )
								HardDisk4Interface.value   = gvaHDD( 3, 4 )
							Case 5
								HardDisk5.style.display    = gvsTableRowStyle
								HardDisk5Index.value       = objItem.Index
								If IsNull( objItem.Model ) Or IsEmpty( objItem.Model ) Then
									HardDisk5Model.value = objItem.Caption
								Else
									HardDisk5Model.value = objItem.Model
								End If
								HardDisk5Size.value        = Round( objItem.Size / 1073741824 )
								HardDisk5Interface.value   = gvaHDD( 3, 5 )
							Case 6
								HardDisk6.style.display    = gvsTableRowStyle
								HardDisk6Index.value       = objItem.Index
								If IsNull( objItem.Model ) Or IsEmpty( objItem.Model ) Then
									HardDisk6Model.value = objItem.Caption
								Else
									HardDisk6Model.value = objItem.Model
								End If
								HardDisk6Size.value        = Round( objItem.Size / 1073741824 )
								HardDisk6Interface.value   = gvaHDD( 3, 6 )
							Case 7
								HardDisk7.style.display    = gvsTableRowStyle
								HardDisk7Index.value       = objItem.Index
								If IsNull( objItem.Model ) Or IsEmpty( objItem.Model ) Then
									HardDisk7Model.value = objItem.Caption
								Else
									HardDisk7Model.value = objItem.Model
								End If
								HardDisk7Size.value        = Round( objItem.Size / 1073741824 )
								HardDisk7Interface.value   = gvaHDD( 3, 7 )
							Case Else
								' An asterisk after the 8th drive index indicates there are more than 8 harddisks
								HardDisk0Index.value = HardDisk0Index.value & "*"
						End Select
					End If
				Next
			Next
		End If

		On Error Goto 0

		Add2CsvHDD
	End If
End Sub


Sub InventoryHID( )
	Dim arrConnectorTypes, arrHardwareTypes, arrPointingTypes
	Dim intCount
	Dim colItems, objItem, objWMIService
	Dim strKbdPNP

	If CheckboxHID.checked Then
		' Enumeration of connector and hardware types
		arrConnectorTypes = Array( "PS/2", "Serial","USB" )
		arrHardwareTypes  = Array( "Standard Mouse", "Standard Pointer", "Standard Absolute Pointer", "Tablet", "Touch Screen", "Pen", "Track Ball" )
		ReDim Preserve arrHardwareTypes( 256 )
		arrHardwareTypes( 256 ) = "Other"
		arrPointingTypes  = Array( "Unknown", "Other", "Unknown", "Mouse", "Trackball", "Track Point", "Glide Point", "Touch Pad", "Touch Screen", "Mouse - Optical Sensor" )
	
		If CheckBoxHID.Checked Then
			On Error Resume Next

			' Check for mouse details in root/WMI - this may fail on access denied errors when not running with elevated privileges
			Set objWMIService = GetObject( "winmgmts://" & gvsComputer & "/root/WMI" )
			intCount = 0
			Set colItems = objWMIService.ExecQuery( "SELECT * FROM MSMouse_PortInformation WHERE Active = True" )
			If Not Err Then
				intCount = colItems.Count
				If intCount > 1 Then
					Set colItems = objWMIService.ExecQuery( "SELECT * FROM MSMouse_PortInformation WHERE Active = True AND Instancename LIKE 'HID\\%'" )
					intCount = colItems.Count
					If intCount = 0 Then
						Set colItems = objWMIService.ExecQuery( "SELECT * FROM MSMouse_PortInformation WHERE Active = True AND Instancename LIKE '%&%'" )
					End If
				End If
				For Each objItem In colItems
					MouseType.value  = arrHardwareTypes( CInt( objItem.HardwareType ) )
					MouseModel.value = objItem.Buttons & "-buttons; " & arrConnectorTypes( CInt( objItem.ConnectorType ) )
				Next
			End If

			If MouseType.value = "" And MouseModel.value = "" Then
				' Check for mouse details in root/CIMV2 - this is less likely to fail on access denied errors
				intCount = 0
				Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_PointingDevice" )
				If Not Err Then
					intCount = colItems.Count
					If intCount > 1 Then
						Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_PointingDevice WHERE NOT PNPDeviceID LIKE 'ACPI\\%'" )
						intCount = colItems.Count
						If colItems.Count = 0 Then
							Set colItems = objWMIService.ExecQuery( "SELECT * FROM Win32_PointingDevice" )
						End If
					End If
					For Each objItem In colItems
						If MouseType.value = "" And MouseModel.value = "" Then
							MouseType.value  = arrPointingTypes( objItem.PointingType )
							If objItem.NumberOfButtons > 0 Then MouseType.value = MouseType.value & " (" & objItem.NumberOfButtons & " buttons)"
							MouseModel.value = objItem.Description
						End If
					Next
				End If
			End If
			
			' Check for keyboard details in root/WMI - this may fail on access denied errors when not running with elevated privileges
			intCount  = 0
			strKbdPNP = ""
			Set colItems = objWMIService.ExecQuery( "SELECT * FROM MSKeyboard_PortInformation WHERE Active = True" )
			If Not Err Then
				intCount = colItems.Count
				If intCount > 1 Then
					Set colItems = objWMIService.ExecQuery( "SELECT * FROM MSKeyboard_PortInformation WHERE Active = True AND Instancename LIKE 'HID\\%'" )
					intCount = colItems.Count
					If colItems.Count = 0 Then
						Set colItems = objWMIService.ExecQuery( "SELECT * FROM MSKeyboard_PortInformation WHERE Active = True AND Instancename LIKE '%&%'" )
					End If
				End If
				For Each objItem In colItems
					strKbdPNP = Split( objItem.InstanceName, "\" )(1)
					KbdModel.value = objItem.FunctionKeys & " F-keys; " & objItem.Indicators & " LEDs; " & arrConnectorTypes( CInt( objItem.ConnectorType ) )
				Next
			End If

			If strKbdPNP = "" Then
				' Check for keyboard details in root/CIMV2 - this is less likely to fail on access denied errors
				intCount = 0
				Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_Keyboard" )
				If Not Err Then
					intCount = colItems.Count
					If intCount > 1 Then
						Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_Keyboard WHERE NOT PNPDeviceID LIKE 'ACPI\\%'" )
						intCount = colItems.Count
						If colItems.Count = 0 Then
							Set colItems = objWMIService.ExecQuery( "SELECT * FROM Win32_Keyboard" )
						End If
					End If
					For Each objItem In colItems
						If KbdModel.value = "" And KbdModel.value = "" Then
							KbdType.value  = objItem.Name
							KbdModel.value = objItem.Description
						End If
					Next
				End If
			Else
				Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_Keyboard WHERE PNPDeviceID LIKE '%\\" & strKbdPNP & "\\%'" )
				If Not Err Then
					For Each objItem In colItems
						KbdType.value = objItem.Name
					Next
				End If
			End If
	
			Set objWMIService = Nothing
			On Error Goto 0

			ButtonDetailsHID.disabled = False
	
			Add2CsvHID
		End If
	End If
End Sub


Sub InventoryMainBoard( )
	Dim colItems, objItem, strMBVersion

	If CheckboxMainBoard.Checked Then
		On Error Resume Next

		Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_BaseBoard" )
		If Not Err Then
			For Each objItem In colItems
				If gvaSettingsBool.Item( "DEVTEST" ) Then
					strMBVersion = "0.00"
				Else
					strMBVersion = objItem.Version
				End If
				MBManufacturer.value = objItem.Manufacturer
				MBModel.value        = objItem.Product
				MBVersion.value      = strMBVersion
			Next
		End If

		On Error Goto 0

		ChassisType.value = Chassis( )

		ButtonDetailsMainBoard.disabled = False

		Add2CsvMainBoard
	End If

	CheckboxMainBoard.disabled = True
End Sub


Sub InventoryMemory( )
	Dim colItems, objItem

	If CheckboxMemory.Checked Then
		On Error Resume Next

		' Capacity filter intended for HP/COMPAQ EVO models
		Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_PhysicalMemory WHERE Capacity > 524288" )
		If Not Err Then
			For Each objItem in colItems
				gvcMemory = gvcMemory + 1
				gviMemSize = gviMemSize + objItem.Capacity
				If gviMemSpeed = 0 Or objItem.Speed < gviMemSpeed Then gviMemSpeed = objItem.Speed
			Next
			MemoryModules.value = gvcMemory
			MemorySize.value    = Round( gviMemSize / 1048576 )
	
			Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_PhysicalMemoryArray" )
			For Each objItem In colItems
				If objItem.MemoryDevices > gvcBanks Then gvcBanks = objItem.MemoryDevices
			Next
		End If

		On Error Goto 0

		MemoryBanks.value = gvcBanks

		ButtonDetailsMemory.disabled = False

		Add2CsvMemory
	End If
End Sub


Sub InventoryMonitor( )
	Dim blnIsDesktopMonitor
	Dim i, intHeight, intWidth, numRatio
	Dim colItems, colItems2, objItem, objItem2, objMatches, objRE, objWMIService
	Dim strDesktopMonitorDeviceDesc, strDesktopMonitorHardwareID, strDesktopMonitorMfg, strDeviceDesc, strInstanceName, strMfg, strQuery, strQuery2, strSerialNumberID, strSerialNumberLength, strSize
	
	If CheckboxMonitor.Checked Then
		On Error Resume Next
		
		ButtonDetailsMonitor.disabled = False
	
		' Use Win32_DesktopMonitor to get all the details for 1 monitor only
		strQuery = "SELECT * FROM Win32_DesktopMonitor WHERE NOT Description LIKE '%Default%'"
		Set objWMIService = GetObject( "winmgmts://" & gvscomputer & "/root/CIMV2" )
		Set colItems      = objWMIService.ExecQuery( strQuery )
		If Not Err Then
			i = 0
			For Each objItem In colItems
				strDesktopMonitorDeviceDesc = objItem.Description
				strDesktopMonitorHardwareID = UCase( objItem.PNPDeviceID )
				strDesktopMonitorMfg = objItem.MonitorManufacturer
				i = i + 1
			Next
		End If
		Set colItems      = Nothing
		Set objWMIService = Nothing
		
		' Use WmiMonitorID to get some details for all monitors
		strQuery = "SELECT * FROM WmiMonitorID"
		Set objWMIService = GetObject( "winmgmts://" & gvsComputer & "/root/WMI" )
		Set colItems      = objWMIService.ExecQuery( strQuery )
		For Each objItem In colItems
			strInstanceName = UCase( objItem.InstanceName )
			blnIsDesktopMonitor = ( InStr( strInstanceName, strDesktopMonitorHardwareID ) = 1 )
			If blnIsDesktopMonitor Then
				' If this is the monitor returned by Win32_DesktopMonitor then we already have the Device Description and Manufacturer
				strDeviceDesc = strDesktopMonitorDeviceDesc
				strMfg        = strDesktopMonitorMfg
			Else
				' If this is NOT the monitor returned by Win32_DesktopMonitor then we have to query the registry for the Device Description and Manufacturer
				' First get the DeviceID as used in the registry by removing a trailing instance index from the InstanceName (e.g. remove "_0" or "_1")
				Set objRE = New RegExp
				objRE.Pattern = "(^.*)_\d{1,2}$"
				If objRE.Test( strInstanceName ) Then
					Set objMatches = objRE.Execute( strInstanceName )
					strInstanceName = objMatches.Item(0).Submatches.Item(0)
					Set objMatches = Nothing
				End If
				Set objRE = Nothing
				' Read the Device Description from the registry for this monitor
				strDeviceDesc = gvoWSHShell.RegRead( "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\" & strInstanceName & "\DeviceDesc" )
				If Not IsNull( strDeviceDesc ) Then
					If Left( strDeviceDesc, 1 ) <> "(" And InStr( strDeviceDesc, ";" ) > 1 Then
						strDeviceDesc = Mid( strDeviceDesc, InStr( strDeviceDesc, ";" ) + 1 )
					End If
				End If
				' Read the Manufacturer from the registry for this monitor
				strMfg = gvoWSHShell.RegRead( "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\" & strInstanceName & "\Mfg" )
				If Not IsNull( strMfg ) Then
					If Left( strMfg, 1 ) <> "(" And InStr( strMfg, ";" ) > 1 Then
						strMfg = Mid( strMfg, InStr( strMfg, ";" ) + 1 )
					End If
				End If
			End If
			strSerialNumberLength = objItem.UserFriendlyNameLength
			If strSerialNumberLength > 0 Then
				strSerialNumberID = Chain( objItem.SerialNumberID )
			Else
				strSerialNumberID = ""
			End If
			' Get monitor dimensions for this monitor
			strQuery2 = "SELECT * FROM WmiMonitorBasicDisplayParams WHERE InstanceName LIKE '" & Replace( strInstanceName, "\", "\\" ) & "%'"
			Set colItems2 = objWMIService.ExecQuery( strQuery2 )
			If Not Err Then
				If colItems2.Count = 1 Then
					For Each objItem2 in colItems2
						intHeight   = objItem2.MaxVerticalImageSize
						intWidth    = objitem2.MaxHorizontalImageSize
						If intHeight * intWidth > 0 Then
							numRatio = intWidth / intHeight
							If gvaSettingsBool.Item( "CM" ) Then
								strSize = " (" & intWidth  & " x " & intHeight & " cm"
							Else
								strSize = " (" & CInt( Sqr( ( intWidth * intWidth ) + ( intHeight * intHeight ) ) / 2.54 ) & """"
							End If
							If numRatio >= 1.45 Then
								strSize = strSize & " widescreen"
							End If
							strSize = strSize & ")"
						End If
					Next
				End If
			End If
			Select Case gvcMonitor
				Case 0
					MonitorIndex0.value        = gvcMonitor
					MonitorModel0.value        = strDeviceDesc & strSize
					MonitorManufacturer0.value = strMfg
					If gvaSettingsBool.Item( "DEVTEST" ) And ( strSerialNumberID <> "" ) Then
						MonitorSerial0.value   = "0123456789"
					Else
						MonitorSerial0.value   = strSerialNumberID
					End If
				Case 1
					MultipleMonitors.style.display = "inline"
					Monitor1.style.display     = gvsTableRowStyle
					MonitorIndex1.value        = gvcMonitor
					MonitorModel1.value        = strDeviceDesc & strSize
					MonitorManufacturer1.value = strMfg
					If gvaSettingsBool.Item( "DEVTEST" ) And ( strSerialNumberID <> "" ) Then
						MonitorSerial1.value   = "0123456789"
					Else
						MonitorSerial1.value   = strSerialNumberID
					End If
				Case 2
					Monitor2.style.display     = gvsTableRowStyle
					MonitorIndex2.value        = gvcMonitor
					MonitorModel2.value        = strDeviceDesc & strSize
					MonitorManufacturer2.value = strMfg
					If gvaSettingsBool.Item( "DEVTEST" ) And ( strSerialNumberID <> "" ) Then
						MonitorSerial2.value   = "0123456789"
					Else
						MonitorSerial2.value   = strSerialNumberID
					End If
				Case 3
					Monitor3.style.display     = gvsTableRowStyle
					MonitorIndex3.value        = gvcMonitor
					MonitorModel3.value        = strDeviceDesc & strSize
					MonitorManufacturer3.value = strMfg
					If gvaSettingsBool.Item( "DEVTEST" ) And ( strSerialNumberID <> "" ) Then
						MonitorSerial3.value   = "0123456789"
					Else
						MonitorSerial3.value   = strSerialNumberID
					End If
				Case Else
					If Not Right( MonitorIndex3.value, 1 ) = "*" Then
						MonitorIndex3.value = MonitorIndex3.value & "*"
					End If
			End Select
			gvcMonitor = gvcMonitor + 1
		Next
		
		On Error Goto 0
	End If
End Sub


Sub InventoryNIC( )
	Dim colItems, objItem
	Dim strMACAddress, strQuery
	
	If CheckBoxNIC.Checked Then
		On Error Resume Next
		' Basic query for "all" Windows versions
		strQuery = "SELECT * FROM Win32_NetworkAdapter WHERE NOT Manufacturer='Microsoft' AND NOT PnPDeviceID LIKE 'ROOT\\%' AND NOT MACAddress='' AND MACAddress IS NOT NULL"
		' Windows XP and earlier versions do NOT support the PhysicalAdapter property, Vista and later versions DO
		If gviNumOS >= 6 Then
			strQuery = strQuery & " AND PhysicalAdapter='TRUE'"
		End If
		Set colItems = gvoWMIService.ExecQuery( strQuery )
		' Check if any instance was returned, if not, widen the search criteria by skipping PnPDeviceID and PhysicalAdapter requirements
		If Err Or colItems.Count = 0 Then
			strQuery = "SELECT * FROM Win32_NetworkAdapter WHERE NOT Manufacturer='Microsoft' AND NOT MACAddress='' AND MACAddress IS NOT NULL"
			Err.Clear
			Set colItems = gvoWMIService.ExecQuery( strQuery )
		End If
		If Not Err Then
			For Each objItem In colItems
				If gvcNIC > 3 Then
					If Right( NICIndex3.value, 1 ) <> "*" Then NICIndex3.value = NICIndex3.value & "*"
				Else
					strMACAddress = Join( Split( objItem.MACAddress, ":", -1, vbTextCompare ), "" )
					If gvaSettingsBool.Item( "DEVTEST" ) Then strMACAddress = "0123456789ABCDEF"
					document.getElementById( "NIC"        & gvcNIC ).style.display = gvsTableRowStyle
					document.getElementById( "MACAddress" & gvcNIC ).value         = strMACAddress
					document.getElementById( "NICIndex"   & gvcNIC ).value         = gvcNIC
					document.getElementById( "NICModel"   & gvcNIC ).value         = objItem.ProductName
					document.getElementById( "NICSpeed"   & gvcNIC ).value         = InventoryNICSpeed( objItem.Name )
					If gvcNIC > 1 Then MultipleNICs.style.display = "inline"
				End If
				gvcNIC = gvcNIC + 1
				ButtonDetailsNIC.disabled = False
			Next
		End If
		On Error Goto 0
		Add2CsvNIC
		ButtonDetailsNIC.disabled = False
	End If
End Sub


Function InventoryNICSpeed( strName )
	Dim colItems, objItem, objWMIService, strNICSpeed, strQuery
	strNICSpeed = ""
	strQuery = "SELECT * FROM MSNdis_LinkSpeed WHERE InstanceName = '" & strName & "' AND Active = True"
	On Error Resume Next
	Set objWMIService = GetObject( "winmgmts://" & gvsComputer & "/root/WMI"   )
	Set colItems = objWMIService.ExecQuery( strQuery )
	If Not Err Then
		For Each objItem In colItems
			If objItem.NdisLinkSpeed < 10000 Then
				strNICSpeed = objItem.NdisLinkSpeed /    10 & " kb/s"
			Else
				strNICSpeed = objItem.NdisLinkSpeed / 10000 & " Mb/s"
			End If
		Next
	End If
	On Error Goto 0
	InventoryNICSpeed = strNICSpeed
End Function


Sub InventoryPorts( )
	Dim cntAGP, cntOth, cntPar, cntPCI, cntPCIE, cntSer, cntUSB, cntUSB3, colItems, objItem
	cntAGP  = 0
	cntOth  = 0
	cntPar  = 0
	cntPCI  = 0
	cntPCIE = 0
	cntSer  = 0
	cntUSB  = 0
	cntUSB3 = 0
	If CheckBoxPorts.Checked Then
		On Error Resume Next
		' Check for USB controllers
		Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_USBController" )
		If Not Err Then cntUSB = colItems.Count
		Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_USBController WHERE Name LIKE '%USB 3%'" )
		If Not Err Then
			cntUSB3 = colItems.Count
			cntUSB  = cntUSB - cntUSB3
		End If
		If cntUSB3 > 0 Then
			USB.value = cntUSB & " + " & cntUSB3 & " x USB3"
		Else
			USB.value = cntUSB
		End If
		' Count parallel ports
		Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_ParallelPort" )
		If Not Err Then cntPar = colItems.Count
		Parallel.value = cntPar
		' Count serial ports
		Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_SerialPort" )
		If Not Err Then cntSer = colItems.Count
		Serial.value = cntSer
		' Count system slots (PCI/AGP)
		Set colItems = gvoWMIService.ExecQuery( "SELECT SlotDesignation FROM Win32_SystemSlot" )
		If Not Err Then
			For Each objItem In colItems
				If Left( objItem.SlotDesignation, 3 ) = "AGP" Then cntAGP = cntAGP + 1
				If Left( objItem.SlotDesignation, 3 ) = "PCI" Then
					If Left( objItem.SlotDesignation, 4 ) = "PCIE" Then
						cntPCIE = cntPCIE + 1
					Else
						cntPCI = cntPCI + 1
					End If
				End If
				If InStr( "AGPCI", Left( objItem.SlotDesignation, 3 ) ) = 0 Then cntOth = cntOth + 1
			Next
		End If
		On Error Goto 0
		Slots.value = cntPCI & " x PCI, " & cntPCIE & " x PCIE, " & cntAGP & " x AGP"
		gvsSlots    = cntPCI &   "xPCI "  & cntPCIE &   "xPCIE "  & cntAGP &   "xAGP"
		If cntOth > 0 Then
			Slots.value = Slots.value & ", " & cntOth & " x Other"
			gvsSlots    = gvsSlots    & " "  & cntOth &   "xOther"
		End If
		Add2CsvPorts
		ButtonDetailsPorts.disabled = False
	End If
End Sub


Sub InventorySound( )
	Dim colItems, objItem
	If CheckBoxSound.Checked Then
		On Error Resume Next
		Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_SoundDevice" )
		If Err Or IsNull( colItems ) Or colItems.Count = 0 Then
			If gvbWinPE And gvsWinDrive <> "" Then InventorySoundWinPE
		Else
			For Each objItem In colItems
				SoundCardManufacturer.value = objItem.Manufacturer
				SoundCardModel.value        = objItem.ProductName
			Next
		End If
		On Error Goto 0
		ButtonDetailsSound.disabled = False
		Add2CsvSound
	End If
End Sub


Sub InventorySoundWinPE( )
	Dim arrRegKeys, arrSubKeys, arrSubSubKeys, arrTest
	Dim blnFoundHardwareManufacturer
	Dim i
	Dim dicSoundCards, objReg
	Dim strAudioDescription, strAudioManufacturer, strKey, strRegKey, strSubKey

	' Mount registry hive from Windows Drive
	gvoWSHShell.Run "CMD.EXE /C REG.EXE Load HKLM\TempHive " & gvsWinDrive & "\windows\system32\config\system", 0, True

	' Scan the temporary registry hive for sound cards
	Set dicSoundCards = CreateObject( "Scripting.Dictionary" )
	Set objReg        = GetObject( "winmgmts:{impersonationLevel=impersonate}!//./root/default:StdRegProv" )
	objReg.EnumKey HKEY_LOCAL_MACHINE, "TempHive\ControlSet001\Enum\HDAudio", arrRegKeys
	If Not IsNull( arrRegKeys ) Then
		For Each strRegKey In arrRegKeys
			objReg.EnumKey HKEY_LOCAL_MACHINE, "TempHive\ControlSet001\Enum\HDAudio\" & strRegKey, arrSubKeys
			If Not IsNull( arrSubKeys ) Then
				For Each strSubKey In arrSubKeys
					objReg.Enumkey HKEY_LOCAL_MACHINE, "TempHive\ControlSet001\Enum\HDAudio\" & strRegKey & "\" & strSubKey, arrSubSubKeys
					If Not IsNull( arrSubSubKeys ) Then
						strAudioDescription  = Null
						strAudioManufacturer = Null
						objReg.GetStringValue HKEY_LOCAL_MACHINE, "TempHive\ControlSet001\Enum\HDAudio\" & strRegKey & "\" & strSubKey, "DeviceDesc", strAudioDescription
						objReg.GetStringValue HKEY_LOCAL_MACHINE, "TempHive\ControlSet001\Enum\HDAudio\" & strRegKey & "\" & strSubKey, "Mfg", strAudioManufacturer
						If Not IsNull( strAudioDescription ) And Not IsNull( strAudioManufacturer ) Then
							If InStr( strAudioDescription, ";" ) Then
								arrTest              = Split( strAudioDescription, ";" )
								strAudioDescription  = arrTest( UBound( arrTest ) )
							End If
							If InStr( strAudioManufacturer, ";" ) Then
								arrTest              = Split( strAudioManufacturer, ";" )
								strAudioManufacturer = arrTest( UBound( arrTest ) )
							End If
							dicSoundCards.Item( Trim( strAudioManufacturer ) ) = Trim( strAudioDescription )
						End If
					End If
				Next
			End If
		Next
	End If
	Set objReg = Nothing

	' Unmount registry hive
	gvoWSHShell.Run "CMD.EXE /C REG.EXE Unload HKLM\TempHive", 0, True
	
	' Search the results, preferably for a true hardware manufacturer
	strAudioDescription          = ""
	strAudioManufacturer         = ""
	blnFoundHardwareManufacturer = False
	For Each strKey in dicSoundCards.Keys
		If UCase( strKey ) <> "MICROSOFT" Then
			strAudioManufacturer         = strKey
			strAudioDescription          = dicSoundCards.Item( strKey )
			blnFoundHardwareManufacturer = True
		End If
	Next
	If Not blnFoundHardwareManufacturer Then
		For Each strKey in dicSoundCards.Keys
			strAudioManufacturer = strKey
			strAudioDescription  = dicSoundCards.Item( strKey )
		Next
	End If
	Set dicSoundCards = Nothing
	
	SoundCardManufacturer.value = strAudioManufacturer
	SoundCardModel.value        = strAudioDescription
	ButtonDetailsVideo.disabled = True
End Sub


Sub InventoryVideo( )
	Dim colItems, objItem

	If CheckboxVideo.Checked Then
		On Error Resume Next
		Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_VideoController" )
		If Err Or IsNull( colItems ) Or colItems.Count = 0 Then
			If gvbWinPE And gvsWinDrive <> "" Then
				On Error Goto 0
				ButtonDetailsVideo.disabled = True
				InventoryVideoWinPE
			End If
		Else
			For Each objItem in colItems
				document.getElementById( "Video"       & gvcVideo ).style.display = gvsTableRowStyle
				document.getElementById( "VideoIndex"  & gvcVideo ).value         = gvcVideo
				document.getElementById( "VideoModel"  & gvcVideo ).value         = objItem.Name
				document.getElementById( "VideoMemory" & gvcVideo ).value         = Round( objItem.AdapterRAM / 1048576 )
				document.getElementById( "VideoMode"   & gvcVideo ).value         = objItem.VideoModeDescription
				gvcVideo = gvcVideo + 1
				ButtonDetailsVideo.disabled = False
			Next
			If gvcVideo > 3 And Right( VideoIndex3.value ) <> "*" Then VideoIndex3.value = VideoIndex3.value & "*"
		End If
		On Error Goto 0
	End If
End Sub


Sub InventoryVideoWinPE( )
	Dim arrRegKeys, arrSubKeys
	Dim i
	Dim dicVideoCards, objReg
	Dim strDictKey, strRegKey, strVideoDescription, strVideoService
	
	' Mount registry hive from Windows Drive
	gvoWSHShell.Run "CMD.EXE /C REG.EXE Load HKLM\TempHive " & gvsWinDrive & "\windows\system32\config\system", 0, True

	' Scan the temporary registry hive for video cards
	Set dicVideoCards = CreateObject( "Scripting.Dictionary" )
	Set objReg        = GetObject( "winmgmts:{impersonationLevel=impersonate}!//./root/default:StdRegProv" )
	objReg.EnumKey HKEY_LOCAL_MACHINE, "TempHive\ControlSet001\Control\Video", arrRegKeys
	If Not IsNull( arrRegKeys ) Then
		For Each strRegKey In arrRegKeys
			objReg.GetStringValue HKEY_LOCAL_MACHINE, "TempHive\ControlSet001\Control\Video\" & strRegKey & "\Video", "Service", strVideoService
			If strVideoService <> "" And UCase( strVideoService ) <> "VGA" Then ' Ignore standard VGA driver
				objReg.GetStringValue HKEY_LOCAL_MACHINE, "TempHive\ControlSet001\Services\" & strVideoService & "\Device0", "Device Description", strVideoDescription
				If Left( strVideoDescription, 3 ) <> "RDP" Then ' Ignore RDP video drivers
					dicVideoCards.Item( strVideoService ) = strVideoDescription
				End If
			End If
		Next
	End If

	' Unmount registry hive
	gvoWSHShell.Run "CMD.EXE /C REG.EXE Unload HKLM\TempHive", 0, True

	i = 0
	For Each strDictKey In dicVideoCards.Keys
		document.getElementById( "Video"       & i ).style.display = gvsTableRowStyle
		document.getElementById( "VideoIndex"  & i ).value         = i
		document.getElementById( "VideoModel"  & i ).value         = dicVideoCards.Item( strDictKey )
		document.getElementById( "VideoMemory" & i ).value         = ""
		document.getElementById( "VideoMode"   & i ).value         = ""
	Next
	If dicVideoCards.Count > 4 Then VideoIndex3.value = VideoIndex3.value & "*"
	Set objReg        = Nothing
	Set dicVideoCards = Nothing
	ButtonDetailsVideo.disabled = True
End Sub


Sub InventoryWinSATScores( )
	Dim colItems, objItem
	sngCPU    = -1
	sngDisk   = -1
	sngMemory = -1
	sngTotal  = -1
	sngVideo  = -1
	If Not gvaSettingsBool.Item( "NOSCORES" ) And Not gvbWinPE Then
		On Error Resume Next
		Set colItems = gvoWMIService.ExecQuery( "SELECT * FROM Win32_WinSAT Where TimeTaken=""MostRecentAssessment""" )
		If Not Err Then
			For Each objItem in colItems
				sngCPU    = objItem.CPUScore
				sngDisk   = objItem.DiskScore
				sngVideo  = objItem.GraphicsScore
				sngMemory = objItem.MemoryScore
				sngTotal  = objItem.WinSPRLevel
			Next
		End If
		If CheckboxCPU.Checked       Then CPUScore.value      = sngCPU
		If CheckboxHDD.Checked       Then DiskScore.value     = sngDisk
		If CheckboxMainBoard.Checked Then WinSATScore.value   = sngTotal
		If CheckboxMemory.Checked    Then MemoryScore.value   = sngMemory
		If CheckboxVideo.Checked     Then GraphicsScore.value = sngVideo
		On Error Goto 0
	End If
End Sub


Function IsAdmin( showMessage )
    ' Based on code by Denis St-Pierre
    Dim intAnswer, intButtons, intPlatformHTA, intPlatformWin, intRC
    Dim objFSO, objUAC
    Dim strCommandLine, strHTA, strMsg, strTitle
    If ( InStr( UCase( Hardware.CommandLine ), "/NOADMIN" ) > 0 ) Or gvbWinPE Then
    	IsAdmin = True
    Else
    	IsAdmin = False
	    Set objFSO      = CreateObject( "Scripting.FileSystemObject" )
		Set gvoWSHShell = CreateObject( "WScript.Shell" )
		intPlatformHTA = CInt( Right( window.navigator.platform, 2 ) )
	    If objFSO.FolderExists( gvoWSHShell.ExpandEnvironmentStrings( "%windir%\SysWOW64" ) ) Then
			intPlatformWin = 64
		Else
			intPlatformWin = 32
		End If
	    Set objFSO = Nothing
'	    On Error Resume Next
	    intRC = gvoWSHShell.Run( "CMD /C OPENFILES > NUL 2>&1", 7, True )
	    If Err Then intRC = 1
	    On Error Goto 0
	    If intRC = 0 Then
	    	IsAdmin = True
	    Else
			If showMessage Then
				strTitle   = "Elevated Privileges Recommended"
		   		intButtons = vbYesNoCancel + vbInformation + vbApplicationModal
				strMsg     = "This HTA works best with elevated privileges." & vbCrLf _
				           & "Without elevated privileges, the HTA won't have access to all WMI namespaces, i.e. some details will be missed." & vbCrLf & vbCrLf _
				           & "Running this HTA as administrator is recommended." & vbCrLf & vbCrLf & vbCrLf & vbcrlf
				If intPlatformHTA = 32 And intPlatformWin = 64 Then
					strMsg = strMsg _
				           & "This HTA is running in a 32-bit MSHTA process (%windir%\SysWOW64\mshta.exe) on 64-bit Windows." & vbCrLf & vbCrLf _
				           & "Add the path to the proper (64-bit) MSHTA to this HTA's command line:" & vbCrLf & vbCrLf
				Else
					strMsg = strMsg _
				           & "Note: On some 64-bit systems, you may still get this message, whether running with elevated privileges or not." & vbCrLf & vbCrLf _
				           & "Usually this is caused by HTAs being incorrectly associated with the 32-bit MSHTA version (%windir%\SysWOW64\mshta.exe)." & vbCrLf & vbCrLf _
				           & "In that case, either use the ""/NOADMIN"" command line switch, or add the path to the proper (64-bit) MSHTA to this HTA's command line:" & vbCrLf & vbCrLf
				End If
				strMsg     = strMsg _
				           & """%windir%\system32\mshta.exe"" """ & Self.location.pathname & """" & vbCrLf & vbCrLf & vbCrLf & vbCrLf _
				           & "Do you want to elevate privileges now?" & vbCrLf & vbCrLf _
				           & "Yes:"    & vbtab & "Restart the HTA with elevated privileges" & vbCrLf _
				           & "No:"     & vbTab & "Continue without elevated privileges"     & vbCrLf _
				           & "Cancel:" & vbTab & "Abort"
				intAnswer  = MsgBox( strMsg, intButtons, strTitle )
				If intAnswer = vbYes Then
					strHTA = Self.location.pathname
					strCommandLine = Hardware.CommandLine
					' Strip HTA file name or path from command line
					If InStr( strCommandLine, """" & strHTA & """" ) = 1 Then
						strCommandLine = Mid( strCommandLine, Len( strHTA ) + 3 )
					ElseIf InStr( strCommandLine, strHTA ) = 1 Then
						strCommandLine = Mid( strCommandLine, Len( strHTA ) + 1 )
					ElseIf InStr( strCommandLine, """" & gvoFSO.GetFileName( strHTA ) & """" ) = 1 Then
						strCommandLine = Mid( strCommandLine, Len( strHTA ) + 3 )
					ElseIf InStr( strCommandLine, gvoFSO.GetFileName( strHTA ) ) = 1 Then
						strCommandLine = Mid( strCommandLine, Len( strHTA ) + 1 )
					ElseIf InStr( strCommandLine, gvoFSO.GetFileName( strHTA ) ) > 0 Then
						strCommandLine = Mid( strCommandLine, InStr( strHTA ) + Len( strHTA ) + 1 )
						If Left( strCommandLine, 1 ) = """" Then strCommandLine = Mid( strCommandLine, 2 )
					Else
						' Error: do nothing, the HTA will close
					End If
					strCommandLine = Replace( Trim( strCommandLine ), """", """""" )
					' Elevate privileges
					Set objUAC = CreateObject( "Shell.Application" )
					objUAC.ShellExecute "MSHTA.EXE", """" & strHTA & """ /NOADMIN " & strCommandLine, "", "runas", 1
					Set objUAC = Nothing
					window.close True
				ElseIf intAnswer = vbNo Then
					IsAdmin = True
				End If
			End If
		End If
    End If
End Function


Function IsLocalComputer( )
	' Check if specified computer is the local computer
	IsLocalComputer = False
	gvsComputer = CheckComputerName( ComputerName.value )
	If gvbWinPE Then
		IsLocalComputer = True
		gvaSettingsBool.Item( "DXDIAG"    ) = False
		gvaSettingsBool.Item( "DMIDECODE" ) = False
	ElseIf ( gvsComputer = GetLocalComputerName( ) ) Or ( gvsComputer = "LOCALHOST" ) Then
		IsLocalComputer = True
	Else
		gvaSettingsBool.Item( "DXDIAG"    ) = False
		gvaSettingsBool.Item( "DMIDECODE" ) = False
		gvaSettingsStr.Item( "COMPUTER" )   = gvsComputer
		ConfigUpdateStatus
	End If
End Function


Function Key( myInput )
	' Strip all non-word characters from string and limit length to 20
	' characters, in order to use the result as a Dictionary key name
	Dim objRE, strKey
	strKey = LCase( myInput )
	Set objRE = New RegExp
	objRE.Global  = True
	objRE.Pattern = "[^\w]"
	strKey = objRE.Replace( strKey, "" )
	Set objRE = Nothing
	If Len( strKey ) > 20 Then strKey = Left( strKey, 20 )
	Key = strKey
End Function


Sub ListColors( myDropdown, myPreselected )
	' Populate a dropdown list with colors available in CSS
	Dim i, objDropdown, objOption, strColor
	Set objDropdown = document.getElementById( myDropdown )
	objDropdown.innerHTML = ""
	On Error Resume Next
	For Each strColor In gvaCSSColors.Keys
		Set objOption = document.createElement( "OPTION" )
		objOption.text                  = strColor
		objOption.value                 = LCase( strColor )
		objOption.selected              = ( LCase( myPreselected ) = LCase( strColor ) )
		objOption.style.backgroundColor = LCase( strColor )
		objOption.style.color           = gvaCSSColors.Item( strColor )
		If Not Err Then objDropdown.Add( objOption )
		Set objOption = Nothing
	Next
	On Error Goto 0
	Set objDropdown = Nothing
End Sub


Sub ListCSSColors( )
	' List of available CSS colors by W3Schools.com:
	' http://www.w3schools.com/colors/colors_names.asp
	' Contrasting text colors calculated with code by Brian Suda:
	' https://24ways.org/2010/calculating-color-contrast/
	On Error Resume Next
	Set gvaCSSColors = Nothing
	On Error Goto 0
	Set gvaCSSColors = CreateObject( "Scripting.Dictionary" )
	gvaCSSColors.Item( "AliceBlue" )            = "black"
	gvaCSSColors.Item( "AntiqueWhite" )         = "black"
	gvaCSSColors.Item( "Aqua" )                 = "black"
	gvaCSSColors.Item( "Aquamarine" )           = "black"
	gvaCSSColors.Item( "Azure" )                = "black"
	gvaCSSColors.Item( "Beige" )                = "black"
	gvaCSSColors.Item( "Bisque" )               = "black"
	gvaCSSColors.Item( "Black" )                = "white"
	gvaCSSColors.Item( "BlanchedAlmond" )       = "black"
	gvaCSSColors.Item( "Blue" )                 = "white"
	gvaCSSColors.Item( "BlueViolet" )           = "white"
	gvaCSSColors.Item( "Brown" )                = "white"
	gvaCSSColors.Item( "BurlyWood" )            = "black"
	gvaCSSColors.Item( "CadetBlue" )            = "black"
	gvaCSSColors.Item( "Chartreuse" )           = "black"
	gvaCSSColors.Item( "Chocolate" )            = "white"
	gvaCSSColors.Item( "Coral" )                = "black"
	gvaCSSColors.Item( "CornflowerBlue" )       = "black"
	gvaCSSColors.Item( "Cornsilk" )             = "black"
	gvaCSSColors.Item( "Crimson" )              = "white"
	gvaCSSColors.Item( "Cyan" )                 = "black"
	gvaCSSColors.Item( "DarkBlue" )             = "white"
	gvaCSSColors.Item( "DarkCyan" )             = "white"
	gvaCSSColors.Item( "DarkGoldenRod" )        = "black"
	gvaCSSColors.Item( "DarkGray" )             = "black"
	gvaCSSColors.Item( "DarkGrey" )             = "black"
	gvaCSSColors.Item( "DarkGreen" )            = "white"
	gvaCSSColors.Item( "DarkKhaki" )            = "black"
	gvaCSSColors.Item( "DarkMagenta" )          = "white"
	gvaCSSColors.Item( "DarkOliveGreen" )       = "white"
	gvaCSSColors.Item( "DarkOrange" )           = "black"
	gvaCSSColors.Item( "DarkOrchid" )           = "white"
	gvaCSSColors.Item( "DarkRed" )              = "white"
	gvaCSSColors.Item( "DarkSalmon" )           = "black"
	gvaCSSColors.Item( "DarkSeaGreen" )         = "black"
	gvaCSSColors.Item( "DarkSlateBlue" )        = "white"
	gvaCSSColors.Item( "DarkSlateGray" )        = "white"
	gvaCSSColors.Item( "DarkSlateGrey" )        = "white"
	gvaCSSColors.Item( "DarkTurquoise" )        = "black"
	gvaCSSColors.Item( "DarkViolet" )           = "white"
	gvaCSSColors.Item( "DeepPink" )             = "white"
	gvaCSSColors.Item( "DeepSkyBlue" )          = "black"
	gvaCSSColors.Item( "DimGray" )              = "white"
	gvaCSSColors.Item( "DimGrey" )              = "white"
	gvaCSSColors.Item( "DodgerBlue" )           = "white"
	gvaCSSColors.Item( "FireBrick" )            = "white"
	gvaCSSColors.Item( "FloralWhite" )          = "black"
	gvaCSSColors.Item( "ForestGreen" )          = "white"
	gvaCSSColors.Item( "Fuchsia" )              = "white"
	gvaCSSColors.Item( "Gainsboro" )            = "black"
	gvaCSSColors.Item( "GhostWhite" )           = "black"
	gvaCSSColors.Item( "Gold" )                 = "black"
	gvaCSSColors.Item( "GoldenRod" )            = "black"
	gvaCSSColors.Item( "Gray" )                 = "black"
	gvaCSSColors.Item( "Grey" )                 = "black"
	gvaCSSColors.Item( "Green" )                = "white"
	gvaCSSColors.Item( "GreenYellow" )          = "black"
	gvaCSSColors.Item( "HoneyDew" )             = "black"
	gvaCSSColors.Item( "HotPink" )              = "black"
	gvaCSSColors.Item( "IndianRed" )            = "white"
	gvaCSSColors.Item( "Indigo" )               = "white"
	gvaCSSColors.Item( "Ivory" )                = "black"
	gvaCSSColors.Item( "Khaki" )                = "black"
	gvaCSSColors.Item( "Lavender" )             = "black"
	gvaCSSColors.Item( "LavenderBlush" )        = "black"
	gvaCSSColors.Item( "LawnGreen" )            = "black"
	gvaCSSColors.Item( "LemonChiffon" )         = "black"
	gvaCSSColors.Item( "LightBlue" )            = "black"
	gvaCSSColors.Item( "LightCoral" )           = "black"
	gvaCSSColors.Item( "LightCyan" )            = "black"
	gvaCSSColors.Item( "LightGoldenRodYellow" ) = "black"
	gvaCSSColors.Item( "LightGray" )            = "black"
	gvaCSSColors.Item( "LightGrey" )            = "black"
	gvaCSSColors.Item( "LightGreen" )           = "black"
	gvaCSSColors.Item( "LightPink" )            = "black"
	gvaCSSColors.Item( "LightSalmon" )          = "black"
	gvaCSSColors.Item( "LightSeaGreen" )        = "black"
	gvaCSSColors.Item( "LightSkyBlue" )         = "black"
	gvaCSSColors.Item( "LightSlateGray" )       = "black"
	gvaCSSColors.Item( "LightSlateGrey" )       = "black"
	gvaCSSColors.Item( "LightSteelBlue" )       = "black"
	gvaCSSColors.Item( "LightYellow" )          = "black"
	gvaCSSColors.Item( "Lime" )                 = "black"
	gvaCSSColors.Item( "LimeGreen" )            = "black"
	gvaCSSColors.Item( "Linen" )                = "black"
	gvaCSSColors.Item( "Magenta" )              = "white"
	gvaCSSColors.Item( "Maroon" )               = "white"
	gvaCSSColors.Item( "MediumAquaMarine" )     = "black"
	gvaCSSColors.Item( "MediumBlue" )           = "white"
	gvaCSSColors.Item( "MediumOrchid" )         = "black"
	gvaCSSColors.Item( "MediumPurple" )         = "black"
	gvaCSSColors.Item( "MediumSeaGreen" )       = "black"
	gvaCSSColors.Item( "MediumSlateBlue" )      = "white"
	gvaCSSColors.Item( "MediumSpringGreen" )    = "black"
	gvaCSSColors.Item( "MediumTurquoise" )      = "black"
	gvaCSSColors.Item( "MediumVioletRed" )      = "white"
	gvaCSSColors.Item( "MidnightBlue" )         = "white"
	gvaCSSColors.Item( "MintCream" )            = "black"
	gvaCSSColors.Item( "MistyRose" )            = "black"
	gvaCSSColors.Item( "Moccasin" )             = "black"
	gvaCSSColors.Item( "NavajoWhite" )          = "black"
	gvaCSSColors.Item( "Navy" )                 = "white"
	gvaCSSColors.Item( "OldLace" )              = "black"
	gvaCSSColors.Item( "Olive" )                = "white"
	gvaCSSColors.Item( "OliveDrab" )            = "white"
	gvaCSSColors.Item( "Orange" )               = "black"
	gvaCSSColors.Item( "OrangeRed" )            = "white"
	gvaCSSColors.Item( "Orchid" )               = "black"
	gvaCSSColors.Item( "PaleGoldenRod" )        = "black"
	gvaCSSColors.Item( "PaleGreen" )            = "black"
	gvaCSSColors.Item( "PaleTurquoise" )        = "black"
	gvaCSSColors.Item( "PaleVioletRed" )        = "black"
	gvaCSSColors.Item( "PapayaWhip" )           = "black"
	gvaCSSColors.Item( "PeachPuff" )            = "black"
	gvaCSSColors.Item( "Peru" )                 = "black"
	gvaCSSColors.Item( "Pink" )                 = "black"
	gvaCSSColors.Item( "Plum" )                 = "black"
	gvaCSSColors.Item( "PowderBlue" )           = "black"
	gvaCSSColors.Item( "Purple" )               = "white"
	gvaCSSColors.Item( "RebeccaPurple" )        = "white"
	gvaCSSColors.Item( "Red" )                  = "white"
	gvaCSSColors.Item( "RosyBrown" )            = "black"
	gvaCSSColors.Item( "RoyalBlue" )            = "white"
	gvaCSSColors.Item( "SaddleBrown" )          = "white"
	gvaCSSColors.Item( "Salmon" )               = "black"
	gvaCSSColors.Item( "SandyBrown" )           = "black"
	gvaCSSColors.Item( "SeaGreen" )             = "white"
	gvaCSSColors.Item( "SeaShell" )             = "black"
	gvaCSSColors.Item( "Sienna" )               = "white"
	gvaCSSColors.Item( "Silver" )               = "black"
	gvaCSSColors.Item( "SkyBlue" )              = "black"
	gvaCSSColors.Item( "SlateBlue" )            = "white"
	gvaCSSColors.Item( "SlateGray" )            = "white"
	gvaCSSColors.Item( "SlateGrey" )            = "white"
	gvaCSSColors.Item( "Snow" )                 = "black"
	gvaCSSColors.Item( "SpringGreen" )          = "black"
	gvaCSSColors.Item( "SteelBlue" )            = "white"
	gvaCSSColors.Item( "Tan" )                  = "black"
	gvaCSSColors.Item( "Teal" )                 = "white"
	gvaCSSColors.Item( "Thistle" )              = "black"
	gvaCSSColors.Item( "Tomato" )               = "black"
	gvaCSSColors.Item( "Turquoise" )            = "black"
	gvaCSSColors.Item( "Violet" )               = "black"
	gvaCSSColors.Item( "Wheat" )                = "black"
	gvaCSSColors.Item( "White" )                = "black"
	gvaCSSColors.Item( "WhiteSmoke" )           = "black"
	gvaCSSColors.Item( "Yellow" )               = "black"
	gvaCSSColors.Item( "YellowGreen" )          = "black"
End Sub


Function Max( num1, num2 )
	If num1 > num2 Then
		Max = num1
	Else
		Max = num2
	End If
End Function


Function Min( num1, num2 )
	If num1 < num2 Then
		Min = num1
	Else
		Min = num2
	End If
End Function


Sub OnClick_CheckboxDMIDecode( )
	If gvbWinPE Then
		CheckboxDMIDecode.checked  = False
		CheckboxDMIDecode.disabled = True
	End If
End Sub


Sub OnClick_CheckboxDxDiag( )
	If gvbWinPE Then
		CheckboxDxDiag.checked   = False
		CheckboxDxDiag.disabled  = True
		CheckboxKeepXML.checked  = False
		CheckboxKeepXML.disabled = True
	End If
	CheckboxKeepXML.checked  = CheckboxKeepXML.checked And CheckboxDxDiag.checked
	If CheckboxDxDiag.checked Then
		TablerowKeepXML.style.display       = gvsTableRowStyle
		TablerowKeepXML.style.visibility    = "visible"
		TablerowDxDiagPath.style.display    = gvsTableRowStyle
		TablerowDxDiagPath.style.visibility = "visible"
	Else
		gvaSettingsStr.Item( "XML" )        = gvaDefaultsStr.Item( "XML" )
		TablerowKeepXML.style.display       = "none"
		TablerowKeepXML.style.visibility    = "collapse"
		TablerowDxDiagPath.style.display    = "none"
		TablerowDxDiagPath.style.visibility = "collapse"
	End If
	InputDxDiag.value = gvaSettingsStr.Item( "XML" )
End Sub


Sub PasteFromClipboard
	Dim strText
	On Error Resume Next
	strText = Document.ParentWindow.ClipboardData.GetData( "text" )
	If Err Then
		MsgBox "An error occurred while trying to paste data from the clipboard:" & vbCrLf & vbCrLf & Err.Description, vbOKOnly, "Clipboard Error"
	Else
		If Not IsNull( strText ) Then ComputerName.value = strText
	End If
	On Error Goto 0
End Sub


Sub Print( blnPrintToDefault )
	' Build an HTML table with the results, to allow printing
	Dim arrData, arrHeader, i, j, objPrintFile, strHTML, strTable

	Const OLECMDID_PRINT               =  6
	Const OLECMDID_PRINT2              = 49
	Const OLECMDID_PRINTPREVIEW        =  7
	Const OLECMDID_PRINTPREVIEW2       = 50
	Const OLECMDEXECOPT_DODEFAULT      =  0
	Const OLECMDEXECOPT_PROMPTUSER     =  1
	Const OLECMDEXECOPT_DONTPROMPTUSER =  2
	Const OLECMDEXECOPT_SHOWHELP       =  3 

	If Not gvaSettingsBool.Item( "NOIE" ) Then
		On Error Resume Next
		gvoIEPrint.Quit
		Set gvoIEPrint = CreateObject( "InternetExplorer.Application" )
		If Err.Number = 70 Then
			' Access denied error on CreateObject, a bug sometimes occurring in Windows after applying some Windows Updates
			gvaSettingsBool.Item( "NOIE" )  = True
			CheckboxDefaultBrowser.checked  = True
			CheckboxDefaultBrowser.disabled = True
			setTimeout "IEBugMessage", 100, "VBScript"
		End If
		On Error Goto 0
	End If
	If gvaSettingsBool.Item( "NOIE" ) Then
		' Create a temporary HTML file and open it in the default browser
		strHTML = "<html><head><title>Basic Hardware Inventory " & Hardware.Version & " - &copy; 2005 - " & gviCopyrightsYear & " Rob van der Woude</title></head><body>"
		strHTML = strHTML & PrintTable( )
		strHTML = strHTML & "</body></html>"
		
		Set objPrintFile = gvoFSO.CreateTextFile( gvsPrintFile )
		objPrintFile.Write( strHTML )
		objPrintFile.Close
		Set objPrintFile = Nothing
		gvoWSHShell.Run gvsPrintFile, 7, False
	Else
		On Error Resume Next
		While gvoIEPrint.Busy
			Sleep 1
		Wend
		' The following line, if run BEFORE navigating to about:blank, makes sure the IE window will open in the foreground.
		' Credits: Russell J. Wiley
		gvoWSHShell.AppActivate gvoIEPrint
		gvoIEPrint.Navigate "about:blank"
		gvoIEPrint.Document.title = "Basic Hardware Inventory " & Hardware.Version & " - &copy; 2005 - " & gviCopyrightsYear & " Rob van der Woude"
		gvoIEPrint.Document.body.style.fontFamily = "arial,sans-serif"
		gvoIEPrint.Document.body.innerHTML = PrintTable( )
		gvoIEPrint.Resizable = True
		gvoIEPrint.Visible   = True
		If blnPrintToDefault Then
			' Print to default printer without user interaction
			gvoIEPrint.ExecWB OLECMDID_PRINT, OLECMDEXECOPT_DONTPROMPTUSER
			' Give IE some time to send the command to the printer
			Sleep 5
		Else
			' Show Print Preview
			gvoIEPrint.ExecWB OLECMDID_PRINTPREVIEW, OLECMDEXECOPT_PROMPTUSER
		End If
		While gvoIEPrint.Busy
			Sleep 1
		Wend
		If Not Err Then CreateIEPrint
		On Error Goto 0
	End If
End Sub


Sub PrintPreview( )
	Print False
End Sub


Function PrintTable( )
	Dim arrData, arrHeader, i, strTable
	' Even though we aren't going to display the HTML page, linefeeds and whitespace are added as IE9 seems to be rather sensitive to it
	strTable  = "<table style=""border: 1px solid black; width: 100%;"">" & vbCrLf
	strTable  = strTable  & "<thead style=""font-weight: bold; font-size: 120%; display: table-header-group; page-break-before: always;"">" & vbCrLf
	strTable  = strTable  & "<tr style=""page-break-inside: avoid;"">" & vbCrLf
	strTable  = strTable  & "    <th style=""page-break-inside: avoid; border: 1px solid black;"">Component</th>" & vbCrLf
	strTable  = strTable  & "    <th style=""page-break-inside: avoid; border: 1px solid black;"">Value</th>" & vbCrLf
	strTable  = strTable  & "</tr>" & vbCrLf
	strTable  = strTable  & "</thead>" & vbCrLf
	strTable  = strTable  & "<tbody>" & vbCrLf
	arrData   = Split( gvsCSVTxt, vbTab )
	arrHeader = Split( gvsHeader, vbTab )
'	For i = 0 To Max( UBound( arrHeader ), UBound( arrData ) )
	For i = 0 To Min( UBound( arrHeader ), UBound( arrData ) )
		If Trim( arrData(i) ) <> "" Then
			strTable = strTable & "<tr style=""page-break-inside: avoid;"">" & vbCrLf
			strTable = strTable & "    <th style=""page-break-inside: avoid; border: 1px solid black; text-align: left; padding: 5px;"">" & arrHeader(i) & "</th>" & vbCrLf
			strTable = strTable & "    <td style=""page-break-inside: avoid; border: 1px solid black; text-align: left; padding: 5px;"">" & arrData(i) & "</td>" & vbCrLf
			strTable = strTable & "</tr>" & vbCrLf
		End If
	Next
	strTable = strTable & "</tbody>" & vbCrLf
	strTable = strTable & "</table>" & vbCrLf
	PrintTable = strTable
End Function


Sub PrintToDefault( )
	Print True
End Sub


Function ReadIni( myFilePath, mySection, myKey )
	' This function returns a value read from an INI file
	'
	' Arguments:
	' myFilePath  [string]  the (path and) file name of the INI file
	' mySection   [string]  the section in the INI file to be searched
	' myKey       [string]  the key whose value is to be returned
	'
	' Returns:
	' the [string] value for the specified key in the specified section
	'
	' CAVEAT:     Will return a space if key exists but value is blank
	'
	' Written by Keith Lacelle
	' Modified by Denis St-Pierre and Rob van der Woude
	Dim intEqualPos, objIniFile, strFilePath, strKey, strLeftString, strLine, strSection
	ReadIni     = ""
	strFilePath = Trim( myFilePath )
	strSection  = Trim( mySection )
	strKey      = Trim( myKey )
	If gvoFSO.FileExists( strFilePath ) Then
		Set objIniFile = gvoFSO.OpenTextFile( strFilePath, ForReading, False )
		Do While objIniFile.AtEndOfStream = False
			strLine = Trim( objIniFile.ReadLine )
			' Check if section is found in the current line
			If LCase( strLine ) = "[" & LCase( strSection ) & "]" Then
				strLine = Trim( objIniFile.ReadLine )
				' Parse lines until the next section is reached
				Do While Left( strLine, 1 ) <> "["
					' Find position of equal sign in the line
					intEqualPos = InStr( 1, strLine, "=", 1 )
					If intEqualPos > 0 Then
						strLeftString = Trim( Left( strLine, intEqualPos - 1 ) )
						' Check if item is found in the current line
						If LCase( strLeftString ) = LCase( strKey ) Then
							ReadIni = Trim( Mid( strLine, intEqualPos + 1 ) )
							' In case the item exists but value is blank
							If ReadIni = "" Then ReadIni = " "
							' Abort loop when item is found
							Exit Do
						End If
					End If
					' Abort if the end of the INI file is reached
					If objIniFile.AtEndOfStream Then Exit Do
					' Continue with next line
					strLine = Trim( objIniFile.ReadLine )
				Loop
			End If
		Loop
		objIniFile.Close
	End If
End Function


Sub Reset( )
	Window_OnUnload
	Location.Reload( True )
End Sub


Sub SaveDebugLog( )
	Dim objLogFile, objRE, strLogFile, strLogText
	If IsObject( gvaSettingsBool ) Then
		If gvaSettingsBool.Count > 0 Then
			If Not gvaSettingsBool.Item( "LOG" ) Then Exit Sub
		End If
	Else
		If Not gvaSettingsBool.Item( "LOG" ) Then Exit Sub
	End If
	Set objRE = New RegExp
	objRE.Pattern    = "</?(h1|u)>"
	objRE.Global     = True
	objRE.IgnoreCase = True
	On Error Resume Next
	strLogText = gvoIEDebug.document.body.innerHTML
	If Err And gvaSettingsBool.Item( "LOG" ) Then
		MsgBox "Unable to read Debug results from Internet Explorer window." & vbCrLf & vbCrLf & "No data was written to a log file.", vbOKOnly + vbExclamation + vbApplicationModal, "IE Read Error"
	Else
		strLogText = objRE.Replace( strLogText, "" )
		Set objRE = Nothing
		strLogFile = gvoFSO.BuildPath( gvoFSO.GetParentFolderName( gvaSettingsStr.Item( "DEBUGLOG" ) ), gvoFSO.GetBaseName( gvaSettingsStr.Item( "DEBUGLOG" ) ) ) & "_" & gvsComputer & "_debug_" & TimeStamp( ) & ".log"
		Set objLogFile = gvoFSO.CreateTextFile( strLogFile, True )
		objLogFile.WriteLine strLogText
		objLogFile.Close
		Set objLogFile = Nothing
	End If
	On Error Goto 0
End Sub


Sub SaveSettings( )
	ConfigSaveChanges
	ConfigSaveFile
	ConfigUpdateStatus
	ShowMain
End Sub


Function SaveTabDelimited( )
	Dim objFile, strFile, strMsg, strWinPE
	SaveTabDelimited = ""
	If gvbWinPE Then
		strWinPE = ".WinPE."
	Else
		strWinPE = "."
	End If
	If gvaSettingsStr.Item( "SAVE" ) = "*" Or gvaSettingsStr.Item( "SAVE" ) = "" Then
		strFile = gvoFSO.BuildPath( gvoFSO.GetParentFolderName( Self.location.pathname ), "Hardware." & gvaDefaultsStr.Item( "COMPUTER" ) & strWinPE & TimeStamp( ) & ".txt" )
	ElseIf Right( gvaSettingsStr.Item( "SAVE" ), 2 ) = "\*" Then
		strFile = Left( gvaSettingsStr.Item( "SAVE" ), Len( gvaSettingsStr.Item( "SAVE" ) ) - 1 ) & "Hardware." & gvaDefaultsStr.Item( "COMPUTER" ) & strWinPE & TimeStamp( ) & ".txt"
	Else
		strFile = gvaSettingsStr.Item( "SAVE" )
	End If
	If InStr( gvaSettingsStr.Item( "SAVE" ), "\" ) = -1 Then
		strFile = gvoFSO.BuildPath( gvoFSO.GetParentFolderName( Self.location.pathname ), strFile )
	End If
	If strFile <> "" Then
		If Left( strFile, 1 )  = """" Then strFile = Mid( strFile, 2 )
		If Right( strFile, 1 ) = """" Then strFile = Left( strFile, Len( strFile ) - 1 )
	End If
	With gvoFSO
		If .FolderExists( .GetParentFolderName( strFile ) ) Then
			On Error Resume Next
			strFile = .GetAbsolutePathName( strFile )
			Set objFile = .CreateTextFile( strFile, True, False )
			If Err Then
				strMsg = "Error #" & Err.Number & " while trying to save the results to """ & strFile & """:"
				strMsg = strMsg & vbCrLf & Err.Description
				MsgBox strMsg, vbOKOnly, "File Save Error"
				strFile = ""
			Else
				objFile.WriteLine gvsHeader
				objFile.WriteLine gvsCSVTxt
				objFile.Close
				If Not gvbSilent Then MsgBox "File """ & strFile & """ successfully saved.", vbOKOnly, "File Saved"
			End If
			Set objFile = Nothing
			On Error Goto 0
		Else
			MsgBox "Folder """ & .GetParentFolderName( strFile ) & """ does not exist.", vbOKOnly, "File save error"
			strFile = ""
		End If
	End With
	SaveTabDelimited = strFile
End Function


Sub SetCustomColor( myDropdown )
	Dim arrCustomColors, colElements, objDropdown, objElement, objOption
	arrCustomColors = Split( gvaSettingsStr.Item( "CUSTOMCOLORS" ), ";" )
	Set objDropdown = document.getElementById( myDropdown )
	For Each objOption In objDropdown.options
		If objOption.selected Then
			Select Case myDropdown
				Case "CaptionsColor":
					document.body.style.color = objOption.value
				Case "LinksColor":
					Set colElements = document.getElementsByTagName( "a" )
					For Each objElement In colElements
						objElement.style.color = arrCustomColors(3)
					Next
					Set colElements = Nothing
				Case "ButtonFaceColor":
					Set colElements = document.getElementsByTagName( "input" )
					For Each objElement In colElements
						If objElement.type = "button" Then
							objElement.style.backgroundColor = arrCustomColors(4)
						End If
					Next
					Set colElements = Nothing
				Case "ButtonCaptionsColor":
					Set colElements = document.getElementsByTagName( "input" )
					For Each objElement In colElements
						If objElement.type = "button" Then
							objElement.style.color = arrCustomColors(5)
						End If
					Next
					Set colElements = Nothing
				Case "CodeColor":
					Set colElements = document.getElementsByTagName( "code" )
					For Each objElement In colElements
						objElement.style.color = arrCustomColors(6)
					Next
					Set colElements = Nothing
			End Select
		End If
	Next
	Set objDropdown = Nothing
End Sub


Sub SetCustomTheme( )
	Dim objOption, strCustomColors
	ThemeDefault.checked = False
	ThemeBW.checked      = False
	ThemeCustom.checked  = True
	gvaSettingsStr.Item( "THEME" ) = "ThemeCustom"
	For Each objOption In GradientTopColor.options
		If objOption.selected Then strCustomColors = objOption.value
	Next
	For Each objOption In GradientBottomColor.options
		If objOption.selected Then strCustomColors = strCustomColors & ";" & objOption.value
	Next
	For Each objOption In CaptionsColor.options
		If objOption.selected Then strCustomColors = strCustomColors & ";" & objOption.value
	Next
	For Each objOption In LinksColor.options
		If objOption.selected Then strCustomColors = strCustomColors & ";" & objOption.value
	Next
	For Each objOption In ButtonFaceColor.options
		If objOption.selected Then strCustomColors = strCustomColors & ";" & objOption.value
	Next
	For Each objOption In ButtonCaptionsColor.options
		If objOption.selected Then strCustomColors = strCustomColors & ";" & objOption.value
	Next
	For Each objOption In CodeColor.options
		If objOption.selected Then strCustomColors = strCustomColors & ";" & objOption.value
	Next
	gvaSettingsStr.Item( "CUSTOMCOLORS" ) = LCase( strCustomColors )
	ConfigUpdateStatus
End Sub


Sub ShowCredits( )
	MainScreen.style.display     = "none"
	SettingsScreen.style.display = "none"
	HelpScreen.style.display     = "none"
	CreditsScreen.style.display  = "block"
	Back.style.display           = "block"
End Sub


Sub ShowDonate( )
	gvoWSHShell.Run "http://www.robvanderwoude.com/donate.php", 7, False
End Sub


Sub ShowHelp( )
	MainScreen.style.display     = "none"
	SettingsScreen.style.display = "none"
	HelpScreen.style.display     = "block"
	CreditsScreen.style.display  = "none"
	Back.style.display           = "block"
End Sub


Sub ShowMain( )
	MainScreen.style.display     = "block"
	SettingsScreen.style.display = "none"
	HelpScreen.style.display     = "none"
	CreditsScreen.style.display  = "none"
	Back.style.display           = "none"
End Sub


Sub ShowSettings( )
	MainScreen.style.display     = "none"
	SettingsScreen.style.display = "block"
	HelpScreen.style.display     = "none"
	CreditsScreen.style.display  = "none"
	Back.style.display           = "none"
	If gvaSettingsBool.Item( "DEVTEST" ) Then
		InputDxDiag.value  = "C:\Scripts\Hardware.xml"
	End If
	If InputDxDiag.value = "" Then
		ButtonDeleteXML.disabled = True
	Else
		If gvoFSO.FileExists( InputDxDiag.value ) Then
			ButtonDeleteXML.disabled = False
		Else
			ButtonDeleteXML.disabled = True
		End If
	End If
End Sub


Sub Sleep( seconds )
	Dim objShell, strCmd
'	On Error Resume Next
	Set objShell = CreateObject( "Wscript.Shell" )
	strCmd = "%COMSPEC% /C PING -n " & seconds & " localhost > NUL 2>&1"
	objShell.Run strCmd, 0, 1
	Set objShell = Nothing
	On Error Goto 0
End Sub


Function TextFromHTML( myURL )
	Dim objHTTP
	TextFromHTML = ""
'	On Error Resume Next
	Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )
	objHTTP.Open "GET", myURL
	objHTTP.Send
	If Err Then gvbConnected = False
	' Check if the result was valid, and if so return the result
	If objHTTP.Status = 200 Then TextFromHTML = objHTTP.ResponseText
	Set objHTTP = Nothing
	On Error Goto 0
End Function


Function TimeStamp( )
	TimeStamp = Year( Now ) _
	          & Right( "0" & Month(  Now ), 2 ) _
	          & Right( "0" & Day(    Now ), 2 ) _
	          & Right( "0" & Hour(   Now ), 2 ) _
	          & Right( "0" & Minute( Now ), 2 ) _
	          & Right( "0" & Second( Now ), 2 )
End Function


Function ValidatedWindowSize( myVal )
	Dim intHeight, intWidth
	Dim objMatches, objRE
	Dim strSize, strVal
	strSize = ""
	strVal  = Trim( LCase( myVal ) )
	If strVal <> "" Then
		Set objRE = New RegExp
		objRE.Pattern = "^(\d{3,4})x(\d{3,4})$"
		If objRE.Test( strVal ) Then
			Set objMatches = objRE.Execute( strVal )
			If objMatches.Count = 1 Then
				If objMatches.Item(0).Submatches.Count = 2 Then
					intWidth  = CInt( objMatches.Item(0).Submatches(0) )
					intHeight = CInt( objMatches.Item(0).Submatches(1) )
					intWidth  = Max( intWidth,  gviMinWidth  )
					intHeight = Max( intHeight, gviMinHeight )
					intWidth  = Min( intWidth,  window.screen.width  )
					intHeight = Min( intHeight, window.screen.height )
					strSize   = CStr( intWidth ) & "x" & CStr( intHeight )
				End If
			End If
			Set objMatches = Nothing
		End If
		Set objRE = Nothing
	End If
	If intWidth = window.screen.width And intHeight = window.screen.height Then
		strSize = ""
	End If
	ValidatedWindowSize = strSize
End Function


Sub Window_Onload
	Dim blnComputer, strLine, strFile

	' Check if in WinPE
	gvbWinPE = CheckWinPE( )

	If Not IsAdmin( True ) Then
		Self.window.close
		Exit Sub
	End If

	' Initialize the program window
	AppVersion.innerHTML  = Hardware.Version
	HelpVer.innerHTML     = Hardware.Version
	CredVersion.innerHTML = Hardware.Version
	AppYear.innerHTML     = gviCopyrightsYear
	document.title = "Basic Hardware Inventory (Version " & Hardware.Version & ")  2005 - " & gviCopyrightsYear & ", Rob van der Woude"

	' Initialize the program
	Initialize ' includes read and set defaults
	ConfigReadFile
	ConfigReadCommandline
	ConfigUpdateStatus

	ButtonCopy.disabled  = True
	ButtonPaste.disabled = False
	ButtonPrint.disabled = True
	ButtonSave.disabled  = True
	If gvaSettingsBool.Item( "BASIC" ) Then
		ButtonBasic.value = "Full"
	End If
	CheckboxBIOS.Checked            = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxCDROM.Checked           = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxCPU.Checked             = True
	CheckboxHDD.Checked             = True
	CheckboxHID.Checked             = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxMainBoard.Checked       = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxMemory.Checked          = True
	CheckboxMonitor.Checked         = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxNIC.Checked             = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxPorts.Checked           = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxVideo.Checked           = Not gvaSettingsBool.Item( "BASIC" )
	CheckboxSound.Checked           = Not gvaSettingsBool.Item( "BASIC" )
	ButtonDetailsBIOS.disabled      = True
	ButtonDetailsCPU.disabled       = True
	ButtonDetailsCDROM.disabled     = True
	ButtonDetailsHDD.disabled       = True
	ButtonDetailsHID.disabled       = True
	ButtonDetailsMainBoard.disabled = True
	ButtonDetailsMemory.disabled    = True
	ButtonDetailsMonitor.disabled   = True
	ButtonDetailsNIC.disabled       = True
	ButtonDetailsPorts.disabled     = True
	ButtonDetailsSound.disabled     = True
	ButtonDetailsVideo.disabled     = True

	If InStr( gvsCommandlineUC, "/?" ) Or InStr( gvsCommandlineUC, "/HELP" ) Then ShowHelp

	window.offscreenBuffering = True

	' Tweak for Internet Explorer 7 and older versions
	gvbIE7 = IE7( )
	If gvbIE7 Then gvsTableRowStyle = "inline"

	blnComputer = CBool( InStr( gvsCommandlineUC, "/COMPUTER:" ) )
	gvbSilent   = gvaSettingsBool.Item( "COPY" ) Or gvaSettingsBool.Item( "PRINT" ) Or ( gvaSettingsStr.Item( "SAVE" ) <> "" )
	If gvbSilent Or blnComputer Then Inventory
	If gvbSilent Then
		If gvaSettingsBool.Item( "COPY" )      Then CopyToClipboard
		If gvaSettingsBool.Item( "PRINT" )     Then PrintToDefault
		If gvaSettingsStr.Item( "SAVE" ) <> "" Then strFile = SaveTabDelimited( )
		window.close
		Exit Sub
	End If

	' Start a separate thread/process for the update check
	setTimeout "CheckUpdate", 500, "VBScript"

	ComputerName.focus
End Sub


Sub Window_OnUnload
	On Error Resume Next
	' Delete DxDiag's XML file if it exists, unless /KEEPXML switch was used
	If gvaSettingsBool.Item( "DXDIAG" ) Then
		If Not gvaSettingsBool.Item( "KEEPXML" ) Then
			If Trim( gvaSettingsStr.Item( "XML" ) ) <> "" Then
				If gvoFSO.FileExists( gvaSettingsStr.Item( "XML" ) ) Then
					gvoFSO.DeleteFile gvaSettingsStr.Item( "XML" ), True
				End If
			End If
		End If
	End If
	' Save Debug log, if requested
	If gvaSettingsBool.Item( "DEBUG" ) Then
		'If gvaSettingsBool.Item( "LOG" ) Then
			SaveDebugLog
		'End If
	End If
	' Delete temporary files
	With gvoFSO
		If .FileExists( gvsDetailsFile ) Then .DeleteFile gvsDetailsFile, True
		If .FileExists( gvsPrintFile )   Then .DeleteFile gvsPrintFile,   True
	End With
	' "Gracefully" close Internet Explorer and other objects
	gvoIEDebug.Quit
	gvoIEPrint.Quit
	Set gvaCSSColors             = Nothing
	Set gvaDefaultsBool          = Nothing
	Set gvaSettingsBool          = Nothing
	Set gvaSettingsStr           = Nothing
	Set gvoIEDebug               = Nothing
	Set gvoIEPrint               = Nothing
	Set gvoFSO                   = Nothing
	Set gvoWMIService            = Nothing
	Set gvoWSHShell              = Nothing
	Set gvaTranslationsBIOS      = Nothing
	Set gvaTranslationsButtons   = Nothing
	Set gvaTranslationsCDROMs    = Nothing
	Set gvaTranslationsCPU       = Nothing
	Set gvaTranslationsGlobal    = Nothing
	Set gvaTranslationsHarddisks = Nothing
	Set gvaTranslationsHID       = Nothing
	Set gvaTranslationsMainBoard = Nothing
	Set gvaTranslationsMemory    = Nothing
	Set gvaTranslationsMonitors  = Nothing
	Set gvaTranslationsNIC       = Nothing
	Set gvaTranslationsPorts     = Nothing
	Set gvaTranslationsSettings  = Nothing
	Set gvaTranslationsSound     = Nothing
	Set gvaTranslationsVideo     = Nothing
	On Error Goto 0
End Sub


Sub WindowSize( )
	Dim intHeight, intWidth, posVertical, posHorizontal, posX
	If gvaSettingsStr.Item( "SIZE" ) = "" Then
		DebugMessage "Window Size", "Maximizing the window"
		MaximizeWindow.click ' will fail if the window lost focus
		InputSize.value = ""
		Exit Sub
	Else
		posX = InStr( LCase( gvaSettingsStr.Item( "SIZE" ) ), "x" )
		If posX > 0 Then
			intWidth  = Int( Left( gvaSettingsStr.Item( "SIZE" ), posX - 1 ) )
			intHeight = Int( Mid(  gvaSettingsStr.Item( "SIZE" ), posX + 1 ) )
		End If
		InputSize.value = gvaSettingsStr.Item( "SIZE" )
	End If
	If IsNumeric( intHeight ) And IsNumeric( intWidth ) Then
		intHeight = Min( Max( intHeight, gviMinHeight ), window.screen.height )
		intWidth  = Min( Max( intWidth,  gviMinWidth  ), window.screen.width  )
		posHorizontal = Max( 0, Int( ( window.screen.width  - intWidth  ) / 2 ) )
		posVertical   = Max( 0, Int( ( window.screen.height - intHeight ) / 2 ) )
		DebugDetailsWindow
		If intWidth <> document.body.offsetWidth Or intHeight <> document.body.offsetHeight Then
			DebugMessage "", "Resizing window to " & intWidth & "x" & intHeight
			window.resizeTo intWidth, intHeight
		End If
		If posHorizontal <> screenLeft Or posVertical <> screenTop Then
			DebugMessage "", "Moving window to " & posVertical & "," & posHorizontal & " (top, left)"
			window.moveTo posHorizontal, posVertical
		End If
	End If
End Sub
</script>

<body onhelp="vbscript:ShowHelp" onkeydown="vbscript:CheckKey">

<!-- This hidden input works together with the JavaScript function "_jsMinWin()" and the object "HHCtrlMinimizeWindowObject" to minimize the HTA window (e.g. use "MinimizeWindow.click" in VBScript) -->
<input type="hidden" name="MinimizeWindow" id="MinimizeWindow" onclick="javascript:_jsMinWin();" />

<!-- This hidden input works together with the JavaScript function "_jsMaxWin()" and the object "HHCtrlMaximizeWindowObject" to maximize the HTA window (e.g. use "MaximizeWindow.click" in VBScript) -->
<input type="hidden" name="MaximizeWindow" id="MaximizeWindow" onclick="javascript:_jsMaxWin();" />

<div align="center">

<div id="MainScreen" class="DontPrint">

<table>
<tr>
    <td><input id="ButtonPaste" class="Button" type="button" value="Paste" onclick="vbscript:PasteFromClipboard" title="Click here to paste a remote computer name from the clipboard into the Computer Name field. Then click the [Go] button to start the inventory." /></td>
    <td>&nbsp;</td>
    <td><strong>Computer:</strong></td>
    <td>&nbsp;</td>
    <td><input id="ComputerName" size="20" type="text" title="Paste or type a remote computer name, or leave this field blank to query the local computer. Then click the [Go] button to start the inventory." onkeypress="vbscript:CheckKey" /></td>
    <td>&nbsp;</td>
    <td><input id="ButtonBasic" class="Button" type="button" value="Basic" onclick="vbscript:Basic" title="Click this button to toggle between Basic and Full Inventory." accesskey="b" /></td>
    <td>&nbsp;</td>
    <td><input id="ButtonRun" class="Button" type="button" value="Go" onclick="vbscript:Inventory" title="Click here to start the inventory" accesskey="g" /></td>
</tr>
</table>

<table id="Results" class="Center">
<thead>
<tr>
    <td colspan="15">&nbsp;</td>
</tr>
</thead>
<tbody>
<tr id="CPUHeader">
    <td colspan="4">&nbsp;</td>
    <td>Number:</td>
    <td>&nbsp;&nbsp;</td>
    <td>Model:</td>
    <td>&nbsp;&nbsp;</td>
    <td>Speed (MHz):</td>
    <td>&nbsp;&nbsp;</td>
    <td>Socket:</td>
    <td>&nbsp;&nbsp;</td>
    <td class="Scores" title="This read-only field will display the Windows System Assessment Tool (WinSAT) CPU score.">Score:</td>
    <td class="Scores">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="CPURow">
    <td><input type="checkbox" id="CheckboxCPU" checked=True title="Deselect this checkbox if you want to exclude the processor(s) from the inventory." /></td>
    <td><label for="CheckboxCPU">&nbsp;&nbsp;</label></td>
    <th class="Left"><label for="CheckboxCPU">CPU<span id="MultipleCPUs" style="display: none;">s</span>:</label></th>
    <td>&nbsp;&nbsp;</td>
    <td><input type="text" id="CPUNumber" size="12" readonly title="This read-only field will display the number of (logical) processors found. For processors with hyperthreading the displayed number will be twice the number of physical processors." /></td>
    <td>&nbsp;&nbsp;</td>
    <td><input type="text" id="CPUModel"  size="40" readonly title="This read-only field will display the processor type." /></td>
    <td>&nbsp;&nbsp;</td>
    <td><input type="text" id="CPUSpeed"  size="16" readonly title="This read-only field will display the processor clock speed in MHz." /></td>
    <td>&nbsp;&nbsp;</td>
    <td><input type="text" id="CPUSocket" size="16" readonly title="This read-only field will display the processor socket type." /></td>
    <td>&nbsp;&nbsp;</td>
    <td class="Scores"><input type="text" id="CPUScore" size="3" readonly title="This read-only field will display the Windows System Assessment Tool (WinSAT) CPU score." style="text-align: right;" /></td>
    <td class="Scores">&nbsp;</td>
    <td><input id="ButtonDetailsCPU" class="Button" type="button" value=" Details " onclick="vbscript:DetailsCPU" title="Click here to display more processor details in a separate window." /></td>
</tr>
<tr id="CPUFooter">
    <td colspan="12">&nbsp;</td>
    <td class="Scores">&nbsp;</td>
    <td class="Scores">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="MemHeader">
    <td colspan="4">&nbsp;</td>
    <td>Banks:</td>
    <td>&nbsp;</td>
    <td>Modules:</td>
    <td>&nbsp;</td>
    <td>Total (MB):</td>
    <td>&nbsp;</td>
    <td colspan="2">&nbsp;</td>
    <td class="Scores" title="This read-only field will display the Windows System Assessment Tool (WinSAT) Memory Score.">Score:</td>
    <td class="Scores">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="MemRow">
    <td><input type="checkbox" id="CheckboxMemory" checked=True title="Deselect this checkbox if you want to exclude the memory from the inventory." /></td>
    <td><label for="CheckboxMemory">&nbsp;&nbsp;</label></td>
    <th class="Left"><label for="CheckboxMemory">Memory:</label></th>
    <td>&nbsp;</td>
    <td><input type="text" id="MemoryBanks"   size="12" readonly title="This read-only field will display the number of memory banks (sockets total)." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MemoryModules" size="10" readonly title="This read-only field will display the number of memory modules (sockets used)." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MemorySize"    size="16" readonly title="This read-only field will display the total amount of physical memory in MB." /></td>
    <td colspan="3">&nbsp;</td>
    <td class="Scores"><input type="text" id="MemoryScore" size="3" readonly title="This read-only field will display the Windows System Assessment Tool (WinSAT) Memory Score." style="text-align: right;" /></td>
    <td class="Scores">&nbsp;</td>
    <td><input id="ButtonDetailsMemory" class="Button" type="button" value=" Details " onclick="vbscript:DetailsMemory" title="Click here to display more memory details in a separate window." /></td>
</tr>
<tr id="MemFooter">
    <td colspan="12">&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="HardDiskHeader">
    <td colspan="4">&nbsp;</td>
    <td>Disk #:</td>
    <td>&nbsp;</td>
    <td>Model:</td>
    <td>&nbsp;</td>
    <td>Size (GB):</td>
    <td>&nbsp;</td>
    <td>Interface:</td>
    <td>&nbsp;</td>
    <td class="Scores" title="This read-only field will display the Windows System Assessment Tool (WinSAT) Disk Score.">Score:</td>
    <td class="Scores">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="HardDisk0">
    <td><input type="checkbox" id="CheckboxHDD" checked=True title="Deselect this checkbox if you want to exclude the harddisk(s) from the inventory." /></td>
    <td><label for="CheckboxHDD">&nbsp;&nbsp;</label></td>
    <th class="Left"><label for="CheckboxHDD">Harddisk<span id="MultipleHDUs" style="display: none;">s</span>:</label></th>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk0Index"     size="12" readonly title="This read-only field will display the disk number (zero based: 0...3)." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk0Model"     size="40" readonly title="This read-only field will display the harddisk model." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk0Size"      size="16" readonly title="This read-only field will display the harddisk size (capacity) in GB." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk0Interface" size="16" readonly title="This read-only field will display the harddisk's interface type (IDE/SCSI/S-ATA)." /></td>
    <td>&nbsp;</td>
    <td class="Scores"><input type="text" id="DiskScore" size="3" readonly title="This read-only field will display the Windows System Assessment Tool (WinSAT) Disk Score." style="text-align: right;" /></td>
    <td class="Scores">&nbsp;</td>
    <td><input id="ButtonDetailsHDD" class="Button" type="button" value=" Details " onclick="vbscript:DetailsHDD" title="Click here to display more harddisk details in a separate window." /></td>
</tr>
<tr id="HardDisk1" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="HardDisk1Index"     size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk1Model"     size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk1Size"      size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk1Interface" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="HardDisk2" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="HardDisk2Index"     size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk2Model"     size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk2Size"      size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk2Interface" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="HardDisk3" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="HardDisk3Index"     size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk3Model"     size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk3Size"      size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk3Interface" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="HardDisk4" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="HardDisk4Index"     size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk4Model"     size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk4Size"      size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk4Interface" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="HardDisk5" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="HardDisk5Index"     size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk5Model"     size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk5Size"      size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk5Interface" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="HardDisk6" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="HardDisk6Index"     size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk6Model"     size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk6Size"      size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk6Interface" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="HardDisk7" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="HardDisk7Index"     size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk7Model"     size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk7Size"      size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="HardDisk7Interface" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="HardDiskFooter">
    <td colspan="12">&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="CDROMHeader">
    <td colspan="4">&nbsp;</td>
    <td>Drive:</td>
    <td>&nbsp;</td>
    <td>Model:</td>
    <td>&nbsp;</td>
    <td>Firmware:</td>
    <td>&nbsp;</td>
    <td>Interface:</td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="CDROM0">
    <td><input type="checkbox" id="CheckboxCDROM" checked=True title="Deselect this checkbox if you want to exclude the CD/DVD-ROM drive(s) from the inventory." /></td>
    <td><label for="CheckboxCDROM">&nbsp;&nbsp;</label></td>
    <th class="Left"><label for="CheckboxCDROM">CDROM<span id="MultipleCDROMs" style="display: none;">s</span>:</label></th>
    <td>&nbsp;</td>
    <td><input type="text" id="CDROM0Index"     size="12" readonly title="This read-only field will display the CD/DVD-ROM drive letter." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="CDROM0Model"     size="40" readonly title="This read-only field will display the CD/DVD-ROM drive model." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="CDROM0Firmware"  size="16" readonly title="This read-only field will display the CD/DVD-ROM drive's firmware revision number." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="CDROM0Interface" size="16" readonly title="This read-only field will display the CD/DVD-ROM drive's interface type (IDE/SCSI/S-ATA)." /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td><input id="ButtonDetailsCDROM" class="Button" type="button" value=" Details " onclick="vbscript:DetailsCDROM" title="Click here to display more CD/DVD-ROM details in a separate window." /></td>
</tr>
<tr id="CDROM1" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="CDROM1Index"     size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="CDROM1Model"     size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="CDROM1Firmware"  size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="CDROM1Interface" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="CDROM2" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="CDROM2Index"     size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="CDROM2Model"     size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="CDROM2Firmware"  size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="CDROM2Interface" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="CDROM3" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="CDROM3Index"     size="12"     readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="CDROM3Model"     size="40"     readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="CDROM3Firmware"  size="16"  readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="CDROM3Interface" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="CDROMFooter">
    <td colspan="12">&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="VideoHeader">
    <td colspan="4">&nbsp;</td>
    <td>Video #:</td>
    <td>&nbsp;</td>
    <td>Model:</td>
    <td>&nbsp;</td>
    <td>Memory (MB):</td>
    <td>&nbsp;</td>
    <td>Resolution:</td>
    <td>&nbsp;</td>
    <td class="Scores" title="This read-only field will display the Windows System Assessment Tool (WinSAT) Graphics Score.">Score:</td>
    <td class="Scores">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="Video0">
    <td><input type="checkbox" id="CheckboxVideo" checked=True title="Deselect this checkbox if you want to exclude the display adapter(s) from the inventory." /></td>
    <td><label for="CheckboxVideo">&nbsp;&nbsp;</label></td>
    <th class="Left"><label for="CheckboxVideo">Video:</label></th>
    <td>&nbsp;</td>
    <td><input type="text" id="VideoIndex0"  size="12" readonly title="This read-only field will display the (logical) display adapter number (zero based)." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="VideoModel0"  size="40" readonly title="This read-only field will display the display adapter model." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="VideoMemory0" size="16" readonly title="This read-only field will display the amount of video memory in MB." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="VideoMode0"   size="16" readonly title="This read-only field will display the current video mode." /></td>
    <td>&nbsp;</td>
    <td class="Scores"><input type="text" id="GraphicsScore" size="3" readonly title="This read-only field will display the Windows System Assessment Tool (WinSAT) Graphics Score." style="text-align: right;" /></td>
    <td class="Scores">&nbsp;</td>
    <td><input id="ButtonDetailsVideo" class="Button" type="button" value=" Details " onclick="vbscript:DetailsVideo" title="Click here to display more display adapter details in a separate window." /></td>
</tr>
<tr id="Video1" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="VideoIndex1"  size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="VideoModel1"  size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="VideoMemory1" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="VideoMode1"   size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="Video2" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="VideoIndex2"  size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="VideoModel2"  size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="VideoMemory2" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="VideoMode2"   size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="Video3" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="VideoIndex3"  size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="VideoModel3"  size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="VideoMemory3" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="VideoMode3"   size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="VideoFooter">
    <td colspan="12">&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="MonitorHeader">
    <td colspan="4">&nbsp;</td>
    <td>Monitor #:</td>
    <td>&nbsp;</td>
    <td id="MonitorModelCaption">Model:</td>
    <td>&nbsp;</td>
    <td>Manufacturer:</td>
    <td>&nbsp;</td>
    <td>Serial #:</td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="Monitor0">
    <td><input type="checkbox" id="CheckboxMonitor" checked=True title="Deselect this checkbox if you want to exclude the monitor(s) from the inventory." /></td>
    <td><label for="CheckboxMonitor">&nbsp;&nbsp;</label></td>
    <th class="Left"><label for="CheckboxMonitor">Monitor<span id="MultipleMonitors" style="display: none;">s</span>:</labe></th>
    <td>&nbsp;</td>
    <td><input type="text" id="MonitorIndex0"        size="12" readonly title="This read-only field will display the monitor number (zero based)." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MonitorModel0"        size="40" readonly title="This read-only field will display the monitor model." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MonitorManufacturer0" size="16" readonly title="This read-only field will display the monitor manufacturer." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MonitorSerial0"       size="16" readonly title="This read-only field will display the monitor serial number." /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td><input id="ButtonDetailsMonitor" class="Button" type="button" value=" Details " onclick="vbscript:DetailsMonitor" title="Click here to display more monitor details in a separate window." /></td>
</tr>
<tr id="Monitor1" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="MonitorIndex1"        size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MonitorModel1"        size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MonitorManufacturer1" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MonitorSerial1"       size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="Monitor2" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="MonitorIndex2"        size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MonitorModel2"        size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MonitorManufacturer2" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MonitorSerial2"       size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="Monitor3" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="MonitorIndex3"        size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MonitorModel3"        size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MonitorManufacturer3" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MonitorSerial3"       size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="MonitorFooter">
    <td colspan="12">&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="SoundHeader">
    <td colspan="6">&nbsp;</td>
    <td>Model:</td>
    <td>&nbsp;</td>
    <td>Manufacturer:</td>
    <td colspan="3">&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="SoundRow">
    <td><input type="checkbox" id="CheckboxSound" checked=True title="Deselect this checkbox if you want to exclude the sound card from the inventory." /></td>
    <td><label for="CheckboxSound">&nbsp;</label></td>
    <th class="Left"><label for="CheckboxSound">Sound:</label></th>
    <td colspan="3">&nbsp;</td>
    <td><input type="text" id="SoundCardModel" size="40" readonly title="This read-only field will display the sound card model." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="SoundCardManufacturer" size="16" readonly title="This read-only field will display the name of the sound card manufacturer." /></td>
    <td colspan="3">&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td><input id="ButtonDetailsSound" class="Button" type="button" value=" Details " onclick="vbscript:DetailsSound" title="Click here to display more sound card details in a separate window." /></td>
</tr>
<tr id="SoundFooter">
    <td colspan="12">&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="NICHeader">
    <td colspan="4">&nbsp;</td>
    <td>NIC #:</td>
    <td>&nbsp;</td>
    <td>Model:</td>
    <td>&nbsp;</td>
    <td>MAC Address:</td>
    <td>&nbsp;</td>
    <td>Speed:</td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="NIC0">
    <td><input type="checkbox" id="CheckboxNIC" checked=True title="Deselect this checkbox if you want to exclude the network adapter(s) from the inventory." /></td>
    <td><label for="CheckboxNIC">&nbsp;&nbsp;</label></td>
    <th class="Left"><label for="CheckboxNIC">NIC<span id="MultipleNICs" style="display: none;">s</span>:</label></th>
    <td>&nbsp;</td>
    <td><input type="text" id="NICIndex0"   size="12" readonly title="This read-only field will display the network adapter number (zero based: 0...3)." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="NICModel0"   size="40" readonly title="This read-only field will display the network adapter model." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MACAddress0" size="16" readonly title="This read-only field will display the network adapter's MAC address." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="NICSpeed0"   size="16" readonly title="This read-only field will display the network adapter's link speed in kB/s." /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td><input id="ButtonDetailsNIC" class="Button" type="button" value=" Details " onclick="vbscript:DetailsNIC" title="Click here to display more network adapter details in a separate window." /></td>
</tr>
<tr id="NIC1" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="NICIndex1"   size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="NICModel1"   size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MACAddress1" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="NICSpeed1"   size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="NIC2" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="NICIndex2"   size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="NICModel2"   size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MACAddress2" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="NICSpeed2"   size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="NIC3" style="display: none;">
    <td colspan="4">&nbsp;</td>
    <td><input type="text" id="NICIndex3"   size="12" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="NICModel3"   size="40" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MACAddress3" size="16" readonly /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="NICSpeed3"   size="16" readonly /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="NICFooter">
    <td colspan="12">&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="MainBoardHeader">
    <td colspan="4">&nbsp;</td>
    <td>Chassis:</td>
    <td>&nbsp;</td>
    <td>Model:</td>
    <td>&nbsp;</td>
    <td>Manufacturer:</td>
    <td>&nbsp;</td>
    <td>Version:</td>
    <td>&nbsp;</td>
    <td class="Scores" title="This read-only field will display the Windows System Assessment Tool (WinSAT) Total Score for the computer.">Score:</td>
    <td class="Scores">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="MainBoardRow">
    <td><input type="checkbox" id="CheckboxMainBoard" checked=True title="Deselect this checkbox if you want to exclude the main board and system enclosure from the inventory." /></td>
    <td><label for="CheckboxMainBoard">&nbsp;</label></td>
    <th class="Left"><label for="CheckboxMainBoard">Main Board:</label></th>
    <td>&nbsp;</td>
    <td><input type="text" id="ChassisType"    size="12" readonly title="This read-only field will display the computer's chassis type." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MBModel"        size="40" readonly title="This read-only field will display the main board type." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MBManufacturer" size="16" readonly title="This read-only field will display the name of the main board manufacturer." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MBVersion"      size="16" readonly title="This read-only field will display the main board version." /></td>
    <td>&nbsp;</td>
    <td class="Scores"><input type="text" id="WinSATScore" size="3" readonly title="This read-only field will display the Windows System Assessment Tool (WinSAT) Total Score for the computer." style="text-align: right;" /></td>
    <td class="Scores">&nbsp;</td>
    <td><input id="ButtonDetailsMainBoard" class="Button" type="button" value=" Details " onclick="vbscript:DetailsMainBoard" title="Click here to display more main board and system enclosure details." /></td>
</tr>
<tr id="MainBoardFooter">
    <td colspan="12">&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="HIDHeader">
    <td colspan="4">&nbsp;</td>
    <td>Mouse Type:</td>
    <td>&nbsp;</td>
    <td>Mouse Model:</td>
    <td>&nbsp;</td>
    <td>Keyboard Type:</td>
    <td>&nbsp;</td>
    <td>Keyboard Model:</td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="HIDRow">
    <td><input type="checkbox" id="CheckboxHID" checked=True title="Deselect this checkbox if you want to exclude the mouse and keyboard from the inventory." /></td>
    <td><label for="CheckboxHID">&nbsp;</label></td>
    <th class="Left"><label for="CheckboxHID">HID:</label></th>
    <td>&nbsp;</td>
    <td><input type="text" id="MouseType"  size="12" readonly title="This read-only field will display the mouse type." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="MouseModel" size="40" readonly title="This read-only field will display the mouse model." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="KbdType"    size="16" readonly title="This read-only field will display the keyboard type." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="KbdModel"   size="16" readonly title="This read-only field will display the keyboard model." /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td><input id="ButtonDetailsHID" class="Button" type="button" value=" Details " onclick="vbscript:DetailsHID" title="Click here to display more mouse and keyboard details." /></td>
</tr>
<tr id="HIDFooter">
    <td colspan="12">&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="PortsHeader">
    <td colspan="4">&nbsp;</td>
    <td>USB Ports:</td>
    <td>&nbsp;</td>
    <td>System Slots:</td>
    <td>&nbsp;</td>
    <td>Parallel Ports:</td>
    <td>&nbsp;</td>
    <td>Serial Ports:</td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="PortsRow">
    <td><input type="checkbox" id="CheckboxPorts" checked=True title="Deselect this checkbox if you want to exclude the ports summary from the inventory." /></td>
    <td><label for="CheckboxPorts">&nbsp;</label></td>
    <th class="Left"><label for="CheckboxPorts">Ports:</label></th>
    <td>&nbsp;</td>
    <td><input type="text" id="USB"      size="12" readonly title="This read-only field will tell if USB is supported." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="Slots"    size="40" readonly title="This read-only field will display the number and types of system slots (AGP/PCI)." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="Parallel" size="16" readonly title="This read-only field will display the number of parallel ports." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="Serial"   size="16" readonly title="This read-only field will display the number of serial ports." /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td><input id="ButtonDetailsPorts" class="Button" type="button" value=" Details " onclick="vbscript:DetailsPorts" title="Click here to display more details on the available ports." /></td>
</tr>
<tr id="PortsFooter">
    <td colspan="12">&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="BIOSHeader">
    <td colspan="4">&nbsp;</td>
    <td>Manufacturer:</td>
    <td>&nbsp;</td>
    <td>Model:</td>
    <td>&nbsp;</td>
    <td>Version:</td>
    <td>&nbsp;</td>
    <td>Date:</td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id="BIOSRow">
    <td><input type="checkbox" id="CheckboxBIOS" checked=True title="Deselect this checkbox if you want to exclude the BIOS from the inventory." /></td>
    <td><label for="CheckboxBIOS">&nbsp;</label></td>
    <th class="Left"><label for="CheckboxBIOS">BIOS:</label></th>
    <td>&nbsp;</td>
    <td><input type="text" id="BIOSManufacturer" size="12" readonly title="This read-only field will display the name of the BIOS manufacturer." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="BIOSModel"        size="40" readonly title="This read-only field will display the BIOS description." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="BIOSVersion"      size="16" readonly title="This read-only field will display the BIOS version number." /></td>
    <td>&nbsp;</td>
    <td><input type="text" id="BIOSDate"         size="16" readonly title="This read-only field will display the BIOS release date." /></td>
    <td>&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td><input id="ButtonDetailsBIOS" class="Button" type="button" value="Details" onclick="vbscript:DetailsBIOS" title="Click here to display more BIOS details." /></td>
</tr>
<tr id="BIOSFooter">
    <td colspan="12">&nbsp;</td>
    <td class="Scores" colspan="2">&nbsp;</td>
    <td>&nbsp;</td>
</tr>
</tbody>
</table>

<div style="height: 0.5em;"></div>

<table>
<tr>
    <td><input id="ButtonCopy"     class="Button" type="button" value="Copy"    onclick="vbscript:CopyToClipboard"  title="Click here to copy the results to the clipboard. The data in the clipboard will be in tab delimited format. Paste the data in a spreadsheet, using tab as the only delimiter, to create reports." /></td>
    <td>&nbsp;</td>
    <td><input id="ButtonSave"     class="Button" type="button" value="Save"    onclick="vbscript:SaveTabDelimited" title="Click here to save the results, in tab delimited format, to a file." /></td>
    <td>&nbsp;</td>
    <td><input id="ButtonPrint"    class="Button" type="button" value="Print"   onclick="vbscript:PrintPreview"     title="Click here to print the results."                  accesskey="p" /></td>
    <td>&nbsp;</td>
    <td><input id="ButtonHelp"     class="Button" type="button" value="Help"    onclick="vbscript:ShowHelp"         title="Click this button to display the Command Line Help." /></td>
    <td>&nbsp;</td>
    <td><input id="ButtonCredits"  class="Button" type="button" value="Credits" onclick="vbscript:ShowCredits"      title="Click this button to display the Credits window."  accesskey="c" /></td>
    <td>&nbsp;</td>
    <td><input id="ButtonSettings" class="Button" type="button" value="Settings" onclick="vbscript:ShowSettings"    title="Click this button to change the program settings." accesskey="s" /></td>
</tr>
</table>

</div><!-- end of "MainScreen" -->



<div id="SettingsScreen" style="display: none; max-width: 100%;" class="DontPrint">

<h1>Settings</h1>

<table>
<tr>
	<td>&nbsp;</td>
	<td class="Left Nowrap">Configuration file content</td>
	<td class="Left" id="DisplayConfig"></td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td class="Left Nowrap">Command Line</td>
	<td class="Left" id="DisplayCommandLine"></td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td class="Left Nowrap">Window size (width x height)</td>
	<td class="Left"><input type="text" id="InputSize" size="30" /></td>
</tr>
<tr title="Select to use DMIDecode for retrieving more detailed information about the local computer (ignored for remote computers or if DMIDecode.exe is not found in the PATH).">
	<td><input type="checkbox" id="CheckboxDMIDecode" onclick="vbscript:OnClick_CheckboxDMIDecode" /></td>
	<td class="Left" colspan="2"><label for="CheckboxDMIDecode">Use <a href="http://www.nongnu.org/dmidecode/">DMIDecode</a> for more details</label></td>
</tr>
<tr title="Select to use DxDiag for retrieving more detailed information about the local computer (ignored for remote computers).">
	<td><input type="checkbox" id="CheckboxDxDiag" onclick="vbscript:OnClick_CheckboxDxDiag" /></td>
	<td class="Left" colspan="2"><label for="CheckboxDxDiag">Use DxDiag for more details</label></td>
</tr>
<tr id="TablerowKeepXML" style="display: none; visibility: collapse;" title="Select to keep DxDiag's results to speed up the inventory next time.">
	<td>&nbsp;</td>
	<td class="Left Nowrap"><input type="checkbox" id="CheckboxKeepXML" />&nbsp;<label for="CheckboxKeepXML">Keep DxDiag's XML file</label></td>
	<td class="Left"><input class="Button" type="button" id="ButtonDeleteXML" value="Delete XML" onclick="vbscript:DeleteDxDiagXML" /></td>
</tr>
<tr id="TablerowDxDiagPath" style="display: none; visibility: collapse;">
	<td>&nbsp;</td>
	<td class="Left Nowrap" style="text-indent: 1.75em;">Path to DxDiag's XML file</td>
	<td class="Left"><input type="text" id="InputDxDiag" size="30" /></td>
</tr>
<tr title="Select to include USB storage devices.">
	<td><input type="checkbox" id="CheckboxUSBSTOR" /></td>
	<td class="Left" colspan="2"><label for="CheckboxUSBSTOR">Include USB storage devices</label></td>
</tr>
<tr title="Select to display physical screen dimensions as height and width in centimeters, instead of the diagonal in inches.">
	<td><input type="checkbox" id="CheckboxCM" /></td>
	<td class="Left" colspan="2"><label for="CheckboxCM">Show screen width and height in centimeters instead of the diagonal in inches</label></td>
</tr>
<tr title="Deselect to skip the WinSAT scores.">
	<td><input type="checkbox" id="CheckboxScores" checked /></td>
	<td class="Left" colspan="2"><label for="CheckboxScores">Show WinSAT scores</label></td>
</tr>
<tr title="Select to display arrays of numbers in the details windows as interpreted text too.">
	<td><input type="checkbox" id="CheckboxCharacterChains" /></td>
	<td class="Left" colspan="2" title="E.g.:
Property (array) : 83,121,110,99,77,97,115,116,101,114,0
Property (string): SyncMaster
Note that not all arrays of numbers are intended to be interpreted as text, so the string may sometimes be 'jiberish'.
For this reason, property names containing 'Capability' or 'Characteristic' (or their plural forms) are excluded, as they consist of arrays of numbers NOT representing text."><label for="CheckboxCharacterChains">Show arrays of characters in details windows as text too</label></td>
</tr>
<tr title="Deselect to use Internet Explorer for results and print previews.">
	<td><input type="checkbox" id="CheckboxDefaultBrowser" /></td>
	<td class="Left" colspan="2"><label for="CheckboxDefaultBrowser">Use default browser instead of IE</label></td>
</tr>
<tr title="Select to run this HTA in Debug mode.">
	<td><input type="checkbox" id="CheckboxDebugMode" /></td>
	<td class="Left" colspan="2"><label for="CheckboxDebugMode">Enable Debug mode</label></td>
</tr>
<tr id="TablerowDebugLog" style="display: none; visibility: collapse;">
	<td>&nbsp;</td>
	<td class="Left Nowrap">Path to debug log file</td>
	<td class="Left"><input type="text" id="InputDebugLogPath" size="30" disabled /></td>
</tr>
<tr title="Deselect to skip the check for program updates at startup.">
	<td><input type="checkbox" id="CheckboxCheckUpd" checked /></td>
	<td class="Left" colspan="2"><label for="CheckboxCheckUpd">Check for updates at startup</label></td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td colspan="2">Theme:</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td class="Left" colspan="2"><input type="radio" name="Theme" value="Default" id="ThemeDefault" checked /><label for="ThemeDefault">Default (blue to black gradient background)</label></td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td class="Left" colspan="2"><input type="radio" name="Theme" value="BW"      id="ThemeBW" /><label for="ThemeBW">Black and White (solid white background)</label></td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td class="Left" colspan="2"><input type="radio" name="Theme" value="Red"     id="ThemeRed" /><label for="ThemeRed">Reds (red to dark red gradient background)</label></td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td class="Left" colspan="2"><input type="radio" name="Theme" value="Custom"  id="ThemeCustom" /><label for="ThemeCustom">Custom gradient background</label></td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td class="Left Nowrap" style="padding-left: 2em;">Gradient top color</td>
	<td class="Left"><select id="GradientTopColor" onchange="vbscript:SetCustomTheme"></select></td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td class="Left Nowrap" style="padding-left: 2em;">Gradient bottom color</td>
	<td class="Left"><select id="GradientBottomColor" onchange="vbscript:SetCustomTheme"></select></td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td class="Left Nowrap" style="padding-left: 2em;">Captions color</td>
	<td class="Left"><select id="CaptionsColor" onchange="vbscript:SetCustomTheme"></select></td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td class="Left Nowrap" style="padding-left: 2em;">Links color (<a href="#" onclick="javascript:return false;">example</a>)</td>
	<td class="Left"><select id="LinksColor" onchange="vbscript:SetCustomTheme"></select></td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td class="Left Nowrap" style="padding-left: 2em;">Button background color</td>
	<td class="Left"><select id="ButtonFaceColor" onchange="vbscript:SetCustomTheme"></select></td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td class="Left Nowrap" style="padding-left: 2em;">Button text color</td>
	<td class="Left"><select id="ButtonCaptionsColor" onchange="vbscript:SetCustomTheme"></select></td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td class="Left Nowrap" style="padding-left: 2em;">Command help color (<code>example</code>)</td>
	<td class="Left"><select id="CodeColor" onchange="vbscript:SetCustomTheme"></select></td>
</tr>
</table>

<p class="Center">
<input id="ButtonSaveCfg" class="Button" type="button" value="Save"   onclick="vbscript:SaveSettings" />
&nbsp;
<input id="ButtonEditCfg" class="Button" type="button" value="Edit"   onclick="vbscript:EditSettings" accesskey="e" />
&nbsp;
<input id="ButtonReset"   class="Button" type="button" value="Reset"  onclick="vbscript:ConfigReset" />
&nbsp;
<input id="ButtonCancel"  class="Button" type="button" value="Cancel" onclick="vbscript:ShowMain" />
</p>

<p>&nbsp;</p>

</div><!-- end of "SettingsScreen" area -->



<div id="HelpScreen" style="max-width: 900px; display: none;" class="DontPrint">

<h1>Basic Hardware Inventory, Version <span id="HelpVer">0.00</span></h1>

<p>Get a basic hardware inventory of any WMI enabled computer on the network</p>

<table class="Left" style="font-size: 10pt;">
<tr>
	<td><strong>Usage:</strong></td>
	<td>&nbsp;</td>
	<td colspan="3"><code>HARDWARE.HTA  [ options ]  [ switches ]</code></td>
</tr>
<tr>
	<td colspan="5">&nbsp;</td>
</tr>
<tr>
	<td><strong>Options:</strong></td>
	<td>&nbsp;</td>
	<td colspan="3">These parameters can be set in the configuration file as well as on the command line (in case of conflicts, command line options prevail)</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/CHAIN</code></td>
	<td>&nbsp;</td>
	<td>Experimental: In details windows, if a property value consists of an array of (character) numbers, show the <em>array</em> as well as the <em>interpreted text</em>; e.g.<br />
		<code style="font-size: 80%;">PropertyValue (array) : 83,121,110,99,77,97,115,116,101,114,0,0,0<br />
		PropertyValue (string): SyncMaster</code><br />
		Note that not all arrays of numbers are intended to be interpreted as text, so the string may sometimes be "jiberish".
		For this reason, property names containing "Capability" or "Characteristic" (or their plural forms) are excluded, as they consist of arrays of numbers <em>not</em> representing text.</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/CM</code></td>
	<td>&nbsp;</td>
	<td>Display monitor dimensions in centimeters instead of diagonal in inches (only in Windows Vista and later)</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td colspan="3"><code>/CUSTOMCOLORS:<em>gradienttop</em>;<em>gradientbottom</em>;<em>captions</em>;<em>links</em>;<em>buttonface</em>;<em>buttontext</em>;<em>commands</em></code></td>
</tr>
<tr>
	<td colspan="4">&nbsp;</td>
	<td>Set colors for the background gradient top and bottom, body text, links, button faces, button text, and this help screen's command code (valid with <code>/THEME:Custom</code> only); for valid colors, check the dropdowns in the Settings screen or visit <a href="http://www.w3schools.com/colors/colors_names.asp">W3Schools' list of HTML colors</a></td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/DEBUG</code></td>
	<td>&nbsp;</td>
	<td>Debug mode: list settings during startup process in a separate Internet Explorer window</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/DMIDECODE</code></td>
	<td>&nbsp;</td>
	<td>Use <a href="http://www.nongnu.org/dmidecode/">DMIDecode.exe</a> to retrieve DMI/SMBIOS details (more information than WMI for memory, but requires third party software, and gathers information for <em>local computer only</em>)</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/DXDIAG</code></td>
	<td>&nbsp;</td>
	<td>Use DxDiag.exe to retrieve sound devices, video controllers and system data (more reliable than WMI for video and sound, but <em>slow</em>, and gathers information for <em>local computer only</em>)</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/KEEPXML</code></td>
	<td>&nbsp;</td>
	<td>Reuse existing DxDiag data saved in XML, if it exists, and do not delete the XML file when terminating the program (requires <code>/DXDIAG</code>)</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/NOIE</code></td>
	<td>&nbsp;</td>
	<td>Use temporary files and the default browser to display detailed query results, print previews and debugging info, instead of using Internet Explorer automation</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/NOUPD</code></td>
	<td>&nbsp;</td>
	<td>Skip check for updates at startup</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/NOSCORES</code></td>
	<td>&nbsp;</td>
	<td>Do not display Windows System Assessment Tool (WinSAT) scores</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/SIZE:<em>W</em>x<em>H</em></code></td>
	<td>&nbsp;</td>
	<td>Center window and resize to <em>W</em> x <em>H</em> pixels</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/THEME:<em>theme</em></code></td>
	<td>&nbsp;</td>
	<td>Change the window background and text colors; <code><em>theme</em></code> can be <code>BW</code> (Black and White), <code>Custom</code> (requires <code>/CUSTOMCOLORS:<em>customcolors</em></code>), or <code>Default</code></td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/USBSTOR</code></td>
	<td>&nbsp;</td>
	<td>Include USB drives in the harddisks list</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/XML:<em>xmlfile</em></code></td>
	<td>&nbsp;</td>
	<td>Location where DxDiag results will be stored; if <em>xmlfile</em> is not specified, "Hardware.xml" in the current directory will be used (requires <code>/DXDIAG</code> and <code>/KEEPXML</code>)</td>
</tr>
<tr>
	<td colspan="5">&nbsp;</td>
</tr>
<tr>
	<td><strong>Switches:</strong></td>
	<td>&nbsp;</td>
	<td colspan="3">These parameters can be set on the command line only</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/?</code> or <code>/HELP</code></td>
	<td>&nbsp;</td>
	<td>Show this message</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/BASIC</code></td>
	<td>&nbsp;</td>
	<td>Very basic inventory (CPU, memory, HDD)</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/COMPUTER:<em>computername</em></code></td>
	<td>&nbsp;</td>
	<td>Specify computer to be queried (starts inventory immediately)</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/COPY</code></td>
	<td>&nbsp;</td>
	<td>Copy results to clipboard and close program (starts inventory immediately, and terminates program when results are copied)</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/NOADMIN</code></td>
	<td>&nbsp;</td>
	<td>Skip the test for elevated privileges, just assume privileges are sufficient</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/PRINT</code></td>
	<td>&nbsp;</td>
	<td>Print the results to the default printer (starts inventory immediately, and terminates program when results are printed)</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td><code>/SAVE:<em>filename</em></code></td>
	<td>&nbsp;</td>
	<td>Save tab delimited results; if <em>filename</em> is not specified or equals "*", "Hardware.<em>computername</em>.<em>timestamp</em>.txt" in the HTA's parent folder will be used; if <em>filename</em> is a folder followed by "\*", "Hardware.<em>computername</em>.<em>timestamp</em>.txt" in the specified folder will be used (starts inventory immediately, and terminates program <em>if</em> and <em>when</em> results are written to file)</td>
</tr>
<tr>
	<td colspan="5">&nbsp;</td>
</tr>
<tr>
	<td><strong>Notes:</strong></td>
	<td>&nbsp;</td>
	<td colspan="3">At startup, the program looks for a file named "Hardware.cfg" in its working directory.
        If it finds it, it will apply its settings first.<br />
        Next, the command line settings are applied.
        In case of conflicts, the command line parameters will prevail.<br />
        Use the "Settings" button to create or edit "Hardware.cfg".<br />
        "Hardware.cfg" might look like this:<br />
        <code>/DMIDecode /DxDiag /KeepXML /USBStor</code></td>
</tr>
<tr>
	<td colspan="5">&nbsp;</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td colspan="3">If the program detects that it runs in a WinPE environment, neither DxDiag nor DMIDecode can be used.<br />
		In that case, the switches <code>/DMIDecode</code>, <code>/DxDiag</code>, <code>/KeepXML</code> and <code>/XML</code> will all be ignored.<br />
		The switch <code>/NOADMIN</code> will not be required in a WinPE environment, as the program will have admin privileges by default in WinPE.<br />
		Note that WMI results in a WinPE environment WMI may be different from the ones returned in a "normal" Windows environment.</td>
</tr>
<tr>
	<td colspan="5">&nbsp;</td>
</tr>
<tr>
	<td><strong>Examples:</strong></td>
	<td>&nbsp;</td>
	<td colspan="3"><code>HARDWARE.HTA /Size:1024x768 /DMIDecode /DxDiag /KeepXML /USBStor</code></td>
</tr>
<tr>
	<td colspan="5">&nbsp;</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td colspan="3"><code>HARDWARE.HTA /NoUpd /DMIDecode /DxDiag /Save:%ComputerName%_Full_Inventory.txt</code></td>
</tr>
<tr>
	<td colspan="5">&nbsp;</td>
</tr>
<tr>
	<td colspan="2">&nbsp;</td>
	<td colspan="3"><code>HARDWARE.HTA /NoUpd /Basic /Computer:REMOTEPC /Save:REMOTEPC_Basic_Inventory.txt</code></td>
</tr>
<tr>
	<td colspan="5">&nbsp;</td>
</tr>
<tr>
	<td><strong>Keyboard:</strong></td>
	<td>&nbsp;</td>
	<td colspan="3">Besides Windows' standard "global" keyboard shortcuts, this HTA supports the following keyboard shortcuts:</td>
</tr>
<tr>
	<td colspan="5">&nbsp;</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><code>F1</code></td>
	<td>&nbsp;</td>
	<td><strong>Help</strong></td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><code>Backspace</code></td>
	<td>&nbsp;</td>
	<td><strong>Back</strong> to Main window (only when in Help or Credits window)</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><code>Esc</code></td>
	<td>&nbsp;</td>
	<td><strong>Back</strong> to Main window (only when in Settings, Help or Credits window)</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><code>Alt+B</code></td>
	<td>&nbsp;</td>
	<td>Select <strong><u>B</u>asic</strong> inventory</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><code>Alt+C</code></td>
	<td>&nbsp;</td>
	<td><strong><u>C</u>redits</strong></td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><code>Alt+D</code></td>
	<td>&nbsp;</td>
	<td>Toggle <strong><u>D</u>ebug</strong> mode on/off (best started with <code>/DEBUG</code> command line switch)</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><code>Alt+E</code></td>
	<td>&nbsp;</td>
	<td><strong><u>E</u>dit</strong> the configuration file (in Settings screen only)</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><code>Alt+F</code></td>
	<td>&nbsp;</td>
	<td>Select <strong><u>F</u>ull</strong> inventory</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><code>Alt+G</code></td>
	<td>&nbsp;</td>
	<td><strong><u>G</u>o</strong> (start the inventory)</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><code>Alt+N</code></td>
	<td>&nbsp;</td>
	<td><strong>Mi<u>n</u>imize</strong> the HTA (main) window</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><code>Alt+P</code></td>
	<td>&nbsp;</td>
	<td><strong>Print <u>P</u>review</strong> (output in black and white)</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><code>Alt+R</code></td>
	<td>&nbsp;</td>
	<td><strong><u>R</u>eset</strong> main window (only <em>after</em> running the inventory)</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><code>Alt+S</code></td>
	<td>&nbsp;</td>
	<td><strong><u>S</u>ettings</strong></td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><code>Alt+W</code></td>
	<td>&nbsp;</td>
	<td>Add current <strong><u>W</u>indow</strong> size and position to the Debug output window (Internet Explorer)</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><code>Alt+X</code></td>
	<td>&nbsp;</td>
	<td><strong>Ma<u>x</u>imize</strong> the HTA (main) window</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><code>Ctrl+P</code></td>
	<td>&nbsp;</td>
	<td><strong><u>P</u>rint</strong> (output in the HTA's screen colors)</td>
</tr>
</table>

<p>&nbsp;</p>

<p class="Left">If you like this program, why not show your appreciation by making a donation?</p>

<p class="Left">Click <input type="button" class="Button" value="Donate" onclick="vbscript:ShowDonate" /> or navigate to <a href="http://www.robvanderwoude.com/donate.php">http://www.robvanderwoude.com/donate.php</a></p>

<p class="Left">Your support is highly appreciated.</p>

<p>&nbsp;</p>

</div><!-- end of "HelpScreen" area -->



<div id="CreditsScreen" style="max-width: 800px; display: none;" class="DontPrint">

<h1>Credits</h1>

<h2>Basic Hardware Inventory, Version <span id="CredVersion">0.00</span></h2>

<p>&nbsp;</p>

<div class="Left">

<p>This program in its current state could not have been created without the help of others.<br />
Thanks to all the people involved, whether mentioned here or not.</p>

<p>The program was created using the Microsoft Scripting Guys' <a href="http://www.microsoft.com/technet/scriptcenter/tools/scripto2.mspx">Scriptomatic 2.0</a> and <a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=231D8143-F21B-4707-B583-AE7B9152E6D9">HTA Helpomatic</a> tools, and Adersoft's <a href="http://www.htaedit.com/">HTAEdit</a>.</p>

<p>The Chassis routine was based on a <a href="http://www.computerperformance.co.uk/ezine/ezine94.htm">script by Guy Thomas</a>.</p>

<p>The HandleClass routine was based on the Microsoft TechNet ScriptCenter article <a href="http://www.microsoft.com/technet/scriptcenter/resources/guiguy/default.mspx">Scripting Eye for the GUI Guy</a>.</p>

<p>The code to <a href="http://quiome.blogspot.nl/search/label/how-to%20minimize%20chromeless%20HTA%20window">maximize the window using JavaScript</a> was based on Josh D'Alessio's.</p>

<p>WinPE detection was based on a <a href="http://techgenix.com/HowtodetectwhetheryouareinWindowsPE/">tip by Mitch Tulloch</a>.</p>

<p>The code to <a href="http://www.sccmog.com/get-current-old-machine-name-winpe-vbscript/">find the computer name in WinPE</a> was based on Richie Schuster's.</p>

<p>Steve Robertson thoroughly tested the program and sent me many bug reports, fixes, and suggestions for improvements.</p>

<p>Gary Johnson suggested to use DxDiag for video properties, and he also assisted in testing the DxDiag feature.</p>

<p>Russell J. Wiley contributed a solution to always open spawned Internet Explorer windows (used for print and debug dialogs and detailed WMI query results) in the foreground.</p>

<p>DMI (SMBIOS) details for the local computer are retrieved by <a href="http://gnuwin32.sourceforge.net/packages/dmidecode.htm">DMIDecode for Windows</a>, if installed.</p>

<p>&nbsp;</p>

<p>If you like this program, why not show your appreciation by making a donation?</p>

<p>Click <input type="button" class="Button" value="Donate" onclick="vbscript:ShowDonate" /> or navigate to <a href="http://www.robvanderwoude.com/donate.php">http://www.robvanderwoude.com/donate.php</a></p>

<p class="Left">Your support is highly appreciated.</p>

</div><!-- end of left alignment -->

<p>&nbsp;</p>

</div><!-- end of "CreditsScreen" area -->



<div id="PrintScreen" class="PrintOnly">
<p>This field will contain the results of the last inventory; it is used for "fast" printing with Ctrl+P only.</p>
</div><!-- end of "PrintScreen" area -->



<div class="DontPrint">

<p>Basic Hardware Inventory,&nbsp; Version <span id="AppVersion">0.00</span><br />
<span style="font-size: 80%;">&copy; 2005 - <span id="AppYear">2016</span>, Rob van der Woude<br />
<a href="http://www.robvanderwoude.com/hardware.php">http://www.robvanderwoude.com/hardware.php</a></span></p>

<p>&nbsp;</p>

<p id="Back" style="display: none;"><input type="button" class="Button" value="Back" onclick="vbscript:ShowMain" /></p>

<p>&nbsp;</p>

</div><!-- end of "DontPrint" area -->

</div><!-- end of centered text -->

</body>
</html>