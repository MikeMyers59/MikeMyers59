function getHeaderItems(){if(null!=_spPageContextInfo&&window.location==window.parent.location){_spPageContextInfo.webAbsoluteUrl==location.protocol+"//"+location.host&&(n=_spPageContextInfo.userId,a=get_formatted_now()+365,document.cookie="home-usernum ="+n+"; expires="+a+";secure; path=/");var t=new SP.ClientContext("/"),e=t.get_web(),i=new SP.ClientContext("/dept/hro"),r=i.get_web().get_lists().getByTitle("Job Announcements"),s=new SP.CamlQuery;s.set_viewXml("<query> \t\t\t\t<Query>                                 \t<Where>                                     \t\t<And>                                         \t\t<Gt>                                             \t\t\t<FieldRef Name='Modified'></FieldRef>                                             \t\t\t<Value Type='DateTime' IncludeTimeValue='TRUE'>"+get_last_read_jobs()+"</Value>                                         \t\t</Gt>                                         \t\t<And>                                             \t\t\t<Geq>                                                 \t\t\t<FieldRef Name='DateClosed'></FieldRef>                                                 \t\t\t<Value Type='DateTime' IncludeTimeValue='FALSE'><Today /></Value>                                             \t\t\t</Geq>                                             \t\t\t<Leq>                                                 \t\t\t<FieldRef Name='DateOpen'></FieldRef>                                                 \t\t\t<Value Type='DateTime' IncludeTimeValue='FALSE'><Today /></Value>                                             \t\t\t</Leq>                                         \t\t</And>                                     \t\t</And>                                 \t</Where>                             </Query> \t\t\t</query>\t\t\t<viewFields>                            <ViewFields>                                 <FieldRef Name='Modified' />                             </ViewFields> \t\t\t</viewFields>"),this.jobs_collListItem=r.getItems(s),i.load(jobs_collListItem);var n=e.get_lists().getByTitle("News You Can Use"),a=new SP.CamlQuery;return a.set_viewXml("<query>                             <Query>                                 <Where>                                     <And>                                         <And>                                             <And> \t\t\t\t\t\t<Leq>                                                 \t<FieldRef Name='Begins'></FieldRef>                                                 \t<Value Type='DateTime' IncludeTimeValue='FALSE'><Today /></Value>                                             \t</Leq> \t\t\t\t\t\t<Geq> \t\t\t\t\t\t\t<FieldRef Name='Expires'></FieldRef>                                                 \t<Value Type='DateTime' IncludeTimeValue='FALSE'><Today /></Value> \t\t\t\t\t\t</Geq> \t\t\t\t\t    </And>                                             <Eq>                                                 <FieldRef Name='_ModerationStatus'></FieldRef>                                                 <Value Type='ModStat'>Approved</Value>                                             </Eq>                                         </And>                                         <Gt>                                             <FieldRef Name='Modified'></FieldRef>                                             <Value Type='DateTime' IncludeTimeValue='TRUE'>"+get_last_read_news()+"</Value>                                         </Gt>                                     </And>                                 </Where>                                 <OrderBy>                                     <FieldRef Name='Modified' Ascending='FALSE' />                                 </OrderBy>                             </Query>                         </query>                         <viewFields>                             <ViewFields>                                 <FieldRef Name='Modified' />                             </ViewFields>                         </viewFields>"),this.news_collListItem=n.getItems(a),t.load(news_collListItem),s=(r=new SP.ClientContext("/dept/109")).get_web().get_lists().getByTitle("IT Status"),(n=new SP.CamlQuery).set_viewXml("<query>                                 <Query>                                     <Where>                                         <Or>                                             <IsNull>                                                 <FieldRef Name='Expires' />                                             </IsNull>                                             <Gt>                                                 <FieldRef Name='Expires' />                                                 <Value Type='DateTime' IncludeTimeValue='TRUE'>"+get_formatted_now()+"</Value>                                             </Gt>                                         </Or>                                     </Where>                                     <OrderBy>                                         <FieldRef Ascending='FALSE' Name='Modified' />                                     </OrderBy>                                 </Query>                             </query>                             <viewFields>                                 <ViewFields>                                     <FieldRef Name='ID' />                                     <FieldRef Name='Severity' />                                     <FieldRef Name='Title' />                                     <FieldRef Name='Network' />                                 </ViewFields>                             </viewFields>"),this.status_collListItem=s.getItems(n),r.load(status_collListItem),s=(a=new SP.ClientContext("/resources")).get_web().get_lists().getByTitle("Employee Resource Links"),(n=new SP.CamlQuery).set_viewXml("<query>\t\t\t\t\t\t\t\t\t<Query><OrderBy>\t\t\t\t\t\t\t\t\t\t<FieldRef Name='LinkType' /> \t\t\t\t\t\t\t\t\t\t<FieldRef Name='URL' /> \t\t\t\t\t\t\t\t\t</OrderBy></Query>\t\t\t\t\t\t\t\t</query>\t\t\t\t\t\t\t\t<ViewFields> \t\t\t\t\t\t\t\t\t<FieldRef Name='LinkType'/> \t\t\t\t\t\t\t\t\t<FieldRef Name='URL'/> \t\t\t\t\t\t\t\t</ViewFields>"),this.resource_collListItem=s.getItems(n),a.load(resource_collListItem),s=homeportnw_utilities.get_cookie("home-usernum")||"",n=e.get_lists().getByTitle("My Links"),(e=new SP.CamlQuery).set_viewXml("<View>\t\t\t\t\t\t<Query>\t\t\t\t\t\t\t<Where>\t\t\t\t\t\t\t\t<Eq>\t\t\t\t\t\t\t\t\t<FieldRef Name='IDofUser'/>                                    <Value Type='Number'>"+s+"</Value> \t\t\t\t\t\t\t\t</Eq>\t\t\t\t\t\t\t</Where>\t\t\t\t\t\t\t<RowLimit>30</RowLimit>\t\t\t\t\t\t</Query>\t\t\t\t\t</View>"),this.myLinks_collListItem=n.getItems(e),t.load(myLinks_collListItem),i.executeQueryAsync(Function.createDelegate(this,this.onQuerySucceededJobs),Function.createDelegate(this,this.onQueryFailed)),t.executeQueryAsync(Function.createDelegate(this,this.onQuerySucceededBanner),Function.createDelegate(this,this.onQueryFailed)),r.executeQueryAsync(Function.createDelegate(this,this.onQuerySucceededIt),Function.createDelegate(this,this.onQueryFailed)),a.executeQueryAsync(Function.createDelegate(this,this.onQuerySucceededResources),Function.createDelegate(this,this.onQueryFailed)),$.when(dfdJobs,dfdStatus,dfdResources,dfdLinks).then(function(t,e,i,r){i='<div id="BlackBanner"> \t\t\t\t<p>IT Status : PSNS</p> \t\t\t\t<div id="psnsStatus">'+e[0]+'</div> \t\t\t\t<p>NMCI</p> \t\t\t\t<div id="nmciStatus">'+e[1]+'</div> \t\t\t\t<p>MSE</p> \t\t\t\t<div id="mseStatus">'+e[2]+'</div> \t\t\t\t<p> | </p> \t\t\t\t<a href="/dept/hro/Lists/JobAnnouncements" target="_blank" id="jobsIcon"> \t\t\t\t\t<img src="/HomePageFiles/USAJOBS.jpg" /> \t\t\t\t</a> \t\t\t\t<a href="/dept/hro/Lists/JobAnnouncements" target="_blank" class="BannerLink">Jobs</a> \t\t\t\t<a href="/dept/hro/Lists/JobAnnouncements" target="_blank" id="JobsCount" class="counter">'+t+'</a> \t\t\t\t<p> | </p> \t\t\t\t<a href="/Lists/NewsYouCanUse/Active.aspx" target="_blank" id="nycuIcon"> \t\t\t\t\t<img src="/HomePageFiles/newspaper.gif" /> \t\t\t\t</a> \t\t\t\t<a href="/Lists/NewsYouCanUse/Active.aspx" target="_blank" class="BannerLink">NYCU</a> \t\t\t\t<a href="/Lists/NewsYouCanUse/Active.aspx" target="_blank" id="AnnCount" class="counter">'+r[0]+'</a> \t\t\t\t<p> | </p> \t\t\t\t<div class="dropDown"> \t\t\t\t\t<p>IT Help</p> \t\t\t\t\t<div id="itDropDownContents"> \t\t\t\t\t\t<ul id="ITMenu"> \t\t\t\t\t\t\t<li><div> \t\t\t\t\t\t\t\t<a href="/dept/109/ITCoordinators/default.aspx">IT Coordinators</a> \t\t\t\t\t\t\t</div></li> \t\t\t\t\t\t\t<li><div> \t\t\t\t\t\t<a href="/dept/109/help/Customer%20Knowledgebase/Home.aspx">IT Support Desk</a> \t\t\t\t\t\t\t</div></li> \t\t\t\t\t\t\t<li><div> \t\t\t\t\t\t\t\t<a href="/dept/109/help/Customer%20Knowledgebase/Support%20Library.aspx">Support Library</a> \t\t\t\t\t\t\t</div></li> \t\t\t\t\t\t\t<li><div> \t\t\t\t\t\t\t\t<a href="/SitePages/Registration%20Instruction.aspx">Computer Registration Utility</a> \t\t\t\t\t\t\t</div></li> \t\t\t\t\t\t\t<li><div> \t\t\t\t\t\t\t\t<a href="/dept/109/help/FlankSpeed/FlankSpeed%20Wiki/Home.aspx">Flank Speed</a> \t\t\t\t\t\t\t</div></li><li><div> \t\t\t\t\t\t\t\t<a href="/dept/109/help/default.aspx">Reporting Cybersecurity Issues</a> \t\t\t\t\t\t\t</div></li> \t\t\t\t\t\t</ul> \t\t\t\t\t</div> \t\t\t\t</div> \t\t\t\t<p> | </p> \t\t\t\t<div id="Resources" class="dropDown"> \t\t\t\t\t<p>Resources</p> \t\t\t\t\t<div id="ResDropDownContents">'+i+'</div> \t\t\t\t</div> \t\t\t\t<div class="dropDown"> \t\t\t\t\t<p> | </p> \t\t\t\t\t<div id="hostId">'+hostName+'</div> \t\t\t\t</div>\t\t\t\t<div id="MyLinks" class="dropDown"> \t\t\t\t\t<p>My Links</p>\t\t\t\t\t<div id="MyLinksDropDownContents">'+r[1]+'</div> \t\t\t\t</div> \t\t\t\t<div id="breadCrumb"></div> \t\t\t</div>',$("body").prepend(i),$("#ResourceMenu").menu(),$("#MyLinksMenu").menu(),$("#ITMenu").menu(),0<r[0]&&$("#AnnCount").css("visibility","visible"),0<t&&$("#JobsCount").css("visibility","visible"),addBreadCrumb()})}}function onQuerySucceededJobs(){for(var t=jobs_collListItem.getEnumerator(),e=0;t.moveNext();)e++;dfdJobs.resolve(e),jobs_ctx=""}function onQuerySucceededIt(){for(var t=status_collListItem.getEnumerator(),e=[],i=[],r=[];t.moveNext();){var s=t.get_current(),n=s.get_item("Severity").toLowerCase(),a=s.get_item("Title"),o=s.get_item("Network").toLowerCase(),l={severity:n,title:a,id:s.get_item("ID")};switch(o){case"psns":e.push(l);break;case"nmci":i.push(l);break;case"mse":r.push(l)}}var d=getColor(e),u=getColor(i),c=getColor(r),m="";switch(d){case 0:m='<img src="/HomePageFiles/green-light.png"/>';break;case 1:m='<div class="dropDown"><img src="/HomePageFiles/yellow-light.png "/>',m+=addStatusLinks(e),m+="</div>";break;case 2:m='<div class="dropDown"><img src="/HomePageFiles/red-light.png "/>',m+=addStatusLinks(e),m+="</div>"}switch(psnsStatus=m,m="",u){case 0:m='<img src="/HomePageFiles/green-light.png"/>';break;case 1:m='<div class="dropDown"><img src="/HomePageFiles/yellow-light.png "/>',m+=addStatusLinks(i),m+="</div>";break;case 2:m='<div class="dropDown"><img src="/HomePageFiles/red-light.png "/>',m+=addStatusLinks(i),m+="</div>"}switch(nmciStatus=m,m="",c){case 0:m='<img src="/HomePageFiles/green-light.png"/>';break;case 1:m='<div class="dropDown"><img src="/HomePageFiles/yellow-light.png "/>',m+=addStatusLinks(r),m+="</div>";break;case 2:m='<div class="dropDown"><img src="/HomePageFiles/red-light.png "/>',m+=addStatusLinks(r),m+="</div>"}mseStatus=m,returnStatus=[psnsStatus,nmciStatus,mseStatus],dfdStatus.resolve(returnStatus),ctx_it=""}function getColor(t){for(var e=0,i=0;i<t.length;i++)e<1&&"yellow"==t[i].severity&&(e=1),e<2&&"red"==t[i].severity&&(e=2);return e}function addStatusLinks(t){var e="";e+='<div class="statusDropDownContents">';for(var i=0;i<t.length;i++)e+='<a href="/dept/109/Lists/ITStatus/DispForm.aspx?ID='+t[i].id+'"><p class=',"yellow"==t[i].severity?e+='"yellowStatus"':"red"==t[i].severity?e+='"redStatus"':e+='"greenStatus"',e+=">"+t[i].title+"</p></a>";return e+"</div>"}function onQuerySucceededResources(){for(var t=[],e=resource_collListItem.getEnumerator();e.moveNext();){var i=(r=e.get_current()).get_item("URL"),r=r.get_item("LinkType"),r={url:i.get_url(),description:i.get_description(),type:r};t.push(r)}hString="",hString=buildResources(t),resDropDownContents=hString,dfdResources.resolve(resDropDownContents),resource_ctx=""}function onQuerySucceededBanner(){var t=news_collListItem.getEnumerator();for(count=0;t.moveNext();)count++;for(var e=count,i="",r=[],s=[],i='<li><div><a href="/Lists/My%20Links/myLinks.aspx" id="MyLinks" style="font-weight: 900;"><img src="/_layouts/images/Link.GIF" class="imgMyLinks" />Manage My Links</a></div></li>',n=myLinks_collListItem.getEnumerator();n.moveNext();){var a=n.get_current(),o={Url:a.get_item("URL"),Sort:a=a.get_item("Sort_x0020_Order")};(a?r:s).push(o)}r=orderedSort(r),s=alphaSort(s),r.forEach(function(t){i+='<li><div><a href="'+t.Url.get_url()+'">'+t.Url.get_description()+"</a></div></li>"}),s.forEach(function(t){i+='<li><div><a href="'+t.Url.get_url()+'">'+t.Url.get_description()+"</a></div></li>"}),e=[e,'<ul id="MyLinksMenu">'+i+"</ul>"],dfdLinks.resolve(e)}function orderedSort(t){return t.sort(function(t,e){return t=parseInt(t.Sort),(e=parseInt(e.Sort))<t?1:t<e?-1:0}),t}function alphaSort(t){return t.sort(function(t,e){return t=t.Url.get_description().toLowerCase(),(e=e.Url.get_description().toLowerCase())<t?1:t<e?-1:0}),t}function buildResources(t){hString='<ul id="ResourceMenu">';for(var e=0;e<t.length;e++)0<e&&e<t.length-1?t[e].type!==t[e-1].type&&(hString+="</ul></li><li><div>"+t[e].type+"</div><ul>"):0==e&&(hString+="<li><div>"+t[e].type+"</div><ul>"),hString+='<li><div><a href="'+t[e].url+'">'+t[e].description+"</a></div></li>",e==t.length-1&&(hString+="</ul></li></ul>");return hString}function get_last_read_jobs(){return get_a_date(latest_read_=homeportnw_utilities.get_cookie("jobannc-last-modified"))}function get_last_read_news(){return get_a_date(latest_read_=homeportnw_utilities.get_cookie("nycu-last-modified"))}function get_formatted_now(){return(new Date).toISOString()}function get_a_date(t){return null===t?"1979-02-25T00:00:00Z":t}function onQueryFailed(t,e){}function SetSmallHostValue(t){hostName=t}function addBreadCrumb(){for(var t=[""],e=0;e<t.length;e++)if(document.location.href==t[e])return;function a(t){var e=document.getElementById("breadcrumbSite"),i=(t=new SP.ClientContext(t)).get_site(),r=t.get_web();t.load(r,"ServerRelativeUrl","Title","ParentWeb","Url"),t.load(i,"ServerRelativeUrl"),t.executeQueryAsync(function(){var t;i.get_serverRelativeUrl()!==r.get_serverRelativeUrl()?((t=document.createElement("li")).className="ms-Breadcrumb-listItem",t.innerHTML='<a class="ms-Breadcrumb-itemLink" href="'+r.get_url()+'">'+r.get_title()+'</a><i class="ms-Breadcrumb-chevron ms-Icon ms-Icon--ChevronRight"></i>',e.insertBefore(t,e.childNodes[0]),a(r.get_parentWeb().get_serverRelativeUrl())):((t=document.createElement("li")).className="ms-Breadcrumb-listItem",t.innerHTML='<a class="ms-Breadcrumb-itemLink" href="'+r.get_url()+'">'+r.get_title()+'</a><i class="ms-Breadcrumb-chevron ms-Icon ms-Icon--ChevronRight"></i>',e.insertBefore(t,e.childNodes[0]),t=r.get_url(),location.hostname,t!=(t=location.protocol+"//"+location.host)&&a(t))},o)}function o(){console.log("Unable to load SharePoint BreadCrumb")}SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var t=SP.ClientContext.get_current(),s=t.get_site(),n=t.get_web();t.load(n,"ServerRelativeUrl","Title","ParentWeb","Url"),t.load(s,"ServerRelativeUrl"),t.executeQueryAsync(function(){(r=document.createElement("div")).className="ms-Breadcrumb",r.innerHTML='<div class="ms-FocusZone"><ul id="breadcrumbSite" class="ms-Breadcrumb-list"></ul></div>',$("#breadCrumb").html(r);var t,i,e,r=document.getElementById("breadcrumbSite");-1!=document.location.pathname.indexOf("Site Pages")||-1!=document.location.pathname.indexOf("Pages")?((t=document.createElement("li")).className="ms-Breadcrumb-listItem",1<document.title.split("-").length?t.innerHTML='<span class="ms-Breadcrumb-itemLink">'+document.title.split("-")[1].trim()+'</span><i class="ms-Breadcrumb-chevron ms-Icon ms-Icon--ChevronRight"></i>':t.innerHTML='<span class="ms-Breadcrumb-itemLink">'+document.title.trim()+'</span><i class="ms-Breadcrumb-chevron ms-Icon ms-Icon--ChevronRight"></i>',r.insertBefore(t,r.childNodes[0])):-1!=document.location.pathname.indexOf("_layouts/15/")&&((t=document.createElement("li")).className="ms-Breadcrumb-listItem",t.innerHTML='<span class="ms-Breadcrumb-itemLink">'+document.title+'</span><i class="ms-Breadcrumb-chevron ms-Icon ms-Icon--ChevronRight"></i>',r.insertBefore(t,r.childNodes[0])),(t=document.createElement("li")).className="ms-Breadcrumb-listItem",t.innerHTML='<a class="ms-Breadcrumb-itemLink" href="'+n.get_url()+'">'+n.get_title()+'</a><i class="ms-Breadcrumb-chevron ms-Icon ms-Icon--ChevronRight"></i>',r.insertBefore(t,r.childNodes[0]),0<$("#DeltaPlaceHolderPageTitleInTitleArea span span").length&&-1!=document.location.href.indexOf("RootFolder=")&&("/"==(r=_spPageContextInfo.siteServerRelativeUrl)&&(r=""),e=unescape(document.location).split("RootFolder=")[1].split("&Folder")[0].replace(r,"").split("/"),i=_spPageContextInfo.serverRequestPath+"?RootFolder="+r,$.each(e,function(t,e){""!=e&&(i=i+"/"+e,$("#breadcrumbSite").append('<li class="ms-Breadcrumb-listItem"><a class="ms-Breadcrumb-itemLink" href="'+i+'">'+e+'</a><i class="ms-Breadcrumb-chevron ms-Icon ms-Icon--ChevronRight"></i></li>'))})),s.get_serverRelativeUrl()!==n.get_serverRelativeUrl()?a(n.get_parentWeb().get_serverRelativeUrl()):(e=n.get_url(),location.hostname,e!=(e=location.protocol+"//"+location.host)&&a(e))},o)}),function(){for(var t=Array.prototype.slice.call((document.getElementById("DeltaPlaceHolderMain")||document).getElementsByTagName("img")),e=t.length,i=0;i<e;++i)-1!=t[i].src.indexOf("breadcrumb.png")&&(t[i].src=pathBreadCrumb+"/images/breadcrumb.png")}()}var hostName="unk",dfdJobs=$.Deferred(),dfdStatus=$.Deferred(),dfdResources=$.Deferred(),dfdLinks=$.Deferred(),latest_read_=null;SP.SOD.executeOrDelayUntilScriptLoaded(getHeaderItems,"SP.js");